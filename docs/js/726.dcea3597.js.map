{"version":3,"file":"js/726.dcea3597.js","mappings":"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","sources":["webpack://graphviz/./src/views/Search.vue","webpack://graphviz/./src/components/VGraph.vue","webpack://graphviz/src/components/VGraph.vue","webpack://graphviz/./src/components/VGraph.vue?bf53","webpack://graphviz/./src/components/VGraph.vue?a3b2","webpack://graphviz/src/views/Search.vue","webpack://graphviz/./src/views/Search.vue?fb6b","webpack://graphviz/./src/views/Search.vue?1f58","webpack://graphviz/./node_modules/add-event-listener/index.js","webpack://graphviz/./node_modules/gintersect/index.js","webpack://graphviz/./node_modules/ngraph.centrality/index.js","webpack://graphviz/./node_modules/ngraph.centrality/src/betweenness.js","webpack://graphviz/./node_modules/ngraph.centrality/src/closeness.js","webpack://graphviz/./node_modules/ngraph.centrality/src/degree.js","webpack://graphviz/./node_modules/ngraph.centrality/src/eccentricity.js","webpack://graphviz/./node_modules/ngraph.events/index.js","webpack://graphviz/./node_modules/ngraph.expose/index.js","webpack://graphviz/./node_modules/ngraph.forcelayout/index.js","webpack://graphviz/./node_modules/ngraph.forcelayout/node_modules/ngraph.events/index.js","webpack://graphviz/./node_modules/ngraph.fromjson/index.js","webpack://graphviz/./node_modules/ngraph.generators/index.js","webpack://graphviz/./node_modules/ngraph.generators/node_modules/ngraph.random/index.js","webpack://graphviz/./node_modules/ngraph.graph/index.js","webpack://graphviz/./node_modules/ngraph.merge/index.js","webpack://graphviz/./node_modules/ngraph.physics.primitives/index.js","webpack://graphviz/./node_modules/ngraph.physics.simulator/index.js","webpack://graphviz/./node_modules/ngraph.physics.simulator/lib/bounds.js","webpack://graphviz/./node_modules/ngraph.physics.simulator/lib/createBody.js","webpack://graphviz/./node_modules/ngraph.physics.simulator/lib/dragForce.js","webpack://graphviz/./node_modules/ngraph.physics.simulator/lib/eulerIntegrator.js","webpack://graphviz/./node_modules/ngraph.physics.simulator/lib/spring.js","webpack://graphviz/./node_modules/ngraph.physics.simulator/lib/springForce.js","webpack://graphviz/./node_modules/ngraph.quadtreebh/index.js","webpack://graphviz/./node_modules/ngraph.quadtreebh/insertStack.js","webpack://graphviz/./node_modules/ngraph.quadtreebh/isSamePosition.js","webpack://graphviz/./node_modules/ngraph.quadtreebh/node.js","webpack://graphviz/./node_modules/ngraph.random/index.js","webpack://graphviz/./node_modules/ngraph.tojson/index.js","webpack://graphviz/./node_modules/simplesvg/index.js","webpack://graphviz/./node_modules/simplesvg/lib/compile.js","webpack://graphviz/./node_modules/simplesvg/lib/compile_template.js","webpack://graphviz/./node_modules/simplesvg/lib/domparser.js","webpack://graphviz/./node_modules/vivagraphjs/src/Algorithms/centrality.js","webpack://graphviz/./node_modules/vivagraphjs/src/Algorithms/operations.js","webpack://graphviz/./node_modules/vivagraphjs/src/Input/domInputManager.js","webpack://graphviz/./node_modules/vivagraphjs/src/Input/dragndrop.js","webpack://graphviz/./node_modules/vivagraphjs/src/Input/webglInputManager.js","webpack://graphviz/./node_modules/vivagraphjs/src/Layout/constant.js","webpack://graphviz/./node_modules/vivagraphjs/src/Utils/backwardCompatibleEvents.js","webpack://graphviz/./node_modules/vivagraphjs/src/Utils/browserInfo.js","webpack://graphviz/./node_modules/vivagraphjs/src/Utils/documentEvents.js","webpack://graphviz/./node_modules/vivagraphjs/src/Utils/findElementPosition.js","webpack://graphviz/./node_modules/vivagraphjs/src/Utils/getDimensions.js","webpack://graphviz/./node_modules/vivagraphjs/src/Utils/intersectRect.js","webpack://graphviz/./node_modules/vivagraphjs/src/Utils/nullEvents.js","webpack://graphviz/./node_modules/vivagraphjs/src/Utils/rect.js","webpack://graphviz/./node_modules/vivagraphjs/src/Utils/timer.js","webpack://graphviz/./node_modules/vivagraphjs/src/Utils/windowEvents.js","webpack://graphviz/./node_modules/vivagraphjs/src/View/renderer.js","webpack://graphviz/./node_modules/vivagraphjs/src/View/svgGraphics.js","webpack://graphviz/./node_modules/vivagraphjs/src/View/webglGraphics.js","webpack://graphviz/./node_modules/vivagraphjs/src/WebGL/parseColor.js","webpack://graphviz/./node_modules/vivagraphjs/src/WebGL/texture.js","webpack://graphviz/./node_modules/vivagraphjs/src/WebGL/webgl.js","webpack://graphviz/./node_modules/vivagraphjs/src/WebGL/webglAtlas.js","webpack://graphviz/./node_modules/vivagraphjs/src/WebGL/webglImage.js","webpack://graphviz/./node_modules/vivagraphjs/src/WebGL/webglImageNodeProgram.js","webpack://graphviz/./node_modules/vivagraphjs/src/WebGL/webglInputEvents.js","webpack://graphviz/./node_modules/vivagraphjs/src/WebGL/webglLine.js","webpack://graphviz/./node_modules/vivagraphjs/src/WebGL/webglLinkProgram.js","webpack://graphviz/./node_modules/vivagraphjs/src/WebGL/webglNodeProgram.js","webpack://graphviz/./node_modules/vivagraphjs/src/WebGL/webglSquare.js","webpack://graphviz/./node_modules/vivagraphjs/src/version.js","webpack://graphviz/./node_modules/vivagraphjs/src/viva.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('v-graph',{attrs:{\"nodes\":[],\"links\":[[1,2],[1,3],[1,4],[1,5],[2,4]]}})\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('canvas',{ref:\"vgraph\"})\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <canvas ref=\"vgraph\" />\r\n</template>\r\n<script>\r\nimport {Graph} from 'vivagraphjs'\r\n\r\nexport default {\r\n    name: 'v-graph',\r\n    props: {\r\n        nodes: Array,\r\n        links: Array,\r\n    },\r\n    methods: {\r\n        show() {\r\n            this.renderer.run();\r\n        }\r\n    },\r\n    mounted() {\r\n        this.show();\r\n    },\r\n    computed: {\r\n        canvas() {\r\n            return this.$refs.vgraph;\r\n        },\r\n        graph() {\r\n            let g = Graph.graph();\r\n            this.nodes.forEach(function() {\r\n                g.addNode.apply(g, arguments); \r\n            });\r\n            this.links.forEach(function() {\r\n                g.addLink.apply(g, arguments);\r\n            });\r\n            return g;\r\n        },\r\n        hasWebGLSupport() {\r\n          return window.WebGLRenderingContext\r\n            && this.canvas.getContext \r\n            && this.canvas.getContext('experimental-webgl');\r\n        },\r\n        layout() {\r\n            return Graph.Layout.forceDirected(this.graph, {\r\n                springLength : 50,\r\n                springCoeff : 1e-4,\r\n                dragCoeff : 0.005,\r\n                gravity : -1.5,\r\n                theta : 0.75,\r\n            });\r\n        },\r\n        graphics() {\r\n            return this.hasWebGLSupport \r\n                ? Graph.graphics.View.webglGraphics() \r\n                : Graph.graphics.View.svgGraphics();\r\n        },\r\n        renderer() {\r\n            return Graph.View.renderer(this.graph, {\r\n                layout: this.layout,\r\n                graphics: this.graphics,\r\n                renderLinks: true,\r\n                container: this.canvas,\r\n            });\r\n        }\r\n    },\r\n    data() {\r\n        return {\r\n            // graph: Graph.graph(),\r\n        }\r\n    }\r\n}\r\n</script>","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./VGraph.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./VGraph.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./VGraph.vue?vue&type=template&id=73992765&\"\nimport script from \"./VGraph.vue?vue&type=script&lang=js&\"\nexport * from \"./VGraph.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n    <v-graph :nodes=\"[]\" :links=\"[[1,2],[1,3],[1,4],[1,5],[2,4]]\" />\r\n</template>\r\n<script>\r\nimport VGraph from '@/components/VGraph.vue';\r\n\r\nexport default {\r\n    name: 'SearchScreen',\r\n    components: {\r\n        VGraph,\r\n    },\r\n    data() {\r\n        return {};\r\n    }\r\n}\r\n</script>","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Search.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Search.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Search.vue?vue&type=template&id=6370e512&\"\nimport script from \"./Search.vue?vue&type=script&lang=js&\"\nexport * from \"./Search.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","addEventListener.removeEventListener = removeEventListener\naddEventListener.addEventListener = addEventListener\n\nmodule.exports = addEventListener\n\nvar Events = null\n\nfunction addEventListener(el, eventName, listener, useCapture) {\n  Events = Events || (\n    document.addEventListener ?\n    {add: stdAttach, rm: stdDetach} :\n    {add: oldIEAttach, rm: oldIEDetach}\n  )\n  \n  return Events.add(el, eventName, listener, useCapture)\n}\n\nfunction removeEventListener(el, eventName, listener, useCapture) {\n  Events = Events || (\n    document.addEventListener ?\n    {add: stdAttach, rm: stdDetach} :\n    {add: oldIEAttach, rm: oldIEDetach}\n  )\n  \n  return Events.rm(el, eventName, listener, useCapture)\n}\n\nfunction stdAttach(el, eventName, listener, useCapture) {\n  el.addEventListener(eventName, listener, useCapture)\n}\n\nfunction stdDetach(el, eventName, listener, useCapture) {\n  el.removeEventListener(eventName, listener, useCapture)\n}\n\nfunction oldIEAttach(el, eventName, listener, useCapture) {\n  if(useCapture) {\n    throw new Error('cannot useCapture in oldIE')\n  }\n\n  el.attachEvent('on' + eventName, listener)\n}\n\nfunction oldIEDetach(el, eventName, listener, useCapture) {\n  el.detachEvent('on' + eventName, listener)\n}\n","module.exports = intersect;\n\n/**\n * Original authors: Mukesh Prasad, Appeared in Graphics Gem II book\n * http://www.opensource.apple.com/source/graphviz/graphviz-498/graphviz/dynagraph/common/xlines.c\n * and adopted to javascript version by Andrei Kashcha.\n *\n * This function computes whether two line segments,\n * respectively joining the input points (x1,y1) -- (x2,y2)\n * and the input points (x3,y3) -- (x4,y4) intersect.\n * If the lines intersect, the output variables x, y are\n * set to coordinates of the point of intersection.\n *\n * @param {Number} x1 First line segment coordinates\n * @param {Number} y1 First line segment coordinates\n * @param {Number} x2 First line segment coordinates\n * @param {Number} x2 First line segment coordinates\n *\n * @param {Number} x3 Second line segment coordinates\n * @param {Number} y3 Second line segment coordinates\n * @param {Number} x4 Second line segment coordinates\n * @param {Number} x4 Second line segment coordinates\n *\n * @return {Object} x, y coordinates of intersection point or falsy value if no\n * intersection found..\n */\nfunction intersect(\n  x1, y1, x2, y2, // first line segment\n  x3, y3, x4, y4  // second line segment\n) {\n\n  var a1, a2, b1, b2, c1, c2, /* Coefficients of line eqns. */\n    r1, r2, r3, r4, /* 'Sign' values */\n    denom, offset, num, /* Intermediate values */\n    result = {\n      x: 0,\n      y: 0\n    };\n\n  /* Compute a1, b1, c1, where line joining points 1 and 2\n   * is \"a1 x  +  b1 y  +  c1  =  0\".\n   */\n  a1 = y2 - y1;\n  b1 = x1 - x2;\n  c1 = x2 * y1 - x1 * y2;\n\n  /* Compute r3 and r4.\n   */\n  r3 = a1 * x3 + b1 * y3 + c1;\n  r4 = a1 * x4 + b1 * y4 + c1;\n\n  /* Check signs of r3 and r4.  If both point 3 and point 4 lie on\n   * same side of line 1, the line segments do not intersect.\n   */\n\n  if (r3 !== 0 && r4 !== 0 && ((r3 >= 0) === (r4 >= 4))) {\n    return null; //no intersection.\n  }\n\n  /* Compute a2, b2, c2 */\n  a2 = y4 - y3;\n  b2 = x3 - x4;\n  c2 = x4 * y3 - x3 * y4;\n\n  /* Compute r1 and r2 */\n\n  r1 = a2 * x1 + b2 * y1 + c2;\n  r2 = a2 * x2 + b2 * y2 + c2;\n\n  /* Check signs of r1 and r2.  If both point 1 and point 2 lie\n   * on same side of second line segment, the line segments do\n   * not intersect.\n   */\n  if (r1 !== 0 && r2 !== 0 && ((r1 >= 0) === (r2 >= 0))) {\n    return null; // no intersection;\n  }\n  /* Line segments intersect: compute intersection point.\n   */\n\n  denom = a1 * b2 - a2 * b1;\n  if (denom === 0) {\n    return null; // Actually collinear..\n  }\n\n  offset = denom < 0 ? -denom / 2 : denom / 2;\n  offset = 0.0;\n\n  /* The denom/2 is to get rounding instead of truncating.  It\n   * is added or subtracted to the numerator, depending upon the\n   * sign of the numerator.\n   */\n  num = b1 * c2 - b2 * c1;\n  result.x = (num < 0 ? num - offset : num + offset) / denom;\n\n  num = a2 * c1 - a1 * c2;\n  result.y = (num < 0 ? num - offset : num + offset) / denom;\n\n  return result;\n}\n","module.exports.degree = require('./src/degree.js');\nmodule.exports.betweenness = require('./src/betweenness.js');\nmodule.exports.closeness = require('./src/closeness.js');\nmodule.exports.eccentricity = require('./src/eccentricity.js');\n","module.exports = betweennes;\n\n/**\n * I'm using http://www.inf.uni-konstanz.de/algo/publications/b-vspbc-08.pdf\n * as a reference for this implementation\n */\nfunction betweennes(graph, oriented) {\n  var Q = [],\n    S = []; // Queue and Stack\n  // list of predcessors on shorteest paths from source\n  var pred = Object.create(null);\n  // distance from source\n  var dist = Object.create(null);\n  // number of shortest paths from source to key\n  var sigma = Object.create(null);\n  // dependency of source on key\n  var delta = Object.create(null);\n\n  var currentNode;\n  var centrality = Object.create(null);\n\n  graph.forEachNode(setCentralityToZero);\n  graph.forEachNode(calculateCentrality);\n\n  if (!oriented) {\n    // The centrality scores need to be divided by two if the graph is not oriented,\n    // since all shortest paths are considered twice\n    Object.keys(centrality).forEach(divideByTwo);\n  }\n\n  return centrality;\n\n  function divideByTwo(key) {\n    centrality[key] /= 2;\n  }\n\n  function setCentralityToZero(node) {\n    centrality[node.id] = 0;\n  }\n\n  function calculateCentrality(node) {\n    currentNode = node.id;\n    singleSourceShortestPath(currentNode);\n    accumulate();\n  }\n\n  function accumulate() {\n    graph.forEachNode(setDeltaToZero);\n    while (S.length) {\n      var w = S.pop();\n      var coeff = (1 + delta[w])/sigma[w];\n      var predcessors = pred[w];\n      for (var idx = 0; idx < predcessors.length; ++idx) {\n        var v = predcessors[idx];\n        delta[v] += sigma[v] * coeff;\n      }\n      if (w !== currentNode) {\n        centrality[w] += delta[w];\n      }\n    }\n  }\n\n  function setDeltaToZero(node) {\n    delta[node.id] = 0;\n  }\n\n  function singleSourceShortestPath(source) {\n    graph.forEachNode(initNode);\n    dist[source] = 0;\n    sigma[source] = 1;\n    Q.push(source);\n\n    while (Q.length) {\n      var v = Q.shift();\n      S.push(v);\n      graph.forEachLinkedNode(v, toId, oriented);\n    }\n\n    function toId(otherNode) {\n      // NOTE: This code will also consider multi-edges, which are often\n      // ignored by popular software (Gephi/NetworkX). Depending on your use\n      // case this may not be desired and deduping needs to be performed. To\n      // save memory I'm not deduping here...\n      processNode(otherNode.id);\n    }\n\n    function initNode(node) {\n      var nodeId = node.id;\n      pred[nodeId] = []; // empty list\n      dist[nodeId] = -1;\n      sigma[nodeId] = 0;\n    }\n\n    function processNode(w) {\n      // path discovery\n      if (dist[w] === -1) {\n        // Node w is found for the first time\n        dist[w] = dist[v] + 1;\n        Q.push(w);\n      }\n      // path counting\n      if (dist[w] === dist[v] + 1) {\n        // edge (v, w) on a shortest path\n        sigma[w] += sigma[v];\n        pred[w].push(v);\n      }\n    }\n  }\n}\n","module.exports = closeness;\r\n\r\n/**\r\n * In a connected graph, the normalized closeness centrality of a node is the average\r\n * length of the shortest path between the node and all other nodes in the\r\n * graph. Thus the more central a node is, the closer it is to all other nodes.\r\n */\r\nfunction closeness(graph, oriented) {\r\n  var Q = [];\r\n  // list of predcessors on shortest paths from source\r\n  // distance from source\r\n  var dist = Object.create(null);\r\n\r\n  var currentNode;\r\n  var centrality = Object.create(null);\r\n\r\n  graph.forEachNode(setCentralityToZero);\r\n  graph.forEachNode(calculateCentrality);\r\n\r\n  return centrality;\r\n\r\n  function setCentralityToZero(node) {\r\n    centrality[node.id] = 0;\r\n  }\r\n\r\n  function calculateCentrality(node) {\r\n    currentNode = node.id;\r\n    singleSourceShortestPath(currentNode);\r\n    accumulate();\r\n  }\r\n\r\n  function accumulate() {\r\n    // Add all distances for node to array, excluding -1s\r\n    var distances = Object.keys(dist).map(function(key) {return dist[key]}).filter(function(val){return val !== -1});\r\n    // Set number of reachable nodes\r\n    var reachableNodesTotal = distances.length;\r\n    // Compute sum of all distances for node\r\n    var totalDistance = distances.reduce(function(a,b) { return a + b });\r\n    if (totalDistance > 0) {\r\n      centrality[currentNode] = ((reachableNodesTotal - 1) / totalDistance); \r\n    } else {\r\n      centrality[currentNode] = 0;\r\n    }\r\n  }\r\n\r\n  function singleSourceShortestPath(source) {\r\n    graph.forEachNode(initNode);\r\n    dist[source] = 0;\r\n    Q.push(source);\r\n\r\n    while (Q.length) {\r\n      var v = Q.shift();\r\n      graph.forEachLinkedNode(v, processNode, oriented);\r\n    }\r\n\r\n    function initNode(node) {\r\n      var nodeId = node.id;\r\n      dist[nodeId] = -1;\r\n    }\r\n\r\n    function processNode(otherNode) {\r\n      var w = otherNode.id\r\n      if (dist[w] === -1) {\r\n        // Node w is found for the first time\r\n        dist[w] = dist[v] + 1;\r\n        Q.push(w);\r\n      }\r\n    }\r\n  }\r\n}\r\n","module.exports = degree;\n\n/**\n * Calculates graph nodes degree centrality (in/out or both).\n *\n * @see http://en.wikipedia.org/wiki/Centrality#Degree_centrality\n *\n * @param {ngraph.graph} graph object for which we are calculating centrality.\n * @param {string} [kind=both] What kind of degree centrality needs to be calculated:\n *   'in'    - calculate in-degree centrality\n *   'out'   - calculate out-degree centrality\n *   'inout' - (default) generic degree centrality is calculated\n */\nfunction degree(graph, kind) {\n  var getNodeDegree;\n  var result = Object.create(null);\n\n  kind = (kind || 'both').toLowerCase();\n  if (kind === 'both' || kind === 'inout') {\n    getNodeDegree = inoutDegreeCalculator;\n  } else if (kind === 'in') {\n    getNodeDegree = inDegreeCalculator;\n  } else if (kind === 'out') {\n    getNodeDegree = outDegreeCalculator;\n  } else {\n    throw new Error('Expected centrality degree kind is: in, out or both');\n  }\n\n  graph.forEachNode(calculateNodeDegree);\n\n  return result;\n\n  function calculateNodeDegree(node) {\n    var links = graph.getLinks(node.id);\n    result[node.id] = getNodeDegree(links, node.id);\n  }\n}\n\nfunction inDegreeCalculator(links, nodeId) {\n  var total = 0;\n  if (!links) return total;\n\n  for (var i = 0; i < links.length; i += 1) {\n    total += (links[i].toId === nodeId) ? 1 : 0;\n  }\n  return total;\n}\n\nfunction outDegreeCalculator(links, nodeId) {\n  var total = 0;\n  if (!links) return total;\n\n  for (var i = 0; i < links.length; i += 1) {\n    total += (links[i].fromId === nodeId) ? 1 : 0;\n  }\n  return total;\n}\n\nfunction inoutDegreeCalculator(links) {\n  if (!links) return 0;\n\n  return links.length;\n}\n","module.exports = eccentricity;\r\n\r\n/**\r\n * The eccentricity centrality of a node is the greatest distance between that node and\r\n * any other node in the network. \r\n */\r\nfunction eccentricity(graph, oriented) {\r\n  var Q = [];\r\n  // distance from source\r\n  var dist = Object.create(null);\r\n\r\n  var currentNode;\r\n  var centrality = Object.create(null);\r\n\r\n  graph.forEachNode(setCentralityToZero);\r\n  graph.forEachNode(calculateCentrality);\r\n\r\n  return centrality;\r\n\r\n  function setCentralityToZero(node) {\r\n    centrality[node.id] = 0;\r\n  }\r\n\r\n  function calculateCentrality(node) {\r\n    currentNode = node.id;\r\n    singleSourceShortestPath(currentNode);\r\n    accumulate();\r\n  }\r\n\r\n  function accumulate() {\r\n    var maxDist = 0;\r\n    Object.keys(dist).forEach(function (key) {\r\n      var val = dist[key];\r\n      if (maxDist < val) maxDist = val;\r\n    });\r\n\r\n    centrality[currentNode] = maxDist;\r\n  }\r\n\r\n  function singleSourceShortestPath(source) {\r\n    graph.forEachNode(initNode);\r\n    dist[source] = 0;\r\n    Q.push(source);\r\n\r\n    while (Q.length) {\r\n      var v = Q.shift();\r\n      graph.forEachLinkedNode(v, processNode, oriented);\r\n    }\r\n\r\n    function initNode(node) {\r\n      var nodeId = node.id;\r\n      dist[nodeId] = -1;\r\n    }\r\n\r\n    function processNode(otherNode) {\r\n      var w = otherNode.id\r\n      if (dist[w] === -1) {\r\n        // Node w is found for the first time\r\n        dist[w] = dist[v] + 1;\r\n        Q.push(w);\r\n      }\r\n    }\r\n  }\r\n}\r\n","module.exports = function(subject) {\n  validateSubject(subject);\n\n  var eventsStorage = createEventsStorage(subject);\n  subject.on = eventsStorage.on;\n  subject.off = eventsStorage.off;\n  subject.fire = eventsStorage.fire;\n  return subject;\n};\n\nfunction createEventsStorage(subject) {\n  // Store all event listeners to this hash. Key is event name, value is array\n  // of callback records.\n  //\n  // A callback record consists of callback function and its optional context:\n  // { 'eventName' => [{callback: function, ctx: object}] }\n  var registeredEvents = Object.create(null);\n\n  return {\n    on: function (eventName, callback, ctx) {\n      if (typeof callback !== 'function') {\n        throw new Error('callback is expected to be a function');\n      }\n      var handlers = registeredEvents[eventName];\n      if (!handlers) {\n        handlers = registeredEvents[eventName] = [];\n      }\n      handlers.push({callback: callback, ctx: ctx});\n\n      return subject;\n    },\n\n    off: function (eventName, callback) {\n      var wantToRemoveAll = (typeof eventName === 'undefined');\n      if (wantToRemoveAll) {\n        // Killing old events storage should be enough in this case:\n        registeredEvents = Object.create(null);\n        return subject;\n      }\n\n      if (registeredEvents[eventName]) {\n        var deleteAllCallbacksForEvent = (typeof callback !== 'function');\n        if (deleteAllCallbacksForEvent) {\n          delete registeredEvents[eventName];\n        } else {\n          var callbacks = registeredEvents[eventName];\n          for (var i = 0; i < callbacks.length; ++i) {\n            if (callbacks[i].callback === callback) {\n              callbacks.splice(i, 1);\n            }\n          }\n        }\n      }\n\n      return subject;\n    },\n\n    fire: function (eventName) {\n      var callbacks = registeredEvents[eventName];\n      if (!callbacks) {\n        return subject;\n      }\n\n      var fireArguments;\n      if (arguments.length > 1) {\n        fireArguments = Array.prototype.splice.call(arguments, 1);\n      }\n      for(var i = 0; i < callbacks.length; ++i) {\n        var callbackInfo = callbacks[i];\n        callbackInfo.callback.apply(callbackInfo.ctx, fireArguments);\n      }\n\n      return subject;\n    }\n  };\n}\n\nfunction validateSubject(subject) {\n  if (!subject) {\n    throw new Error('Eventify cannot use falsy object as events subject');\n  }\n  var reservedWords = ['on', 'fire', 'off'];\n  for (var i = 0; i < reservedWords.length; ++i) {\n    if (subject.hasOwnProperty(reservedWords[i])) {\n      throw new Error(\"Subject cannot be eventified, since it already has property '\" + reservedWords[i] + \"'\");\n    }\n  }\n}\n","module.exports = exposeProperties;\n\n/**\n * Augments `target` object with getter/setter functions, which modify settings\n *\n * @example\n *  var target = {};\n *  exposeProperties({ age: 42}, target);\n *  target.age(); // returns 42\n *  target.age(24); // make age 24;\n *\n *  var filteredTarget = {};\n *  exposeProperties({ age: 42, name: 'John'}, filteredTarget, ['name']);\n *  filteredTarget.name(); // returns 'John'\n *  filteredTarget.age === undefined; // true\n */\nfunction exposeProperties(settings, target, filter) {\n  var needsFilter = Object.prototype.toString.call(filter) === '[object Array]';\n  if (needsFilter) {\n    for (var i = 0; i < filter.length; ++i) {\n      augment(settings, target, filter[i]);\n    }\n  } else {\n    for (var key in settings) {\n      augment(settings, target, key);\n    }\n  }\n}\n\nfunction augment(source, target, key) {\n  if (source.hasOwnProperty(key)) {\n    if (typeof target[key] === 'function') {\n      // this accessor is already defined. Ignore it\n      return;\n    }\n    target[key] = function (value) {\n      if (value !== undefined) {\n        source[key] = value;\n        return target;\n      }\n      return source[key];\n    }\n  }\n}\n","module.exports = createLayout;\nmodule.exports.simulator = require('ngraph.physics.simulator');\n\nvar eventify = require('ngraph.events');\n\n/**\n * Creates force based layout for a given graph.\n *\n * @param {ngraph.graph} graph which needs to be laid out\n * @param {object} physicsSettings if you need custom settings\n * for physics simulator you can pass your own settings here. If it's not passed\n * a default one will be created.\n */\nfunction createLayout(graph, physicsSettings) {\n  if (!graph) {\n    throw new Error('Graph structure cannot be undefined');\n  }\n\n  var createSimulator = require('ngraph.physics.simulator');\n  var physicsSimulator = createSimulator(physicsSettings);\n\n  var nodeMass = defaultNodeMass\n  if (physicsSettings && typeof physicsSettings.nodeMass === 'function') {\n    nodeMass = physicsSettings.nodeMass\n  }\n\n  var nodeBodies = Object.create(null);\n  var springs = {};\n  var bodiesCount = 0;\n\n  var springTransform = physicsSimulator.settings.springTransform || noop;\n\n  // Initialize physics with what we have in the graph:\n  initPhysics();\n  listenToEvents();\n\n  var wasStable = false;\n\n  var api = {\n    /**\n     * Performs one step of iterative layout algorithm\n     *\n     * @returns {boolean} true if the system should be considered stable; Flase otherwise.\n     * The system is stable if no further call to `step()` can improve the layout.\n     */\n    step: function() {\n      if (bodiesCount === 0) return true; // TODO: This will never fire 'stable'\n\n      var lastMove = physicsSimulator.step();\n\n      // Save the movement in case if someone wants to query it in the step\n      // callback.\n      api.lastMove = lastMove;\n\n      // Allow listeners to perform low-level actions after nodes are updated.\n      api.fire('step');\n\n      var ratio = lastMove/bodiesCount;\n      var isStableNow = ratio <= 0.01; // TODO: The number is somewhat arbitrary...\n\n      if (wasStable !== isStableNow) {\n        wasStable = isStableNow;\n        onStableChanged(isStableNow);\n      }\n\n      return isStableNow;\n    },\n\n    /**\n     * For a given `nodeId` returns position\n     */\n    getNodePosition: function (nodeId) {\n      return getInitializedBody(nodeId).pos;\n    },\n\n    /**\n     * Sets position of a node to a given coordinates\n     * @param {string} nodeId node identifier\n     * @param {number} x position of a node\n     * @param {number} y position of a node\n     * @param {number=} z position of node (only if applicable to body)\n     */\n    setNodePosition: function (nodeId) {\n      var body = getInitializedBody(nodeId);\n      body.setPosition.apply(body, Array.prototype.slice.call(arguments, 1));\n      physicsSimulator.invalidateBBox();\n    },\n\n    /**\n     * @returns {Object} Link position by link id\n     * @returns {Object.from} {x, y} coordinates of link start\n     * @returns {Object.to} {x, y} coordinates of link end\n     */\n    getLinkPosition: function (linkId) {\n      var spring = springs[linkId];\n      if (spring) {\n        return {\n          from: spring.from.pos,\n          to: spring.to.pos\n        };\n      }\n    },\n\n    /**\n     * @returns {Object} area required to fit in the graph. Object contains\n     * `x1`, `y1` - top left coordinates\n     * `x2`, `y2` - bottom right coordinates\n     */\n    getGraphRect: function () {\n      return physicsSimulator.getBBox();\n    },\n\n    /**\n     * Iterates over each body in the layout simulator and performs a callback(body, nodeId)\n     */\n    forEachBody: forEachBody,\n\n    /*\n     * Requests layout algorithm to pin/unpin node to its current position\n     * Pinned nodes should not be affected by layout algorithm and always\n     * remain at their position\n     */\n    pinNode: function (node, isPinned) {\n      var body = getInitializedBody(node.id);\n       body.isPinned = !!isPinned;\n    },\n\n    /**\n     * Checks whether given graph's node is currently pinned\n     */\n    isNodePinned: function (node) {\n      return getInitializedBody(node.id).isPinned;\n    },\n\n    /**\n     * Request to release all resources\n     */\n    dispose: function() {\n      graph.off('changed', onGraphChanged);\n      api.fire('disposed');\n    },\n\n    /**\n     * Gets physical body for a given node id. If node is not found undefined\n     * value is returned.\n     */\n    getBody: getBody,\n\n    /**\n     * Gets spring for a given edge.\n     *\n     * @param {string} linkId link identifer. If two arguments are passed then\n     * this argument is treated as formNodeId\n     * @param {string=} toId when defined this parameter denotes head of the link\n     * and first argument is trated as tail of the link (fromId)\n     */\n    getSpring: getSpring,\n\n    /**\n     * [Read only] Gets current physics simulator\n     */\n    simulator: physicsSimulator,\n\n    /**\n     * Gets the graph that was used for layout\n     */\n    graph: graph,\n\n    /**\n     * Gets amount of movement performed during last step opeartion\n     */\n    lastMove: 0\n  };\n\n  eventify(api);\n\n  return api;\n\n  function forEachBody(cb) {\n    Object.keys(nodeBodies).forEach(function(bodyId) {\n      cb(nodeBodies[bodyId], bodyId);\n    });\n  }\n\n  function getSpring(fromId, toId) {\n    var linkId;\n    if (toId === undefined) {\n      if (typeof fromId !== 'object') {\n        // assume fromId as a linkId:\n        linkId = fromId;\n      } else {\n        // assume fromId to be a link object:\n        linkId = fromId.id;\n      }\n    } else {\n      // toId is defined, should grab link:\n      var link = graph.hasLink(fromId, toId);\n      if (!link) return;\n      linkId = link.id;\n    }\n\n    return springs[linkId];\n  }\n\n  function getBody(nodeId) {\n    return nodeBodies[nodeId];\n  }\n\n  function listenToEvents() {\n    graph.on('changed', onGraphChanged);\n  }\n\n  function onStableChanged(isStable) {\n    api.fire('stable', isStable);\n  }\n\n  function onGraphChanged(changes) {\n    for (var i = 0; i < changes.length; ++i) {\n      var change = changes[i];\n      if (change.changeType === 'add') {\n        if (change.node) {\n          initBody(change.node.id);\n        }\n        if (change.link) {\n          initLink(change.link);\n        }\n      } else if (change.changeType === 'remove') {\n        if (change.node) {\n          releaseNode(change.node);\n        }\n        if (change.link) {\n          releaseLink(change.link);\n        }\n      }\n    }\n    bodiesCount = graph.getNodesCount();\n  }\n\n  function initPhysics() {\n    bodiesCount = 0;\n\n    graph.forEachNode(function (node) {\n      initBody(node.id);\n      bodiesCount += 1;\n    });\n\n    graph.forEachLink(initLink);\n  }\n\n  function initBody(nodeId) {\n    var body = nodeBodies[nodeId];\n    if (!body) {\n      var node = graph.getNode(nodeId);\n      if (!node) {\n        throw new Error('initBody() was called with unknown node id');\n      }\n\n      var pos = node.position;\n      if (!pos) {\n        var neighbors = getNeighborBodies(node);\n        pos = physicsSimulator.getBestNewBodyPosition(neighbors);\n      }\n\n      body = physicsSimulator.addBodyAt(pos);\n      body.id = nodeId;\n\n      nodeBodies[nodeId] = body;\n      updateBodyMass(nodeId);\n\n      if (isNodeOriginallyPinned(node)) {\n        body.isPinned = true;\n      }\n    }\n  }\n\n  function releaseNode(node) {\n    var nodeId = node.id;\n    var body = nodeBodies[nodeId];\n    if (body) {\n      nodeBodies[nodeId] = null;\n      delete nodeBodies[nodeId];\n\n      physicsSimulator.removeBody(body);\n    }\n  }\n\n  function initLink(link) {\n    updateBodyMass(link.fromId);\n    updateBodyMass(link.toId);\n\n    var fromBody = nodeBodies[link.fromId],\n        toBody  = nodeBodies[link.toId],\n        spring = physicsSimulator.addSpring(fromBody, toBody, link.length);\n\n    springTransform(link, spring);\n\n    springs[link.id] = spring;\n  }\n\n  function releaseLink(link) {\n    var spring = springs[link.id];\n    if (spring) {\n      var from = graph.getNode(link.fromId),\n          to = graph.getNode(link.toId);\n\n      if (from) updateBodyMass(from.id);\n      if (to) updateBodyMass(to.id);\n\n      delete springs[link.id];\n\n      physicsSimulator.removeSpring(spring);\n    }\n  }\n\n  function getNeighborBodies(node) {\n    // TODO: Could probably be done better on memory\n    var neighbors = [];\n    if (!node.links) {\n      return neighbors;\n    }\n    var maxNeighbors = Math.min(node.links.length, 2);\n    for (var i = 0; i < maxNeighbors; ++i) {\n      var link = node.links[i];\n      var otherBody = link.fromId !== node.id ? nodeBodies[link.fromId] : nodeBodies[link.toId];\n      if (otherBody && otherBody.pos) {\n        neighbors.push(otherBody);\n      }\n    }\n\n    return neighbors;\n  }\n\n  function updateBodyMass(nodeId) {\n    var body = nodeBodies[nodeId];\n    body.mass = nodeMass(nodeId);\n    if (Number.isNaN(body.mass)) {\n      throw new Error('Node mass should be a number')\n    }\n  }\n\n  /**\n   * Checks whether graph node has in its settings pinned attribute,\n   * which means layout algorithm cannot move it. Node can be preconfigured\n   * as pinned, if it has \"isPinned\" attribute, or when node.data has it.\n   *\n   * @param {Object} node a graph node to check\n   * @return {Boolean} true if node should be treated as pinned; false otherwise.\n   */\n  function isNodeOriginallyPinned(node) {\n    return (node && (node.isPinned || (node.data && node.data.isPinned)));\n  }\n\n  function getInitializedBody(nodeId) {\n    var body = nodeBodies[nodeId];\n    if (!body) {\n      initBody(nodeId);\n      body = nodeBodies[nodeId];\n    }\n    return body;\n  }\n\n  /**\n   * Calculates mass of a body, which corresponds to node with given id.\n   *\n   * @param {String|Number} nodeId identifier of a node, for which body mass needs to be calculated\n   * @returns {Number} recommended mass of the body;\n   */\n  function defaultNodeMass(nodeId) {\n    var links = graph.getLinks(nodeId);\n    if (!links) return 1;\n    return 1 + links.length / 3.0;\n  }\n}\n\nfunction noop() { }\n","module.exports = function(subject) {\n  validateSubject(subject);\n\n  var eventsStorage = createEventsStorage(subject);\n  subject.on = eventsStorage.on;\n  subject.off = eventsStorage.off;\n  subject.fire = eventsStorage.fire;\n  return subject;\n};\n\nfunction createEventsStorage(subject) {\n  // Store all event listeners to this hash. Key is event name, value is array\n  // of callback records.\n  //\n  // A callback record consists of callback function and its optional context:\n  // { 'eventName' => [{callback: function, ctx: object}] }\n  var registeredEvents = Object.create(null);\n\n  return {\n    on: function (eventName, callback, ctx) {\n      if (typeof callback !== 'function') {\n        throw new Error('callback is expected to be a function');\n      }\n      var handlers = registeredEvents[eventName];\n      if (!handlers) {\n        handlers = registeredEvents[eventName] = [];\n      }\n      handlers.push({callback: callback, ctx: ctx});\n\n      return subject;\n    },\n\n    off: function (eventName, callback) {\n      var wantToRemoveAll = (typeof eventName === 'undefined');\n      if (wantToRemoveAll) {\n        // Killing old events storage should be enough in this case:\n        registeredEvents = Object.create(null);\n        return subject;\n      }\n\n      if (registeredEvents[eventName]) {\n        var deleteAllCallbacksForEvent = (typeof callback !== 'function');\n        if (deleteAllCallbacksForEvent) {\n          delete registeredEvents[eventName];\n        } else {\n          var callbacks = registeredEvents[eventName];\n          for (var i = 0; i < callbacks.length; ++i) {\n            if (callbacks[i].callback === callback) {\n              callbacks.splice(i, 1);\n            }\n          }\n        }\n      }\n\n      return subject;\n    },\n\n    fire: function (eventName) {\n      var callbacks = registeredEvents[eventName];\n      if (!callbacks) {\n        return subject;\n      }\n\n      var fireArguments;\n      if (arguments.length > 1) {\n        fireArguments = Array.prototype.splice.call(arguments, 1);\n      }\n      for(var i = 0; i < callbacks.length; ++i) {\n        var callbackInfo = callbacks[i];\n        callbackInfo.callback.apply(callbackInfo.ctx, fireArguments);\n      }\n\n      return subject;\n    }\n  };\n}\n\nfunction validateSubject(subject) {\n  if (!subject) {\n    throw new Error('Eventify cannot use falsy object as events subject');\n  }\n  var reservedWords = ['on', 'fire', 'off'];\n  for (var i = 0; i < reservedWords.length; ++i) {\n    if (subject.hasOwnProperty(reservedWords[i])) {\n      throw new Error(\"Subject cannot be eventified, since it already has property '\" + reservedWords[i] + \"'\");\n    }\n  }\n}\n","module.exports = load;\n\nvar createGraph = require('ngraph.graph');\n\nfunction load(jsonGraph, nodeTransform, linkTransform) {\n  var stored;\n  nodeTransform = nodeTransform || id;\n  linkTransform = linkTransform || id;\n  if (typeof jsonGraph === 'string') {\n    stored = JSON.parse(jsonGraph);\n  } else {\n    stored = jsonGraph;\n  }\n\n  var graph = createGraph(),\n      i;\n\n  if (stored.links === undefined || stored.nodes === undefined) {\n    throw new Error('Cannot load graph without links and nodes');\n  }\n\n  for (i = 0; i < stored.nodes.length; ++i) {\n    var parsedNode = nodeTransform(stored.nodes[i]);\n    if (!parsedNode.hasOwnProperty('id')) {\n      throw new Error('Graph node format is invalid: Node id is missing');\n    }\n\n    graph.addNode(parsedNode.id, parsedNode.data);\n  }\n\n  for (i = 0; i < stored.links.length; ++i) {\n    var link = linkTransform(stored.links[i]);\n    if (!link.hasOwnProperty('fromId') || !link.hasOwnProperty('toId')) {\n      throw new Error('Graph link format is invalid. Both fromId and toId are required');\n    }\n\n    graph.addLink(link.fromId, link.toId, link.data);\n  }\n\n  return graph;\n}\n\nfunction id(x) { return x; }\n","var createGraph = require('ngraph.graph');\n\nmodule.exports = factory(createGraph);\n\n// Allow other developers have their own createGraph\nmodule.exports.factory = factory;\n\nfunction factory(createGraph) {\n  return {\n    ladder: ladder,\n    complete: complete,\n    completeBipartite: completeBipartite,\n    balancedBinTree: balancedBinTree,\n    path: path,\n    circularLadder: circularLadder,\n    grid: grid,\n    grid3: grid3,\n    noLinks: noLinks,\n    wattsStrogatz: wattsStrogatz,\n    cliqueCircle: cliqueCircle\n  };\n\n\n  function ladder(n) {\n  /**\n  * Ladder graph is a graph in form of ladder\n  * @param {Number} n Represents number of steps in the ladder\n  */\n    if (!n || n < 0) {\n      throw new Error(\"Invalid number of nodes\");\n    }\n\n    var g = createGraph(),\n        i;\n\n    for (i = 0; i < n - 1; ++i) {\n      g.addLink(i, i + 1);\n      // first row\n      g.addLink(n + i, n + i + 1);\n      // second row\n      g.addLink(i, n + i);\n      // ladder's step\n    }\n\n    g.addLink(n - 1, 2 * n - 1);\n    // last step in the ladder;\n\n    return g;\n  }\n\n  function circularLadder(n) {\n  /**\n  * Circular ladder with n steps.\n  *\n  * @param {Number} n of steps in the ladder.\n  */\n      if (!n || n < 0) {\n          throw new Error(\"Invalid number of nodes\");\n      }\n\n      var g = ladder(n);\n\n      g.addLink(0, n - 1);\n      g.addLink(n, 2 * n - 1);\n      return g;\n  }\n\n  function complete(n) {\n  /**\n  * Complete graph Kn.\n  *\n  * @param {Number} n represents number of nodes in the complete graph.\n  */\n    if (!n || n < 1) {\n      throw new Error(\"At least two nodes are expected for complete graph\");\n    }\n\n    var g = createGraph(),\n        i,\n        j;\n\n    for (i = 0; i < n; ++i) {\n      for (j = i + 1; j < n; ++j) {\n        if (i !== j) {\n          g.addLink(i, j);\n        }\n      }\n    }\n\n    return g;\n  }\n\n  function completeBipartite (n, m) {\n  /**\n  * Complete bipartite graph K n,m. Each node in the\n  * first partition is connected to all nodes in the second partition.\n  *\n  * @param {Number} n represents number of nodes in the first graph partition\n  * @param {Number} m represents number of nodes in the second graph partition\n  */\n    if (!n || !m || n < 0 || m < 0) {\n      throw new Error(\"Graph dimensions are invalid. Number of nodes in each partition should be greater than 0\");\n    }\n\n    var g = createGraph(),\n        i, j;\n\n    for (i = 0; i < n; ++i) {\n      for (j = n; j < n + m; ++j) {\n        g.addLink(i, j);\n      }\n    }\n\n    return g;\n  }\n\n  function path(n) {\n  /**\n  * Path graph with n steps.\n  *\n  * @param {Number} n number of nodes in the path\n  */\n    if (!n || n < 0) {\n      throw new Error(\"Invalid number of nodes\");\n    }\n\n    var g = createGraph(),\n        i;\n\n    g.addNode(0);\n\n    for (i = 1; i < n; ++i) {\n      g.addLink(i - 1, i);\n    }\n\n    return g;\n  }\n\n\n  function grid(n, m) {\n  /**\n  * Grid graph with n rows and m columns.\n  *\n  * @param {Number} n of rows in the graph.\n  * @param {Number} m of columns in the graph.\n  */\n    if (n < 1 || m < 1) {\n      throw new Error(\"Invalid number of nodes in grid graph\");\n    }\n    var g = createGraph(),\n        i,\n        j;\n    if (n === 1 && m === 1) {\n      g.addNode(0);\n      return g;\n    }\n\n    for (i = 0; i < n; ++i) {\n      for (j = 0; j < m; ++j) {\n        var node = i + j * n;\n        if (i > 0) { g.addLink(node, i - 1 + j * n); }\n        if (j > 0) { g.addLink(node, i + (j - 1) * n); }\n      }\n    }\n\n    return g;\n  }\n\n  function grid3(n, m, z) {\n  /**\n  * 3D grid with n rows and m columns and z levels.\n  *\n  * @param {Number} n of rows in the graph.\n  * @param {Number} m of columns in the graph.\n  * @param {Number} z of levels in the graph.\n  */\n    if (n < 1 || m < 1 || z < 1) {\n      throw new Error(\"Invalid number of nodes in grid3 graph\");\n    }\n    var g = createGraph(),\n        i, j, k;\n\n    if (n === 1 && m === 1 && z === 1) {\n      g.addNode(0);\n      return g;\n    }\n\n    for (k = 0; k < z; ++k) {\n      for (i = 0; i < n; ++i) {\n        for (j = 0; j < m; ++j) {\n          var level = k * n * m;\n          var node = i + j * n + level;\n          if (i > 0) { g.addLink(node, i - 1 + j * n + level); }\n          if (j > 0) { g.addLink(node, i + (j - 1) * n + level); }\n          if (k > 0) { g.addLink(node, i + j * n + (k - 1) * n * m ); }\n        }\n      }\n    }\n\n    return g;\n  }\n\n  function balancedBinTree(n) {\n  /**\n  * Balanced binary tree with n levels.\n  *\n  * @param {Number} n of levels in the binary tree\n  */\n    if (n < 0) {\n      throw new Error(\"Invalid number of nodes in balanced tree\");\n    }\n    var g = createGraph(),\n        count = Math.pow(2, n),\n        level;\n\n    if (n === 0) {\n      g.addNode(1);\n    }\n\n    for (level = 1; level < count; ++level) {\n      var root = level,\n        left = root * 2,\n        right = root * 2 + 1;\n\n      g.addLink(root, left);\n      g.addLink(root, right);\n    }\n\n    return g;\n  }\n\n  function noLinks(n) {\n  /**\n  * Graph with no links\n  *\n  * @param {Number} n of nodes in the graph\n  */\n    if (n < 0) {\n      throw new Error(\"Number of nodes should be >= 0\");\n    }\n\n    var g = createGraph(), i;\n    for (i = 0; i < n; ++i) {\n      g.addNode(i);\n    }\n\n    return g;\n  }\n\n  function cliqueCircle(cliqueCount, cliqueSize) {\n  /**\n  * A circular graph with cliques instead of individual nodes\n  *\n  * @param {Number} cliqueCount number of cliques inside circle\n  * @param {Number} cliqueSize number of nodes inside each clique\n  */\n\n    if (cliqueCount < 1) throw new Error('Invalid number of cliqueCount in cliqueCircle');\n    if (cliqueSize < 1) throw new Error('Invalid number of cliqueSize in cliqueCircle');\n\n    var graph = createGraph();\n\n    for (var i = 0; i < cliqueCount; ++i) {\n      appendClique(cliqueSize, i * cliqueSize)\n\n      if (i > 0) {\n        graph.addLink(i * cliqueSize, i * cliqueSize - 1);\n      }\n    }\n    graph.addLink(0, graph.getNodesCount() - 1);\n\n    return graph;\n\n    function appendClique(size, from) {\n      for (var i = 0; i < size; ++i) {\n        graph.addNode(i + from)\n      }\n\n      for (var i = 0; i < size; ++i) {\n        for (var j = i + 1; j < size; ++j) {\n          graph.addLink(i + from, j + from)\n        }\n      }\n    }\n  }\n\n  function wattsStrogatz(n, k, p, seed) {\n  /**\n  * Watts-Strogatz small-world graph.\n  *\n  * @param {Number} n The number of nodes\n  * @param {Number} k Each node is connected to k nearest neighbors in ring topology\n  * @param {Number} p The probability of rewiring each edge\n\n  * @see https://github.com/networkx/networkx/blob/master/networkx/generators/random_graphs.py\n  */\n    if (k >= n) throw new Error('Choose smaller `k`. It cannot be larger than number of nodes `n`');\n\n\n    var random = require('ngraph.random').random(seed || 42);\n\n    var g = createGraph(), i, to;\n    for (i = 0; i < n; ++i) {\n      g.addNode(i);\n    }\n\n    // connect each node to k/2 neighbors\n    var neighborsSize = Math.floor(k/2 + 1);\n    for (var j = 1; j < neighborsSize; ++j) {\n      for (i = 0; i < n; ++i) {\n        to = (j + i) % n;\n        g.addLink(i, to);\n      }\n    }\n\n    // rewire edges from each node\n    // loop over all nodes in order (label) and neighbors in order (distance)\n    // no self loops or multiple edges allowed\n    for (j = 1; j < neighborsSize; ++j) {\n      for (i = 0; i < n; ++i) {\n        if (random.nextDouble() < p) {\n          var from = i;\n          to = (j + i) % n;\n\n          var newTo = random.next(n);\n          var needsRewire = (newTo === from || g.hasLink(from, newTo));\n          if (needsRewire && g.getLinks(from).length === n - 1) {\n            // we cannot rewire this node, it has too many links.\n            continue;\n          }\n          // Enforce no self-loops or multiple edges\n          while (needsRewire) {\n            newTo = random.next(n);\n            needsRewire = (newTo === from || g.hasLink(from, newTo));\n          }\n          var link = g.hasLink(from, to);\n          g.removeLink(link);\n          g.addLink(from, newTo);\n        }\n      }\n    }\n\n    return g;\n  }\n}\n","module.exports = random;\n\n// TODO: Deprecate?\nmodule.exports.random = random,\nmodule.exports.randomIterator = randomIterator\n\n/**\n * Creates seeded PRNG with two methods:\n *   next() and nextDouble()\n */\nfunction random(inputSeed) {\n  var seed = typeof inputSeed === 'number' ? inputSeed : (+new Date());\n  return new Generator(seed)\n}\n\nfunction Generator(seed) {\n  this.seed = seed;\n}\n\n/**\n  * Generates random integer number in the range from 0 (inclusive) to maxValue (exclusive)\n  *\n  * @param maxValue Number REQUIRED. Omitting this number will result in NaN values from PRNG.\n  */\nGenerator.prototype.next = next;\n\n/**\n  * Generates random double number in the range from 0 (inclusive) to 1 (exclusive)\n  * This function is the same as Math.random() (except that it could be seeded)\n  */\nGenerator.prototype.nextDouble = nextDouble;\n\n/**\n * Returns a random real number uniformly in [0, 1)\n */\nGenerator.prototype.uniform = nextDouble;\n\nGenerator.prototype.gaussian = gaussian;\n\nfunction gaussian() {\n  // use the polar form of the Box-Muller transform\n  // based on https://introcs.cs.princeton.edu/java/23recursion/StdRandom.java\n  var r, x, y;\n  do {\n    x = this.nextDouble() * 2 - 1;\n    y = this.nextDouble() * 2 - 1;\n    r = x * x + y * y;\n  } while (r >= 1 || r === 0);\n\n  return x * Math.sqrt(-2 * Math.log(r)/r);\n}\n\nfunction nextDouble() {\n  var seed = this.seed;\n  // Robert Jenkins' 32 bit integer hash function.\n  seed = ((seed + 0x7ed55d16) + (seed << 12)) & 0xffffffff;\n  seed = ((seed ^ 0xc761c23c) ^ (seed >>> 19)) & 0xffffffff;\n  seed = ((seed + 0x165667b1) + (seed << 5)) & 0xffffffff;\n  seed = ((seed + 0xd3a2646c) ^ (seed << 9)) & 0xffffffff;\n  seed = ((seed + 0xfd7046c5) + (seed << 3)) & 0xffffffff;\n  seed = ((seed ^ 0xb55a4f09) ^ (seed >>> 16)) & 0xffffffff;\n  this.seed = seed;\n  return (seed & 0xfffffff) / 0x10000000;\n}\n\nfunction next(maxValue) {\n  return Math.floor(this.nextDouble() * maxValue);\n}\n\n/*\n * Creates iterator over array, which returns items of array in random order\n * Time complexity is guaranteed to be O(n);\n */\nfunction randomIterator(array, customRandom) {\n  var localRandom = customRandom || random();\n  if (typeof localRandom.next !== 'function') {\n    throw new Error('customRandom does not match expected API: next() function is missing');\n  }\n\n  return {\n    forEach: forEach,\n\n    /**\n     * Shuffles array randomly, in place.\n     */\n    shuffle: shuffle\n  };\n\n  function shuffle() {\n    var i, j, t;\n    for (i = array.length - 1; i > 0; --i) {\n      j = localRandom.next(i + 1); // i inclusive\n      t = array[j];\n      array[j] = array[i];\n      array[i] = t;\n    }\n\n    return array;\n  }\n\n  function forEach(callback) {\n    var i, j, t;\n    for (i = array.length - 1; i > 0; --i) {\n      j = localRandom.next(i + 1); // i inclusive\n      t = array[j];\n      array[j] = array[i];\n      array[i] = t;\n\n      callback(t);\n    }\n\n    if (array.length) {\n      callback(array[0]);\n    }\n  }\n}","/**\n * @fileOverview Contains definition of the core graph object.\n */\n\n// TODO: need to change storage layer:\n// 1. Be able to get all nodes O(1)\n// 2. Be able to get number of links O(1)\n\n/**\n * @example\n *  var graph = require('ngraph.graph')();\n *  graph.addNode(1);     // graph has one node.\n *  graph.addLink(2, 3);  // now graph contains three nodes and one link.\n *\n */\nmodule.exports = createGraph;\n\nvar eventify = require('ngraph.events');\n\n/**\n * Creates a new graph\n */\nfunction createGraph(options) {\n  // Graph structure is maintained as dictionary of nodes\n  // and array of links. Each node has 'links' property which\n  // hold all links related to that node. And general links\n  // array is used to speed up all links enumeration. This is inefficient\n  // in terms of memory, but simplifies coding.\n  options = options || {};\n  if ('uniqueLinkId' in options) {\n    console.warn(\n      'ngraph.graph: Starting from version 0.14 `uniqueLinkId` is deprecated.\\n' +\n      'Use `multigraph` option instead\\n',\n      '\\n',\n      'Note: there is also change in default behavior: From now own each graph\\n'+\n      'is considered to be not a multigraph by default (each edge is unique).'\n    );\n\n    options.multigraph = options.uniqueLinkId;\n  }\n\n  // Dear reader, the non-multigraphs do not guarantee that there is only\n  // one link for a given pair of node. When this option is set to false\n  // we can save some memory and CPU (18% faster for non-multigraph);\n  if (options.multigraph === undefined) options.multigraph = false;\n\n  var nodes = typeof Object.create === 'function' ? Object.create(null) : {},\n    links = [],\n    // Hash of multi-edges. Used to track ids of edges between same nodes\n    multiEdges = {},\n    nodesCount = 0,\n    suspendEvents = 0,\n\n    forEachNode = createNodeIterator(),\n    createLink = options.multigraph ? createUniqueLink : createSingleLink,\n\n    // Our graph API provides means to listen to graph changes. Users can subscribe\n    // to be notified about changes in the graph by using `on` method. However\n    // in some cases they don't use it. To avoid unnecessary memory consumption\n    // we will not record graph changes until we have at least one subscriber.\n    // Code below supports this optimization.\n    //\n    // Accumulates all changes made during graph updates.\n    // Each change element contains:\n    //  changeType - one of the strings: 'add', 'remove' or 'update';\n    //  node - if change is related to node this property is set to changed graph's node;\n    //  link - if change is related to link this property is set to changed graph's link;\n    changes = [],\n    recordLinkChange = noop,\n    recordNodeChange = noop,\n    enterModification = noop,\n    exitModification = noop;\n\n  // this is our public API:\n  var graphPart = {\n    /**\n     * Adds node to the graph. If node with given id already exists in the graph\n     * its data is extended with whatever comes in 'data' argument.\n     *\n     * @param nodeId the node's identifier. A string or number is preferred.\n     * @param [data] additional data for the node being added. If node already\n     *   exists its data object is augmented with the new one.\n     *\n     * @return {node} The newly added node or node with given id if it already exists.\n     */\n    addNode: addNode,\n\n    /**\n     * Adds a link to the graph. The function always create a new\n     * link between two nodes. If one of the nodes does not exists\n     * a new node is created.\n     *\n     * @param fromId link start node id;\n     * @param toId link end node id;\n     * @param [data] additional data to be set on the new link;\n     *\n     * @return {link} The newly created link\n     */\n    addLink: addLink,\n\n    /**\n     * Removes link from the graph. If link does not exist does nothing.\n     *\n     * @param link - object returned by addLink() or getLinks() methods.\n     *\n     * @returns true if link was removed; false otherwise.\n     */\n    removeLink: removeLink,\n\n    /**\n     * Removes node with given id from the graph. If node does not exist in the graph\n     * does nothing.\n     *\n     * @param nodeId node's identifier passed to addNode() function.\n     *\n     * @returns true if node was removed; false otherwise.\n     */\n    removeNode: removeNode,\n\n    /**\n     * Gets node with given identifier. If node does not exist undefined value is returned.\n     *\n     * @param nodeId requested node identifier;\n     *\n     * @return {node} in with requested identifier or undefined if no such node exists.\n     */\n    getNode: getNode,\n\n    /**\n     * Gets number of nodes in this graph.\n     *\n     * @return number of nodes in the graph.\n     */\n    getNodesCount: function () {\n      return nodesCount;\n    },\n\n    /**\n     * Gets total number of links in the graph.\n     */\n    getLinksCount: function () {\n      return links.length;\n    },\n\n    /**\n     * Gets all links (inbound and outbound) from the node with given id.\n     * If node with given id is not found null is returned.\n     *\n     * @param nodeId requested node identifier.\n     *\n     * @return Array of links from and to requested node if such node exists;\n     *   otherwise null is returned.\n     */\n    getLinks: getLinks,\n\n    /**\n     * Invokes callback on each node of the graph.\n     *\n     * @param {Function(node)} callback Function to be invoked. The function\n     *   is passed one argument: visited node.\n     */\n    forEachNode: forEachNode,\n\n    /**\n     * Invokes callback on every linked (adjacent) node to the given one.\n     *\n     * @param nodeId Identifier of the requested node.\n     * @param {Function(node, link)} callback Function to be called on all linked nodes.\n     *   The function is passed two parameters: adjacent node and link object itself.\n     * @param oriented if true graph treated as oriented.\n     */\n    forEachLinkedNode: forEachLinkedNode,\n\n    /**\n     * Enumerates all links in the graph\n     *\n     * @param {Function(link)} callback Function to be called on all links in the graph.\n     *   The function is passed one parameter: graph's link object.\n     *\n     * Link object contains at least the following fields:\n     *  fromId - node id where link starts;\n     *  toId - node id where link ends,\n     *  data - additional data passed to graph.addLink() method.\n     */\n    forEachLink: forEachLink,\n\n    /**\n     * Suspend all notifications about graph changes until\n     * endUpdate is called.\n     */\n    beginUpdate: enterModification,\n\n    /**\n     * Resumes all notifications about graph changes and fires\n     * graph 'changed' event in case there are any pending changes.\n     */\n    endUpdate: exitModification,\n\n    /**\n     * Removes all nodes and links from the graph.\n     */\n    clear: clear,\n\n    /**\n     * Detects whether there is a link between two nodes.\n     * Operation complexity is O(n) where n - number of links of a node.\n     * NOTE: this function is synonim for getLink()\n     *\n     * @returns link if there is one. null otherwise.\n     */\n    hasLink: getLink,\n\n    /**\n     * Detects whether there is a node with given id\n     * \n     * Operation complexity is O(1)\n     * NOTE: this function is synonim for getNode()\n     *\n     * @returns node if there is one; Falsy value otherwise.\n     */\n    hasNode: getNode,\n\n    /**\n     * Gets an edge between two nodes.\n     * Operation complexity is O(n) where n - number of links of a node.\n     *\n     * @param {string} fromId link start identifier\n     * @param {string} toId link end identifier\n     *\n     * @returns link if there is one. null otherwise.\n     */\n    getLink: getLink\n  };\n\n  // this will add `on()` and `fire()` methods.\n  eventify(graphPart);\n\n  monitorSubscribers();\n\n  return graphPart;\n\n  function monitorSubscribers() {\n    var realOn = graphPart.on;\n\n    // replace real `on` with our temporary on, which will trigger change\n    // modification monitoring:\n    graphPart.on = on;\n\n    function on() {\n      // now it's time to start tracking stuff:\n      graphPart.beginUpdate = enterModification = enterModificationReal;\n      graphPart.endUpdate = exitModification = exitModificationReal;\n      recordLinkChange = recordLinkChangeReal;\n      recordNodeChange = recordNodeChangeReal;\n\n      // this will replace current `on` method with real pub/sub from `eventify`.\n      graphPart.on = realOn;\n      // delegate to real `on` handler:\n      return realOn.apply(graphPart, arguments);\n    }\n  }\n\n  function recordLinkChangeReal(link, changeType) {\n    changes.push({\n      link: link,\n      changeType: changeType\n    });\n  }\n\n  function recordNodeChangeReal(node, changeType) {\n    changes.push({\n      node: node,\n      changeType: changeType\n    });\n  }\n\n  function addNode(nodeId, data) {\n    if (nodeId === undefined) {\n      throw new Error('Invalid node identifier');\n    }\n\n    enterModification();\n\n    var node = getNode(nodeId);\n    if (!node) {\n      node = new Node(nodeId, data);\n      nodesCount++;\n      recordNodeChange(node, 'add');\n    } else {\n      node.data = data;\n      recordNodeChange(node, 'update');\n    }\n\n    nodes[nodeId] = node;\n\n    exitModification();\n    return node;\n  }\n\n  function getNode(nodeId) {\n    return nodes[nodeId];\n  }\n\n  function removeNode(nodeId) {\n    var node = getNode(nodeId);\n    if (!node) {\n      return false;\n    }\n\n    enterModification();\n\n    var prevLinks = node.links;\n    if (prevLinks) {\n      node.links = null;\n      for(var i = 0; i < prevLinks.length; ++i) {\n        removeLink(prevLinks[i]);\n      }\n    }\n\n    delete nodes[nodeId];\n    nodesCount--;\n\n    recordNodeChange(node, 'remove');\n\n    exitModification();\n\n    return true;\n  }\n\n\n  function addLink(fromId, toId, data) {\n    enterModification();\n\n    var fromNode = getNode(fromId) || addNode(fromId);\n    var toNode = getNode(toId) || addNode(toId);\n\n    var link = createLink(fromId, toId, data);\n\n    links.push(link);\n\n    // TODO: this is not cool. On large graphs potentially would consume more memory.\n    addLinkToNode(fromNode, link);\n    if (fromId !== toId) {\n      // make sure we are not duplicating links for self-loops\n      addLinkToNode(toNode, link);\n    }\n\n    recordLinkChange(link, 'add');\n\n    exitModification();\n\n    return link;\n  }\n\n  function createSingleLink(fromId, toId, data) {\n    var linkId = makeLinkId(fromId, toId);\n    return new Link(fromId, toId, data, linkId);\n  }\n\n  function createUniqueLink(fromId, toId, data) {\n    // TODO: Get rid of this method.\n    var linkId = makeLinkId(fromId, toId);\n    var isMultiEdge = multiEdges.hasOwnProperty(linkId);\n    if (isMultiEdge || getLink(fromId, toId)) {\n      if (!isMultiEdge) {\n        multiEdges[linkId] = 0;\n      }\n      var suffix = '@' + (++multiEdges[linkId]);\n      linkId = makeLinkId(fromId + suffix, toId + suffix);\n    }\n\n    return new Link(fromId, toId, data, linkId);\n  }\n\n  function getLinks(nodeId) {\n    var node = getNode(nodeId);\n    return node ? node.links : null;\n  }\n\n  function removeLink(link) {\n    if (!link) {\n      return false;\n    }\n    var idx = indexOfElementInArray(link, links);\n    if (idx < 0) {\n      return false;\n    }\n\n    enterModification();\n\n    links.splice(idx, 1);\n\n    var fromNode = getNode(link.fromId);\n    var toNode = getNode(link.toId);\n\n    if (fromNode) {\n      idx = indexOfElementInArray(link, fromNode.links);\n      if (idx >= 0) {\n        fromNode.links.splice(idx, 1);\n      }\n    }\n\n    if (toNode) {\n      idx = indexOfElementInArray(link, toNode.links);\n      if (idx >= 0) {\n        toNode.links.splice(idx, 1);\n      }\n    }\n\n    recordLinkChange(link, 'remove');\n\n    exitModification();\n\n    return true;\n  }\n\n  function getLink(fromNodeId, toNodeId) {\n    // TODO: Use sorted links to speed this up\n    var node = getNode(fromNodeId),\n      i;\n    if (!node || !node.links) {\n      return null;\n    }\n\n    for (i = 0; i < node.links.length; ++i) {\n      var link = node.links[i];\n      if (link.fromId === fromNodeId && link.toId === toNodeId) {\n        return link;\n      }\n    }\n\n    return null; // no link.\n  }\n\n  function clear() {\n    enterModification();\n    forEachNode(function(node) {\n      removeNode(node.id);\n    });\n    exitModification();\n  }\n\n  function forEachLink(callback) {\n    var i, length;\n    if (typeof callback === 'function') {\n      for (i = 0, length = links.length; i < length; ++i) {\n        callback(links[i]);\n      }\n    }\n  }\n\n  function forEachLinkedNode(nodeId, callback, oriented) {\n    var node = getNode(nodeId);\n\n    if (node && node.links && typeof callback === 'function') {\n      if (oriented) {\n        return forEachOrientedLink(node.links, nodeId, callback);\n      } else {\n        return forEachNonOrientedLink(node.links, nodeId, callback);\n      }\n    }\n  }\n\n  function forEachNonOrientedLink(links, nodeId, callback) {\n    var quitFast;\n    for (var i = 0; i < links.length; ++i) {\n      var link = links[i];\n      var linkedNodeId = link.fromId === nodeId ? link.toId : link.fromId;\n\n      quitFast = callback(nodes[linkedNodeId], link);\n      if (quitFast) {\n        return true; // Client does not need more iterations. Break now.\n      }\n    }\n  }\n\n  function forEachOrientedLink(links, nodeId, callback) {\n    var quitFast;\n    for (var i = 0; i < links.length; ++i) {\n      var link = links[i];\n      if (link.fromId === nodeId) {\n        quitFast = callback(nodes[link.toId], link);\n        if (quitFast) {\n          return true; // Client does not need more iterations. Break now.\n        }\n      }\n    }\n  }\n\n  // we will not fire anything until users of this library explicitly call `on()`\n  // method.\n  function noop() {}\n\n  // Enter, Exit modification allows bulk graph updates without firing events.\n  function enterModificationReal() {\n    suspendEvents += 1;\n  }\n\n  function exitModificationReal() {\n    suspendEvents -= 1;\n    if (suspendEvents === 0 && changes.length > 0) {\n      graphPart.fire('changed', changes);\n      changes.length = 0;\n    }\n  }\n\n  function createNodeIterator() {\n    // Object.keys iterator is 1.3x faster than `for in` loop.\n    // See `https://github.com/anvaka/ngraph.graph/tree/bench-for-in-vs-obj-keys`\n    // branch for perf test\n    return Object.keys ? objectKeysIterator : forInIterator;\n  }\n\n  function objectKeysIterator(callback) {\n    if (typeof callback !== 'function') {\n      return;\n    }\n\n    var keys = Object.keys(nodes);\n    for (var i = 0; i < keys.length; ++i) {\n      if (callback(nodes[keys[i]])) {\n        return true; // client doesn't want to proceed. Return.\n      }\n    }\n  }\n\n  function forInIterator(callback) {\n    if (typeof callback !== 'function') {\n      return;\n    }\n    var node;\n\n    for (node in nodes) {\n      if (callback(nodes[node])) {\n        return true; // client doesn't want to proceed. Return.\n      }\n    }\n  }\n}\n\n// need this for old browsers. Should this be a separate module?\nfunction indexOfElementInArray(element, array) {\n  if (!array) return -1;\n\n  if (array.indexOf) {\n    return array.indexOf(element);\n  }\n\n  var len = array.length,\n    i;\n\n  for (i = 0; i < len; i += 1) {\n    if (array[i] === element) {\n      return i;\n    }\n  }\n\n  return -1;\n}\n\n/**\n * Internal structure to represent node;\n */\nfunction Node(id, data) {\n  this.id = id;\n  this.links = null;\n  this.data = data;\n}\n\nfunction addLinkToNode(node, link) {\n  if (node.links) {\n    node.links.push(link);\n  } else {\n    node.links = [link];\n  }\n}\n\n/**\n * Internal structure to represent links;\n */\nfunction Link(fromId, toId, data, id) {\n  this.fromId = fromId;\n  this.toId = toId;\n  this.data = data;\n  this.id = id;\n}\n\nfunction hashCode(str) {\n  var hash = 0, i, chr, len;\n  if (str.length == 0) return hash;\n  for (i = 0, len = str.length; i < len; i++) {\n    chr   = str.charCodeAt(i);\n    hash  = ((hash << 5) - hash) + chr;\n    hash |= 0; // Convert to 32bit integer\n  }\n  return hash;\n}\n\nfunction makeLinkId(fromId, toId) {\n  return fromId.toString() + '👉 ' + toId.toString();\n}\n","module.exports = merge;\n\n/**\n * Augments `target` with properties in `options`. Does not override\n * target's properties if they are defined and matches expected type in \n * options\n *\n * @returns {Object} merged object\n */\nfunction merge(target, options) {\n  var key;\n  if (!target) { target = {}; }\n  if (options) {\n    for (key in options) {\n      if (options.hasOwnProperty(key)) {\n        var targetHasIt = target.hasOwnProperty(key),\n            optionsValueType = typeof options[key],\n            shouldReplace = !targetHasIt || (typeof target[key] !== optionsValueType);\n\n        if (shouldReplace) {\n          target[key] = options[key];\n        } else if (optionsValueType === 'object') {\n          // go deep, don't care about loops here, we are simple API!:\n          target[key] = merge(target[key], options[key]);\n        }\n      }\n    }\n  }\n\n  return target;\n}\n","module.exports = {\n  Body: Body,\n  Vector2d: Vector2d,\n  Body3d: Body3d,\n  Vector3d: Vector3d\n};\n\nfunction Body(x, y) {\n  this.pos = new Vector2d(x, y);\n  this.prevPos = new Vector2d(x, y);\n  this.force = new Vector2d();\n  this.velocity = new Vector2d();\n  this.mass = 1;\n}\n\nBody.prototype.setPosition = function (x, y) {\n  this.prevPos.x = this.pos.x = x;\n  this.prevPos.y = this.pos.y = y;\n};\n\nfunction Vector2d(x, y) {\n  if (x && typeof x !== 'number') {\n    // could be another vector\n    this.x = typeof x.x === 'number' ? x.x : 0;\n    this.y = typeof x.y === 'number' ? x.y : 0;\n  } else {\n    this.x = typeof x === 'number' ? x : 0;\n    this.y = typeof y === 'number' ? y : 0;\n  }\n}\n\nVector2d.prototype.reset = function () {\n  this.x = this.y = 0;\n};\n\nfunction Body3d(x, y, z) {\n  this.pos = new Vector3d(x, y, z);\n  this.prevPos = new Vector3d(x, y, z);\n  this.force = new Vector3d();\n  this.velocity = new Vector3d();\n  this.mass = 1;\n}\n\nBody3d.prototype.setPosition = function (x, y, z) {\n  this.prevPos.x = this.pos.x = x;\n  this.prevPos.y = this.pos.y = y;\n  this.prevPos.z = this.pos.z = z;\n};\n\nfunction Vector3d(x, y, z) {\n  if (x && typeof x !== 'number') {\n    // could be another vector\n    this.x = typeof x.x === 'number' ? x.x : 0;\n    this.y = typeof x.y === 'number' ? x.y : 0;\n    this.z = typeof x.z === 'number' ? x.z : 0;\n  } else {\n    this.x = typeof x === 'number' ? x : 0;\n    this.y = typeof y === 'number' ? y : 0;\n    this.z = typeof z === 'number' ? z : 0;\n  }\n};\n\nVector3d.prototype.reset = function () {\n  this.x = this.y = this.z = 0;\n};\n","/**\n * Manages a simulation of physical forces acting on bodies and springs.\n */\nmodule.exports = physicsSimulator;\n\nfunction physicsSimulator(settings) {\n  var Spring = require('./lib/spring');\n  var expose = require('ngraph.expose');\n  var merge = require('ngraph.merge');\n  var eventify = require('ngraph.events');\n\n  settings = merge(settings, {\n      /**\n       * Ideal length for links (springs in physical model).\n       */\n      springLength: 30,\n\n      /**\n       * Hook's law coefficient. 1 - solid spring.\n       */\n      springCoeff: 0.0008,\n\n      /**\n       * Coulomb's law coefficient. It's used to repel nodes thus should be negative\n       * if you make it positive nodes start attract each other :).\n       */\n      gravity: -1.2,\n\n      /**\n       * Theta coefficient from Barnes Hut simulation. Ranged between (0, 1).\n       * The closer it's to 1 the more nodes algorithm will have to go through.\n       * Setting it to one makes Barnes Hut simulation no different from\n       * brute-force forces calculation (each node is considered).\n       */\n      theta: 0.8,\n\n      /**\n       * Drag force coefficient. Used to slow down system, thus should be less than 1.\n       * The closer it is to 0 the less tight system will be.\n       */\n      dragCoeff: 0.02,\n\n      /**\n       * Default time step (dt) for forces integration\n       */\n      timeStep : 20,\n  });\n\n  // We allow clients to override basic factory methods:\n  var createQuadTree = settings.createQuadTree || require('ngraph.quadtreebh');\n  var createBounds = settings.createBounds || require('./lib/bounds');\n  var createDragForce = settings.createDragForce || require('./lib/dragForce');\n  var createSpringForce = settings.createSpringForce || require('./lib/springForce');\n  var integrate = settings.integrator || require('./lib/eulerIntegrator');\n  var createBody = settings.createBody || require('./lib/createBody');\n\n  var bodies = [], // Bodies in this simulation.\n      springs = [], // Springs in this simulation.\n      quadTree =  createQuadTree(settings),\n      bounds = createBounds(bodies, settings),\n      springForce = createSpringForce(settings),\n      dragForce = createDragForce(settings);\n\n  var bboxNeedsUpdate = true;\n  var totalMovement = 0; // how much movement we made on last step\n\n  var publicApi = {\n    /**\n     * Array of bodies, registered with current simulator\n     *\n     * Note: To add new body, use addBody() method. This property is only\n     * exposed for testing/performance purposes.\n     */\n    bodies: bodies,\n\n    quadTree: quadTree,\n\n    /**\n     * Array of springs, registered with current simulator\n     *\n     * Note: To add new spring, use addSpring() method. This property is only\n     * exposed for testing/performance purposes.\n     */\n    springs: springs,\n\n    /**\n     * Returns settings with which current simulator was initialized\n     */\n    settings: settings,\n\n    /**\n     * Performs one step of force simulation.\n     *\n     * @returns {boolean} true if system is considered stable; False otherwise.\n     */\n    step: function () {\n      accumulateForces();\n\n      var movement = integrate(bodies, settings.timeStep);\n      bounds.update();\n\n      return movement;\n    },\n\n    /**\n     * Adds body to the system\n     *\n     * @param {ngraph.physics.primitives.Body} body physical body\n     *\n     * @returns {ngraph.physics.primitives.Body} added body\n     */\n    addBody: function (body) {\n      if (!body) {\n        throw new Error('Body is required');\n      }\n      bodies.push(body);\n\n      return body;\n    },\n\n    /**\n     * Adds body to the system at given position\n     *\n     * @param {Object} pos position of a body\n     *\n     * @returns {ngraph.physics.primitives.Body} added body\n     */\n    addBodyAt: function (pos) {\n      if (!pos) {\n        throw new Error('Body position is required');\n      }\n      var body = createBody(pos);\n      bodies.push(body);\n\n      return body;\n    },\n\n    /**\n     * Removes body from the system\n     *\n     * @param {ngraph.physics.primitives.Body} body to remove\n     *\n     * @returns {Boolean} true if body found and removed. falsy otherwise;\n     */\n    removeBody: function (body) {\n      if (!body) { return; }\n\n      var idx = bodies.indexOf(body);\n      if (idx < 0) { return; }\n\n      bodies.splice(idx, 1);\n      if (bodies.length === 0) {\n        bounds.reset();\n      }\n      return true;\n    },\n\n    /**\n     * Adds a spring to this simulation.\n     *\n     * @returns {Object} - a handle for a spring. If you want to later remove\n     * spring pass it to removeSpring() method.\n     */\n    addSpring: function (body1, body2, springLength, springWeight, springCoefficient) {\n      if (!body1 || !body2) {\n        throw new Error('Cannot add null spring to force simulator');\n      }\n\n      if (typeof springLength !== 'number') {\n        springLength = -1; // assume global configuration\n      }\n\n      var spring = new Spring(body1, body2, springLength, springCoefficient >= 0 ? springCoefficient : -1, springWeight);\n      springs.push(spring);\n\n      // TODO: could mark simulator as dirty.\n      return spring;\n    },\n\n    /**\n     * Returns amount of movement performed on last step() call\n     */\n    getTotalMovement: function () {\n      return totalMovement;\n    },\n\n    /**\n     * Removes spring from the system\n     *\n     * @param {Object} spring to remove. Spring is an object returned by addSpring\n     *\n     * @returns {Boolean} true if spring found and removed. falsy otherwise;\n     */\n    removeSpring: function (spring) {\n      if (!spring) { return; }\n      var idx = springs.indexOf(spring);\n      if (idx > -1) {\n        springs.splice(idx, 1);\n        return true;\n      }\n    },\n\n    getBestNewBodyPosition: function (neighbors) {\n      return bounds.getBestNewPosition(neighbors);\n    },\n\n    /**\n     * Returns bounding box which covers all bodies\n     */\n    getBBox: function () {\n      if (bboxNeedsUpdate) {\n        bounds.update();\n        bboxNeedsUpdate = false;\n      }\n      return bounds.box;\n    },\n\n    invalidateBBox: function () {\n      bboxNeedsUpdate = true;\n    },\n\n    gravity: function (value) {\n      if (value !== undefined) {\n        settings.gravity = value;\n        quadTree.options({gravity: value});\n        return this;\n      } else {\n        return settings.gravity;\n      }\n    },\n\n    theta: function (value) {\n      if (value !== undefined) {\n        settings.theta = value;\n        quadTree.options({theta: value});\n        return this;\n      } else {\n        return settings.theta;\n      }\n    }\n  };\n\n  // allow settings modification via public API:\n  expose(settings, publicApi);\n\n  eventify(publicApi);\n\n  return publicApi;\n\n  function accumulateForces() {\n    // Accumulate forces acting on bodies.\n    var body,\n        i = bodies.length;\n\n    if (i) {\n      // only add bodies if there the array is not empty:\n      quadTree.insertBodies(bodies); // performance: O(n * log n)\n      while (i--) {\n        body = bodies[i];\n        // If body is pinned there is no point updating its forces - it should\n        // never move:\n        if (!body.isPinned) {\n          body.force.reset();\n\n          quadTree.updateBodyForce(body);\n          dragForce.update(body);\n        }\n      }\n    }\n\n    i = springs.length;\n    while(i--) {\n      springForce.update(springs[i]);\n    }\n  }\n};\n","module.exports = function (bodies, settings) {\n  var random = require('ngraph.random').random(42);\n  var boundingBox =  { x1: 0, y1: 0, x2: 0, y2: 0 };\n\n  return {\n    box: boundingBox,\n\n    update: updateBoundingBox,\n\n    reset : function () {\n      boundingBox.x1 = boundingBox.y1 = 0;\n      boundingBox.x2 = boundingBox.y2 = 0;\n    },\n\n    getBestNewPosition: function (neighbors) {\n      var graphRect = boundingBox;\n\n      var baseX = 0, baseY = 0;\n\n      if (neighbors.length) {\n        for (var i = 0; i < neighbors.length; ++i) {\n          baseX += neighbors[i].pos.x;\n          baseY += neighbors[i].pos.y;\n        }\n\n        baseX /= neighbors.length;\n        baseY /= neighbors.length;\n      } else {\n        baseX = (graphRect.x1 + graphRect.x2) / 2;\n        baseY = (graphRect.y1 + graphRect.y2) / 2;\n      }\n\n      var springLength = settings.springLength;\n      return {\n        x: baseX + random.next(springLength) - springLength / 2,\n        y: baseY + random.next(springLength) - springLength / 2\n      };\n    }\n  };\n\n  function updateBoundingBox() {\n    var i = bodies.length;\n    if (i === 0) { return; } // don't have to wory here.\n\n    var x1 = Number.MAX_VALUE,\n        y1 = Number.MAX_VALUE,\n        x2 = Number.MIN_VALUE,\n        y2 = Number.MIN_VALUE;\n\n    while(i--) {\n      // this is O(n), could it be done faster with quadtree?\n      // how about pinned nodes?\n      var body = bodies[i];\n      if (body.isPinned) {\n        body.pos.x = body.prevPos.x;\n        body.pos.y = body.prevPos.y;\n      } else {\n        body.prevPos.x = body.pos.x;\n        body.prevPos.y = body.pos.y;\n      }\n      if (body.pos.x < x1) {\n        x1 = body.pos.x;\n      }\n      if (body.pos.x > x2) {\n        x2 = body.pos.x;\n      }\n      if (body.pos.y < y1) {\n        y1 = body.pos.y;\n      }\n      if (body.pos.y > y2) {\n        y2 = body.pos.y;\n      }\n    }\n\n    boundingBox.x1 = x1;\n    boundingBox.x2 = x2;\n    boundingBox.y1 = y1;\n    boundingBox.y2 = y2;\n  }\n}\n","var physics = require('ngraph.physics.primitives');\n\nmodule.exports = function(pos) {\n  return new physics.Body(pos);\n}\n","/**\n * Represents drag force, which reduces force value on each step by given\n * coefficient.\n *\n * @param {Object} options for the drag force\n * @param {Number=} options.dragCoeff drag force coefficient. 0.1 by default\n */\nmodule.exports = function (options) {\n  var merge = require('ngraph.merge'),\n      expose = require('ngraph.expose');\n\n  options = merge(options, {\n    dragCoeff: 0.02\n  });\n\n  var api = {\n    update : function (body) {\n      body.force.x -= options.dragCoeff * body.velocity.x;\n      body.force.y -= options.dragCoeff * body.velocity.y;\n    }\n  };\n\n  // let easy access to dragCoeff:\n  expose(options, api, ['dragCoeff']);\n\n  return api;\n};\n","/**\n * Performs forces integration, using given timestep. Uses Euler method to solve\n * differential equation (http://en.wikipedia.org/wiki/Euler_method ).\n *\n * @returns {Number} squared distance of total position updates.\n */\n\nmodule.exports = integrate;\n\nfunction integrate(bodies, timeStep) {\n  var dx = 0, tx = 0,\n      dy = 0, ty = 0,\n      i,\n      max = bodies.length;\n\n  if (max === 0) {\n    return 0;\n  }\n\n  for (i = 0; i < max; ++i) {\n    var body = bodies[i],\n        coeff = timeStep / body.mass;\n\n    body.velocity.x += coeff * body.force.x;\n    body.velocity.y += coeff * body.force.y;\n    var vx = body.velocity.x,\n        vy = body.velocity.y,\n        v = Math.sqrt(vx * vx + vy * vy);\n\n    if (v > 1) {\n      body.velocity.x = vx / v;\n      body.velocity.y = vy / v;\n    }\n\n    dx = timeStep * body.velocity.x;\n    dy = timeStep * body.velocity.y;\n\n    body.pos.x += dx;\n    body.pos.y += dy;\n\n    tx += Math.abs(dx); ty += Math.abs(dy);\n  }\n\n  return (tx * tx + ty * ty)/max;\n}\n","module.exports = Spring;\n\n/**\n * Represents a physical spring. Spring connects two bodies, has rest length\n * stiffness coefficient and optional weight\n */\nfunction Spring(fromBody, toBody, length, coeff, weight) {\n    this.from = fromBody;\n    this.to = toBody;\n    this.length = length;\n    this.coeff = coeff;\n\n    this.weight = typeof weight === 'number' ? weight : 1;\n};\n","/**\n * Represents spring force, which updates forces acting on two bodies, conntected\n * by a spring.\n *\n * @param {Object} options for the spring force\n * @param {Number=} options.springCoeff spring force coefficient.\n * @param {Number=} options.springLength desired length of a spring at rest.\n */\nmodule.exports = function (options) {\n  var merge = require('ngraph.merge');\n  var random = require('ngraph.random').random(42);\n  var expose = require('ngraph.expose');\n\n  options = merge(options, {\n    springCoeff: 0.0002,\n    springLength: 80\n  });\n\n  var api = {\n    /**\n     * Upsates forces acting on a spring\n     */\n    update : function (spring) {\n      var body1 = spring.from,\n          body2 = spring.to,\n          length = spring.length < 0 ? options.springLength : spring.length,\n          dx = body2.pos.x - body1.pos.x,\n          dy = body2.pos.y - body1.pos.y,\n          r = Math.sqrt(dx * dx + dy * dy);\n\n      if (r === 0) {\n          dx = (random.nextDouble() - 0.5) / 50;\n          dy = (random.nextDouble() - 0.5) / 50;\n          r = Math.sqrt(dx * dx + dy * dy);\n      }\n\n      var d = r - length;\n      var coeff = ((!spring.coeff || spring.coeff < 0) ? options.springCoeff : spring.coeff) * d / r * spring.weight;\n\n      body1.force.x += coeff * dx;\n      body1.force.y += coeff * dy;\n\n      body2.force.x -= coeff * dx;\n      body2.force.y -= coeff * dy;\n    }\n  };\n\n  expose(options, api, ['springCoeff', 'springLength']);\n  return api;\n}\n","/**\n * This is Barnes Hut simulation algorithm for 2d case. Implementation\n * is highly optimized (avoids recusion and gc pressure)\n *\n * http://www.cs.princeton.edu/courses/archive/fall03/cs126/assignments/barnes-hut.html\n */\n\nmodule.exports = function(options) {\n  options = options || {};\n  options.gravity = typeof options.gravity === 'number' ? options.gravity : -1;\n  options.theta = typeof options.theta === 'number' ? options.theta : 0.8;\n\n  // we require deterministic randomness here\n  var random = require('ngraph.random').random(1984),\n    Node = require('./node'),\n    InsertStack = require('./insertStack'),\n    isSamePosition = require('./isSamePosition');\n\n  var gravity = options.gravity,\n    updateQueue = [],\n    insertStack = new InsertStack(),\n    theta = options.theta,\n\n    nodesCache = [],\n    currentInCache = 0,\n    root = newNode();\n\n  return {\n    insertBodies: insertBodies,\n    /**\n     * Gets root node if its present\n     */\n    getRoot: function() {\n      return root;\n    },\n    updateBodyForce: update,\n    options: function(newOptions) {\n      if (newOptions) {\n        if (typeof newOptions.gravity === 'number') {\n          gravity = newOptions.gravity;\n        }\n        if (typeof newOptions.theta === 'number') {\n          theta = newOptions.theta;\n        }\n\n        return this;\n      }\n\n      return {\n        gravity: gravity,\n        theta: theta\n      };\n    }\n  };\n\n  function newNode() {\n    // To avoid pressure on GC we reuse nodes.\n    var node = nodesCache[currentInCache];\n    if (node) {\n      node.quad0 = null;\n      node.quad1 = null;\n      node.quad2 = null;\n      node.quad3 = null;\n      node.body = null;\n      node.mass = node.massX = node.massY = 0;\n      node.left = node.right = node.top = node.bottom = 0;\n    } else {\n      node = new Node();\n      nodesCache[currentInCache] = node;\n    }\n\n    ++currentInCache;\n    return node;\n  }\n\n  function update(sourceBody) {\n    var queue = updateQueue,\n      v,\n      dx,\n      dy,\n      r, fx = 0,\n      fy = 0,\n      queueLength = 1,\n      shiftIdx = 0,\n      pushIdx = 1;\n\n    queue[0] = root;\n\n    while (queueLength) {\n      var node = queue[shiftIdx],\n        body = node.body;\n\n      queueLength -= 1;\n      shiftIdx += 1;\n      var differentBody = (body !== sourceBody);\n      if (body && differentBody) {\n        // If the current node is a leaf node (and it is not source body),\n        // calculate the force exerted by the current node on body, and add this\n        // amount to body's net force.\n        dx = body.pos.x - sourceBody.pos.x;\n        dy = body.pos.y - sourceBody.pos.y;\n        r = Math.sqrt(dx * dx + dy * dy);\n\n        if (r === 0) {\n          // Poor man's protection against zero distance.\n          dx = (random.nextDouble() - 0.5) / 50;\n          dy = (random.nextDouble() - 0.5) / 50;\n          r = Math.sqrt(dx * dx + dy * dy);\n        }\n\n        // This is standard gravition force calculation but we divide\n        // by r^3 to save two operations when normalizing force vector.\n        v = gravity * body.mass * sourceBody.mass / (r * r * r);\n        fx += v * dx;\n        fy += v * dy;\n      } else if (differentBody) {\n        // Otherwise, calculate the ratio s / r,  where s is the width of the region\n        // represented by the internal node, and r is the distance between the body\n        // and the node's center-of-mass\n        dx = node.massX / node.mass - sourceBody.pos.x;\n        dy = node.massY / node.mass - sourceBody.pos.y;\n        r = Math.sqrt(dx * dx + dy * dy);\n\n        if (r === 0) {\n          // Sorry about code duplucation. I don't want to create many functions\n          // right away. Just want to see performance first.\n          dx = (random.nextDouble() - 0.5) / 50;\n          dy = (random.nextDouble() - 0.5) / 50;\n          r = Math.sqrt(dx * dx + dy * dy);\n        }\n        // If s / r < θ, treat this internal node as a single body, and calculate the\n        // force it exerts on sourceBody, and add this amount to sourceBody's net force.\n        if ((node.right - node.left) / r < theta) {\n          // in the if statement above we consider node's width only\n          // because the region was squarified during tree creation.\n          // Thus there is no difference between using width or height.\n          v = gravity * node.mass * sourceBody.mass / (r * r * r);\n          fx += v * dx;\n          fy += v * dy;\n        } else {\n          // Otherwise, run the procedure recursively on each of the current node's children.\n\n          // I intentionally unfolded this loop, to save several CPU cycles.\n          if (node.quad0) {\n            queue[pushIdx] = node.quad0;\n            queueLength += 1;\n            pushIdx += 1;\n          }\n          if (node.quad1) {\n            queue[pushIdx] = node.quad1;\n            queueLength += 1;\n            pushIdx += 1;\n          }\n          if (node.quad2) {\n            queue[pushIdx] = node.quad2;\n            queueLength += 1;\n            pushIdx += 1;\n          }\n          if (node.quad3) {\n            queue[pushIdx] = node.quad3;\n            queueLength += 1;\n            pushIdx += 1;\n          }\n        }\n      }\n    }\n\n    sourceBody.force.x += fx;\n    sourceBody.force.y += fy;\n  }\n\n  function insertBodies(bodies) {\n    var x1 = Number.MAX_VALUE,\n      y1 = Number.MAX_VALUE,\n      x2 = Number.MIN_VALUE,\n      y2 = Number.MIN_VALUE,\n      i,\n      max = bodies.length;\n\n    // To reduce quad tree depth we are looking for exact bounding box of all particles.\n    i = max;\n    while (i--) {\n      var x = bodies[i].pos.x;\n      var y = bodies[i].pos.y;\n      if (x < x1) {\n        x1 = x;\n      }\n      if (x > x2) {\n        x2 = x;\n      }\n      if (y < y1) {\n        y1 = y;\n      }\n      if (y > y2) {\n        y2 = y;\n      }\n    }\n\n    // Squarify the bounds.\n    var dx = x2 - x1,\n      dy = y2 - y1;\n    if (dx > dy) {\n      y2 = y1 + dx;\n    } else {\n      x2 = x1 + dy;\n    }\n\n    currentInCache = 0;\n    root = newNode();\n    root.left = x1;\n    root.right = x2;\n    root.top = y1;\n    root.bottom = y2;\n\n    i = max - 1;\n    if (i >= 0) {\n      root.body = bodies[i];\n    }\n    while (i--) {\n      insert(bodies[i], root);\n    }\n  }\n\n  function insert(newBody) {\n    insertStack.reset();\n    insertStack.push(root, newBody);\n\n    while (!insertStack.isEmpty()) {\n      var stackItem = insertStack.pop(),\n        node = stackItem.node,\n        body = stackItem.body;\n\n      if (!node.body) {\n        // This is internal node. Update the total mass of the node and center-of-mass.\n        var x = body.pos.x;\n        var y = body.pos.y;\n        node.mass = node.mass + body.mass;\n        node.massX = node.massX + body.mass * x;\n        node.massY = node.massY + body.mass * y;\n\n        // Recursively insert the body in the appropriate quadrant.\n        // But first find the appropriate quadrant.\n        var quadIdx = 0, // Assume we are in the 0's quad.\n          left = node.left,\n          right = (node.right + left) / 2,\n          top = node.top,\n          bottom = (node.bottom + top) / 2;\n\n        if (x > right) { // somewhere in the eastern part.\n          quadIdx = quadIdx + 1;\n          left = right;\n          right = node.right;\n        }\n        if (y > bottom) { // and in south.\n          quadIdx = quadIdx + 2;\n          top = bottom;\n          bottom = node.bottom;\n        }\n\n        var child = getChild(node, quadIdx);\n        if (!child) {\n          // The node is internal but this quadrant is not taken. Add\n          // subnode to it.\n          child = newNode();\n          child.left = left;\n          child.top = top;\n          child.right = right;\n          child.bottom = bottom;\n          child.body = body;\n\n          setChild(node, quadIdx, child);\n        } else {\n          // continue searching in this quadrant.\n          insertStack.push(child, body);\n        }\n      } else {\n        // We are trying to add to the leaf node.\n        // We have to convert current leaf into internal node\n        // and continue adding two nodes.\n        var oldBody = node.body;\n        node.body = null; // internal nodes do not cary bodies\n\n        if (isSamePosition(oldBody.pos, body.pos)) {\n          // Prevent infinite subdivision by bumping one node\n          // anywhere in this quadrant\n          var retriesCount = 3;\n          do {\n            var offset = random.nextDouble();\n            var dx = (node.right - node.left) * offset;\n            var dy = (node.bottom - node.top) * offset;\n\n            oldBody.pos.x = node.left + dx;\n            oldBody.pos.y = node.top + dy;\n            retriesCount -= 1;\n            // Make sure we don't bump it out of the box. If we do, next iteration should fix it\n          } while (retriesCount > 0 && isSamePosition(oldBody.pos, body.pos));\n\n          if (retriesCount === 0 && isSamePosition(oldBody.pos, body.pos)) {\n            // This is very bad, we ran out of precision.\n            // if we do not return from the method we'll get into\n            // infinite loop here. So we sacrifice correctness of layout, and keep the app running\n            // Next layout iteration should get larger bounding box in the first step and fix this\n            return;\n          }\n        }\n        // Next iteration should subdivide node further.\n        insertStack.push(node, oldBody);\n        insertStack.push(node, body);\n      }\n    }\n  }\n};\n\nfunction getChild(node, idx) {\n  if (idx === 0) return node.quad0;\n  if (idx === 1) return node.quad1;\n  if (idx === 2) return node.quad2;\n  if (idx === 3) return node.quad3;\n  return null;\n}\n\nfunction setChild(node, idx, child) {\n  if (idx === 0) node.quad0 = child;\n  else if (idx === 1) node.quad1 = child;\n  else if (idx === 2) node.quad2 = child;\n  else if (idx === 3) node.quad3 = child;\n}\n","module.exports = InsertStack;\n\n/**\n * Our implmentation of QuadTree is non-recursive to avoid GC hit\n * This data structure represent stack of elements\n * which we are trying to insert into quad tree.\n */\nfunction InsertStack () {\n    this.stack = [];\n    this.popIdx = 0;\n}\n\nInsertStack.prototype = {\n    isEmpty: function() {\n        return this.popIdx === 0;\n    },\n    push: function (node, body) {\n        var item = this.stack[this.popIdx];\n        if (!item) {\n            // we are trying to avoid memory pressue: create new element\n            // only when absolutely necessary\n            this.stack[this.popIdx] = new InsertStackElement(node, body);\n        } else {\n            item.node = node;\n            item.body = body;\n        }\n        ++this.popIdx;\n    },\n    pop: function () {\n        if (this.popIdx > 0) {\n            return this.stack[--this.popIdx];\n        }\n    },\n    reset: function () {\n        this.popIdx = 0;\n    }\n};\n\nfunction InsertStackElement(node, body) {\n    this.node = node; // QuadTree node\n    this.body = body; // physical body which needs to be inserted to node\n}\n","module.exports = function isSamePosition(point1, point2) {\n    var dx = Math.abs(point1.x - point2.x);\n    var dy = Math.abs(point1.y - point2.y);\n\n    return (dx < 1e-8 && dy < 1e-8);\n};\n","/**\n * Internal data structure to represent 2D QuadTree node\n */\nmodule.exports = function Node() {\n  // body stored inside this node. In quad tree only leaf nodes (by construction)\n  // contain boides:\n  this.body = null;\n\n  // Child nodes are stored in quads. Each quad is presented by number:\n  // 0 | 1\n  // -----\n  // 2 | 3\n  this.quad0 = null;\n  this.quad1 = null;\n  this.quad2 = null;\n  this.quad3 = null;\n\n  // Total mass of current node\n  this.mass = 0;\n\n  // Center of mass coordinates\n  this.massX = 0;\n  this.massY = 0;\n\n  // bounding box coordinates\n  this.left = 0;\n  this.top = 0;\n  this.bottom = 0;\n  this.right = 0;\n};\n","module.exports = {\n  random: random,\n  randomIterator: randomIterator\n};\n\n/**\n * Creates seeded PRNG with two methods:\n *   next() and nextDouble()\n */\nfunction random(inputSeed) {\n  var seed = typeof inputSeed === 'number' ? inputSeed : (+ new Date());\n  var randomFunc = function() {\n      // Robert Jenkins' 32 bit integer hash function.\n      seed = ((seed + 0x7ed55d16) + (seed << 12))  & 0xffffffff;\n      seed = ((seed ^ 0xc761c23c) ^ (seed >>> 19)) & 0xffffffff;\n      seed = ((seed + 0x165667b1) + (seed << 5))   & 0xffffffff;\n      seed = ((seed + 0xd3a2646c) ^ (seed << 9))   & 0xffffffff;\n      seed = ((seed + 0xfd7046c5) + (seed << 3))   & 0xffffffff;\n      seed = ((seed ^ 0xb55a4f09) ^ (seed >>> 16)) & 0xffffffff;\n      return (seed & 0xfffffff) / 0x10000000;\n  };\n\n  return {\n      /**\n       * Generates random integer number in the range from 0 (inclusive) to maxValue (exclusive)\n       *\n       * @param maxValue Number REQUIRED. Ommitting this number will result in NaN values from PRNG.\n       */\n      next : function (maxValue) {\n          return Math.floor(randomFunc() * maxValue);\n      },\n\n      /**\n       * Generates random double number in the range from 0 (inclusive) to 1 (exclusive)\n       * This function is the same as Math.random() (except that it could be seeded)\n       */\n      nextDouble : function () {\n          return randomFunc();\n      }\n  };\n}\n\n/*\n * Creates iterator over array, which returns items of array in random order\n * Time complexity is guaranteed to be O(n);\n */\nfunction randomIterator(array, customRandom) {\n    var localRandom = customRandom || random();\n    if (typeof localRandom.next !== 'function') {\n      throw new Error('customRandom does not match expected API: next() function is missing');\n    }\n\n    return {\n        forEach : function (callback) {\n            var i, j, t;\n            for (i = array.length - 1; i > 0; --i) {\n                j = localRandom.next(i + 1); // i inclusive\n                t = array[j];\n                array[j] = array[i];\n                array[i] = t;\n\n                callback(t);\n            }\n\n            if (array.length) {\n                callback(array[0]);\n            }\n        },\n\n        /**\n         * Shuffles array randomly, in place.\n         */\n        shuffle : function () {\n            var i, j, t;\n            for (i = array.length - 1; i > 0; --i) {\n                j = localRandom.next(i + 1); // i inclusive\n                t = array[j];\n                array[j] = array[i];\n                array[i] = t;\n            }\n\n            return array;\n        }\n    };\n}\n","module.exports = save;\n\nfunction save(graph, customNodeTransform, customLinkTransform) {\n  // Object contains `nodes` and `links` arrays.\n  var result = {\n    nodes: [],\n    links: []\n  };\n\n  var nodeTransform = customNodeTransform || defaultTransformForNode;\n  var linkTransform = customLinkTransform || defaultTransformForLink;\n\n  graph.forEachNode(saveNode);\n  graph.forEachLink(saveLink);\n\n  return JSON.stringify(result);\n\n  function saveNode(node) {\n    // Each node of the graph is processed to take only required fields\n    // `id` and `data`\n    result.nodes.push(nodeTransform(node));\n  }\n\n  function saveLink(link) {\n    // Each link of the graph is also processed to take `fromId`, `toId` and\n    // `data`\n    result.links.push(linkTransform(link));\n  }\n\n  function defaultTransformForNode(node) {\n    var result = {\n      id: node.id\n    };\n    // We don't want to store undefined fields when it's not necessary:\n    if (node.data !== undefined) {\n      result.data = node.data;\n    }\n\n    return result;\n  }\n\n  function defaultTransformForLink(link) {\n    var result = {\n      fromId: link.fromId,\n      toId: link.toId,\n    };\n\n    if (link.data !== undefined) {\n      result.data = link.data;\n    }\n\n    return result;\n  }\n}\n","module.exports = svg;\n\nsvg.compile = require('./lib/compile');\n\nvar compileTemplate = svg.compileTemplate = require('./lib/compile_template');\n\nvar domEvents = require('add-event-listener');\n\nvar svgns = \"http://www.w3.org/2000/svg\";\nvar xlinkns = \"http://www.w3.org/1999/xlink\";\n\nfunction svg(element, attrBag) {\n  var svgElement = augment(element);\n  if (attrBag === undefined) {\n    return svgElement;\n  }\n\n  var attributes = Object.keys(attrBag);\n  for (var i = 0; i < attributes.length; ++i) {\n    var attributeName = attributes[i];\n    var value = attrBag[attributeName];\n    if (attributeName === 'link') {\n      svgElement.link(value);\n    } else {\n      svgElement.attr(attributeName, value);\n    }\n  }\n\n  return svgElement;\n}\n\nfunction augment(element) {\n  var svgElement = element;\n\n  if (typeof element === \"string\") {\n    svgElement = window.document.createElementNS(svgns, element);\n  } else if (element.simplesvg) {\n    return element;\n  }\n\n  var compiledTempalte;\n\n  svgElement.simplesvg = true; // this is not good, since we are monkey patching svg\n  svgElement.attr = attr;\n  svgElement.append = append;\n  svgElement.link = link;\n  svgElement.text = text;\n\n  // add easy eventing\n  svgElement.on = on;\n  svgElement.off = off;\n\n  // data binding:\n  svgElement.dataSource = dataSource;\n\n  return svgElement;\n\n  function dataSource(model) {\n    if (!compiledTempalte) compiledTempalte = compileTemplate(svgElement);\n    compiledTempalte.link(model);\n    return svgElement;\n  }\n\n  function on(name, cb, useCapture) {\n    domEvents.addEventListener(svgElement, name, cb, useCapture);\n    return svgElement;\n  }\n\n  function off(name, cb, useCapture) {\n    domEvents.removeEventListener(svgElement, name, cb, useCapture);\n    return svgElement;\n  }\n\n  function append(content) {\n    var child = svg(content);\n    svgElement.appendChild(child);\n\n    return child;\n  }\n\n  function attr(name, value) {\n    if (arguments.length === 2) {\n      if (value !== null) {\n        svgElement.setAttributeNS(null, name, value);\n      } else {\n        svgElement.removeAttributeNS(null, name);\n      }\n\n      return svgElement;\n    }\n\n    return svgElement.getAttributeNS(null, name);\n  }\n\n  function link(target) {\n    if (arguments.length) {\n      svgElement.setAttributeNS(xlinkns, \"xlink:href\", target);\n      return svgElement;\n    }\n\n    return svgElement.getAttributeNS(xlinkns, \"xlink:href\");\n  }\n\n  function text(textContent) {\n    if (textContent !== undefined) {\n        svgElement.textContent = textContent;\n        return svgElement;\n    }\n    return svgElement.textContent;\n  }\n}\n","var parser = require('./domparser.js');\nvar svg = require('../');\n\nmodule.exports = compile;\n\nfunction compile(svgText) {\n  try {\n    svgText = addNamespaces(svgText);\n    return svg(parser.parseFromString(svgText, \"text/xml\").documentElement);\n  } catch (e) {\n    throw e;\n  }\n}\n\nfunction addNamespaces(text) {\n  if (!text) return;\n\n  var namespaces = 'xmlns:svg=\"http://www.w3.org/2000/svg\" xmlns=\"http://www.w3.org/2000/svg\"';\n  var match = text.match(/^<\\w+/);\n  if (match) {\n    var tagLength = match[0].length;\n    return text.substr(0, tagLength) + ' ' + namespaces + ' ' + text.substr(tagLength);\n  } else {\n    throw new Error('Cannot parse input text: invalid xml?');\n  }\n}\n","module.exports = template;\n\nvar BINDING_EXPR = /{{(.+?)}}/;\n\nfunction template(domNode) {\n  var allBindings = Object.create(null);\n  extractAllBindings(domNode, allBindings);\n\n  return {\n    link: function(model) {\n      Object.keys(allBindings).forEach(function(key) {\n        var setter = allBindings[key];\n        setter.forEach(changeModel);\n      });\n\n      function changeModel(setter) {\n        setter(model);\n      }\n    }\n  };\n}\n\nfunction extractAllBindings(domNode, allBindings) {\n  var nodeType = domNode.nodeType;\n  var typeSupported = (nodeType === 1) || (nodeType === 3);\n  if (!typeSupported) return;\n  var i;\n  if (domNode.hasChildNodes()) {\n    var domChildren = domNode.childNodes;\n    for (i = 0; i < domChildren.length; ++i) {\n      extractAllBindings(domChildren[i], allBindings);\n    }\n  }\n\n  if (nodeType === 3) { // text:\n    bindTextContent(domNode, allBindings);\n  }\n\n  if (!domNode.attributes) return; // this might be a text. Need to figure out what to do in that case\n\n  var attrs = domNode.attributes;\n  for (i = 0; i < attrs.length; ++i) {\n    bindDomAttribute(attrs[i], domNode, allBindings);\n  }\n}\n\nfunction bindDomAttribute(domAttribute, element, allBindings) {\n  var value = domAttribute.value;\n  if (!value) return; // unary attribute?\n\n  var modelNameMatch = value.match(BINDING_EXPR);\n  if (!modelNameMatch) return; // does not look like a binding\n\n  var attrName = domAttribute.localName;\n  var modelPropertyName = modelNameMatch[1];\n  var isSimpleValue = modelPropertyName.indexOf('.') < 0;\n\n  if (!isSimpleValue) throw new Error('simplesvg currently does not support nested bindings');\n\n  var propertyBindings = allBindings[modelPropertyName];\n  if (!propertyBindings) {\n    propertyBindings = allBindings[modelPropertyName] = [attributeSetter];\n  } else {\n    propertyBindings.push(attributeSetter);\n  }\n\n  function attributeSetter(model) {\n    element.setAttributeNS(null, attrName, model[modelPropertyName]);\n  }\n}\nfunction bindTextContent(element, allBindings) {\n  // todo reduce duplication\n  var value = element.nodeValue;\n  if (!value) return; // unary attribute?\n\n  var modelNameMatch = value.match(BINDING_EXPR);\n  if (!modelNameMatch) return; // does not look like a binding\n\n  var modelPropertyName = modelNameMatch[1];\n  var isSimpleValue = modelPropertyName.indexOf('.') < 0;\n\n  var propertyBindings = allBindings[modelPropertyName];\n  if (!propertyBindings) {\n    propertyBindings = allBindings[modelPropertyName] = [textSetter];\n  } else {\n    propertyBindings.push(textSetter);\n  }\n\n  function textSetter(model) {\n    element.nodeValue = model[modelPropertyName];\n  }\n}\n","module.exports = createDomparser();\n\nfunction createDomparser() {\n  if (typeof DOMParser === 'undefined') {\n    return {\n      parseFromString: fail\n    };\n  }\n  return new DOMParser();\n}\n\nfunction fail() {\n  throw new Error('DOMParser is not supported by this platform. Please open issue here https://github.com/anvaka/simplesvg');\n}\n","var centrality = require('ngraph.centrality');\n\nmodule.exports = centralityWrapper;\n\nfunction centralityWrapper() {\n  // TODO: This should not be a function\n  return {\n    betweennessCentrality: betweennessCentrality,\n    degreeCentrality: degreeCentrality\n  };\n}\n\nfunction betweennessCentrality(g) {\n  var betweenness = centrality.betweenness(g);\n  return toVivaGraphCentralityFormat(betweenness);\n}\n\nfunction degreeCentrality(g, kind) {\n  var degree = centrality.degree(g, kind);\n  return toVivaGraphCentralityFormat(degree);\n}\n\nfunction toVivaGraphCentralityFormat(centrality) {\n  return Object.keys(centrality).sort(byValue).map(toKeyValue);\n\n  function byValue(x, y) {\n    return centrality[y] - centrality[x];\n  }\n\n  function toKeyValue(key) {\n    return {\n      key: key,\n      value: centrality[key]\n    };\n  }\n}\n","/**\r\n * @fileOverview Contains collection of primitive operations under graph.\r\n *\r\n * @author Andrei Kashcha (aka anvaka) / https://github.com/anvaka\r\n */\r\nmodule.exports = operations;\r\n\r\nfunction operations() {\r\n\r\n    return {\r\n        /**\r\n         * Gets graph density, which is a ratio of actual number of edges to maximum\r\n         * number of edges. I.e. graph density 1 means all nodes are connected with each other with an edge.\r\n         * Density 0 - graph has no edges. Runtime: O(1)\r\n         * \r\n         * @param graph represents oriented graph structure.\r\n         * @param directed (optional boolean) represents if the graph should be treated as a directed graph.\r\n         * \r\n         * @returns density of the graph if graph has nodes. NaN otherwise. Returns density for undirected graph by default but returns density for directed graph if a boolean 'true' is passed along with the graph.\r\n         */\r\n        density : function (graph,directed) {\r\n            var nodes = graph.getNodesCount();\r\n            if (nodes === 0) {\r\n                return NaN;\r\n            }\r\n            if(directed){\r\n                return graph.getLinksCount() / (nodes * (nodes - 1));\r\n            } else {\r\n                return 2 * graph.getLinksCount() / (nodes * (nodes - 1));\r\n            }\r\n        }\r\n    };\r\n};\r\n","/**\n * @author Andrei Kashcha (aka anvaka) / https://github.com/anvaka\n */\n\nmodule.exports = domInputManager;\n\nvar dragndrop = require('./dragndrop.js');\n\nfunction domInputManager(graph, graphics) {\n  var nodeEvents = {};\n  return {\n    /**\n     * Called by renderer to listen to drag-n-drop events from node. E.g. for SVG\n     * graphics we may listen to DOM events, whereas for WebGL the graphics\n     * should provide custom eventing mechanism.\n     *\n     * @param node - to be monitored.\n     * @param handlers - object with set of three callbacks:\n     *   onStart: function(),\n     *   onDrag: function(e, offset),\n     *   onStop: function()\n     */\n    bindDragNDrop: bindDragNDrop\n  };\n\n  function bindDragNDrop(node, handlers) {\n    var events;\n    if (handlers) {\n      var nodeUI = graphics.getNodeUI(node.id);\n      events = dragndrop(nodeUI);\n      if (typeof handlers.onStart === 'function') {\n        events.onStart(handlers.onStart);\n      }\n      if (typeof handlers.onDrag === 'function') {\n        events.onDrag(handlers.onDrag);\n      }\n      if (typeof handlers.onStop === 'function') {\n        events.onStop(handlers.onStop);\n      }\n\n      nodeEvents[node.id] = events;\n    } else if ((events = nodeEvents[node.id])) {\n      events.release();\n      delete nodeEvents[node.id];\n    }\n  }\n}\n","/**\n * @author Andrei Kashcha (aka anvaka) / https://github.com/anvaka\n */\n\nmodule.exports = dragndrop;\n\nvar documentEvents = require('../Utils/documentEvents.js');\nvar browserInfo = require('../Utils/browserInfo.js');\nvar findElementPosition = require('../Utils/findElementPosition.js');\n\n// TODO: Move to input namespace\n// TODO: Methods should be extracted into the prototype. This class\n// does not need to consume so much memory for every tracked element\nfunction dragndrop(element) {\n    var start,\n        drag,\n        end,\n        scroll,\n        prevSelectStart,\n        prevDragStart,\n\n        startX = 0,\n        startY = 0,\n        dragObject,\n        touchInProgress = false,\n        pinchZoomLength = 0,\n\n        getMousePos = function (e) {\n            var posx = 0,\n                posy = 0;\n\n            e = e || window.event;\n\n            if (e.pageX || e.pageY) {\n                posx = e.pageX;\n                posy = e.pageY;\n            } else if (e.clientX || e.clientY) {\n                posx = e.clientX + window.document.body.scrollLeft + window.document.documentElement.scrollLeft;\n                posy = e.clientY + window.document.body.scrollTop + window.document.documentElement.scrollTop;\n            }\n\n            return [posx, posy];\n        },\n\n        move = function (e, clientX, clientY) {\n            if (drag) {\n                drag(e, {x : clientX - startX, y : clientY - startY });\n            }\n\n            startX = clientX;\n            startY = clientY;\n        },\n\n        stopPropagation = function (e) {\n            if (e.stopPropagation) { e.stopPropagation(); } else { e.cancelBubble = true; }\n        },\n        preventDefault = function (e) {\n            if (e.preventDefault) { e.preventDefault(); }\n        },\n\n        handleDisabledEvent = function (e) {\n            stopPropagation(e);\n            return false;\n        },\n\n        handleMouseMove = function (e) {\n            e = e || window.event;\n\n            move(e, e.clientX, e.clientY);\n        },\n\n        handleMouseDown = function (e) {\n            e = e || window.event;\n            if (touchInProgress) {\n                // modern browsers will fire mousedown for touch events too\n                // we do not want this, since touch is handled separately.\n                stopPropagation(e);\n                return false;\n            }\n            // for IE, left click == 1\n            // for Firefox, left click == 0\n            var isLeftButton = ((e.button === 1 && window.event !== null) || e.button === 0);\n\n            if (isLeftButton) {\n                startX = e.clientX;\n                startY = e.clientY;\n\n                // TODO: bump zIndex?\n                dragObject = e.target || e.srcElement;\n\n                if (start) { start(e, {x: startX, y : startY}); }\n\n                documentEvents.on('mousemove', handleMouseMove);\n                documentEvents.on('mouseup', handleMouseUp);\n\n\n                stopPropagation(e);\n                // TODO: What if event already there? Not bullet proof:\n                prevSelectStart = window.document.onselectstart;\n                prevDragStart = window.document.ondragstart;\n\n                window.document.onselectstart = handleDisabledEvent;\n                dragObject.ondragstart = handleDisabledEvent;\n\n                // prevent text selection (except IE)\n                return false;\n            }\n        },\n\n        handleMouseUp = function (e) {\n            e = e || window.event;\n\n            documentEvents.off('mousemove', handleMouseMove);\n            documentEvents.off('mouseup', handleMouseUp);\n\n            window.document.onselectstart = prevSelectStart;\n            dragObject.ondragstart = prevDragStart;\n            dragObject = null;\n            if (end) { end(e); }\n        },\n\n        handleMouseWheel = function (e) {\n            if (typeof scroll !== 'function') {\n                return;\n            }\n\n            e = e || window.event;\n            if (e.preventDefault) {\n                e.preventDefault();\n            }\n\n            e.returnValue = false;\n            var delta,\n                mousePos = getMousePos(e),\n                elementOffset = findElementPosition(element),\n                relMousePos = {\n                    x: mousePos[0] - elementOffset[0],\n                    y: mousePos[1] - elementOffset[1]\n                };\n\n            if (e.wheelDelta) {\n                delta = e.wheelDelta / 360; // Chrome/Safari\n            } else {\n                delta = e.detail / -9; // Mozilla\n            }\n\n            scroll(e, delta, relMousePos);\n        },\n\n        updateScrollEvents = function (scrollCallback) {\n            if (!scroll && scrollCallback) {\n                // client is interested in scrolling. Start listening to events:\n                if (browserInfo.browser === 'webkit') {\n                    element.addEventListener('mousewheel', handleMouseWheel, false); // Chrome/Safari\n                } else {\n                    element.addEventListener('DOMMouseScroll', handleMouseWheel, false); // Others\n                }\n            } else if (scroll && !scrollCallback) {\n                if (browserInfo.browser === 'webkit') {\n                    element.removeEventListener('mousewheel', handleMouseWheel, false); // Chrome/Safari\n                } else {\n                    element.removeEventListener('DOMMouseScroll', handleMouseWheel, false); // Others\n                }\n            }\n\n            scroll = scrollCallback;\n        },\n\n        getPinchZoomLength = function(finger1, finger2) {\n            return (finger1.clientX - finger2.clientX) * (finger1.clientX - finger2.clientX) +\n                   (finger1.clientY - finger2.clientY) * (finger1.clientY - finger2.clientY);\n        },\n\n        handleTouchMove = function (e) {\n            if (e.touches.length === 1) {\n                stopPropagation(e);\n\n                var touch = e.touches[0];\n                move(e, touch.clientX, touch.clientY);\n            } else if (e.touches.length === 2) {\n                // it's a zoom:\n                var currentPinchLength = getPinchZoomLength(e.touches[0], e.touches[1]);\n                var delta = 0;\n                if (currentPinchLength < pinchZoomLength) {\n                    delta = -1;\n                } else if (currentPinchLength > pinchZoomLength) {\n                    delta = 1;\n                }\n                scroll(e, delta, {x: e.touches[0].clientX, y: e.touches[0].clientY});\n                pinchZoomLength = currentPinchLength;\n                stopPropagation(e);\n                preventDefault(e);\n            }\n        },\n\n        handleTouchEnd = function (e) {\n            touchInProgress = false;\n            documentEvents.off('touchmove', handleTouchMove);\n            documentEvents.off('touchend', handleTouchEnd);\n            documentEvents.off('touchcancel', handleTouchEnd);\n            dragObject = null;\n            if (end) { end(e); }\n        },\n\n        handleSignleFingerTouch = function (e, touch) {\n            stopPropagation(e);\n            preventDefault(e);\n\n            startX = touch.clientX;\n            startY = touch.clientY;\n\n            dragObject = e.target || e.srcElement;\n\n            if (start) { start(e, {x: startX, y : startY}); }\n            // TODO: can I enter into the state when touch is in progress\n            // but it's still a single finger touch?\n            if (!touchInProgress) {\n                touchInProgress = true;\n                documentEvents.on('touchmove', handleTouchMove);\n                documentEvents.on('touchend', handleTouchEnd);\n                documentEvents.on('touchcancel', handleTouchEnd);\n            }\n        },\n\n        handleTouchStart = function (e) {\n            if (e.touches.length === 1) {\n                return handleSignleFingerTouch(e, e.touches[0]);\n            } else if (e.touches.length === 2) {\n                // handleTouchMove() will care about pinch zoom.\n                stopPropagation(e);\n                preventDefault(e);\n\n                pinchZoomLength = getPinchZoomLength(e.touches[0], e.touches[1]);\n\n            }\n            // don't care about the rest.\n        };\n\n\n    element.addEventListener('mousedown', handleMouseDown);\n    element.addEventListener('touchstart', handleTouchStart);\n\n    return {\n        onStart : function (callback) {\n            start = callback;\n            return this;\n        },\n\n        onDrag : function (callback) {\n            drag = callback;\n            return this;\n        },\n\n        onStop : function (callback) {\n            end = callback;\n            return this;\n        },\n\n        /**\n         * Occurs when mouse wheel event happens. callback = function(e, scrollDelta, scrollPoint);\n         */\n        onScroll : function (callback) {\n            updateScrollEvents(callback);\n            return this;\n        },\n\n        release : function () {\n            // TODO: could be unsafe. We might wanna release dragObject, etc.\n            element.removeEventListener('mousedown', handleMouseDown);\n            element.removeEventListener('touchstart', handleTouchStart);\n\n            documentEvents.off('mousemove', handleMouseMove);\n            documentEvents.off('mouseup', handleMouseUp);\n            documentEvents.off('touchmove', handleTouchMove);\n            documentEvents.off('touchend', handleTouchEnd);\n            documentEvents.off('touchcancel', handleTouchEnd);\n\n            updateScrollEvents(null);\n        }\n    };\n}\n","/**\n * @author Andrei Kashcha (aka anvaka) / https://github.com/anvaka\n */\n\nmodule.exports = webglInputManager;\n\nvar createInputEvents = require('../WebGL/webglInputEvents.js');\n\nfunction webglInputManager(graph, graphics) {\n    var inputEvents = createInputEvents(graphics),\n        draggedNode = null,\n        internalHandlers = {},\n        pos = {x : 0, y : 0};\n\n    inputEvents.mouseDown(function (node, e) {\n        draggedNode = node;\n        pos.x = e.clientX;\n        pos.y = e.clientY;\n\n        inputEvents.mouseCapture(draggedNode);\n\n        var handlers = internalHandlers[node.id];\n        if (handlers && handlers.onStart) {\n            handlers.onStart(e, pos);\n        }\n\n        return true;\n    }).mouseUp(function (node) {\n        inputEvents.releaseMouseCapture(draggedNode);\n\n        draggedNode = null;\n        var handlers = internalHandlers[node.id];\n        if (handlers && handlers.onStop) {\n            handlers.onStop();\n        }\n        return true;\n    }).mouseMove(function (node, e) {\n        if (draggedNode) {\n            var handlers = internalHandlers[draggedNode.id];\n            if (handlers && handlers.onDrag) {\n                handlers.onDrag(e, {x : e.clientX - pos.x, y : e.clientY - pos.y });\n            }\n\n            pos.x = e.clientX;\n            pos.y = e.clientY;\n            return true;\n        }\n    });\n\n    return {\n        /**\n         * Called by renderer to listen to drag-n-drop events from node. E.g. for SVG\n         * graphics we may listen to DOM events, whereas for WebGL we graphics\n         * should provide custom eventing mechanism.\n         *\n         * @param node - to be monitored.\n         * @param handlers - object with set of three callbacks:\n         *   onStart: function(),\n         *   onDrag: function(e, offset),\n         *   onStop: function()\n         */\n        bindDragNDrop : function (node, handlers) {\n            internalHandlers[node.id] = handlers;\n            if (!handlers) {\n                delete internalHandlers[node.id];\n            }\n        }\n    };\n}\n","module.exports = constant;\n\nvar merge = require('ngraph.merge');\nvar random = require('ngraph.random').random;\nvar Rect = require('../Utils/rect.js');\n\n/**\n * Does not really perform any layouting algorithm but is compliant\n * with renderer interface. Allowing clients to provide specific positioning\n * callback and get static layout of the graph\n *\n * @param {Viva.Graph.graph} graph to layout\n * @param {Object} userSettings\n */\nfunction constant(graph, userSettings) {\n    userSettings = merge(userSettings, {\n        maxX : 1024,\n        maxY : 1024,\n        seed : 'Deterministic randomness made me do this'\n    });\n    // This class simply follows API, it does not use some of the arguments:\n    /*jshint unused: false */\n    var rand = random(userSettings.seed),\n        graphRect = new Rect(Number.MAX_VALUE, Number.MAX_VALUE, Number.MIN_VALUE, Number.MIN_VALUE),\n        layoutLinks = {},\n\n        placeNodeCallback = function (node) {\n            return {\n              x: rand.next(userSettings.maxX),\n              y: rand.next(userSettings.maxY)\n            };\n        },\n\n        updateGraphRect = function (position, graphRect) {\n            if (position.x < graphRect.x1) { graphRect.x1 = position.x; }\n            if (position.x > graphRect.x2) { graphRect.x2 = position.x; }\n            if (position.y < graphRect.y1) { graphRect.y1 = position.y; }\n            if (position.y > graphRect.y2) { graphRect.y2 = position.y; }\n        },\n\n        layoutNodes = typeof Object.create === 'function' ? Object.create(null) : {},\n\n        ensureNodeInitialized = function (node) {\n            layoutNodes[node.id] = placeNodeCallback(node);\n            updateGraphRect(layoutNodes[node.id], graphRect);\n        },\n\n        updateNodePositions = function () {\n            if (graph.getNodesCount() === 0) { return; }\n\n            graphRect.x1 = Number.MAX_VALUE;\n            graphRect.y1 = Number.MAX_VALUE;\n            graphRect.x2 = Number.MIN_VALUE;\n            graphRect.y2 = Number.MIN_VALUE;\n\n            graph.forEachNode(ensureNodeInitialized);\n        },\n\n        ensureLinkInitialized = function (link) {\n          layoutLinks[link.id] = link;\n        },\n\n        onGraphChanged = function(changes) {\n            for (var i = 0; i < changes.length; ++i) {\n                var change = changes[i];\n                if (change.node) {\n                    if (change.changeType === 'add') {\n                        ensureNodeInitialized(change.node);\n                    } else {\n                        delete layoutNodes[change.node.id];\n                    }\n                } if (change.link) {\n                    if (change.changeType === 'add') {\n                        ensureLinkInitialized(change.link);\n                    } else {\n                        delete layoutLinks[change.link.id];\n                    }\n                }\n            }\n        };\n\n    graph.forEachNode(ensureNodeInitialized);\n    graph.forEachLink(ensureLinkInitialized);\n    graph.on('changed', onGraphChanged);\n\n    return {\n        /**\n         * Attempts to layout graph within given number of iterations.\n         *\n         * @param {integer} [iterationsCount] number of algorithm's iterations.\n         *  The constant layout ignores this parameter.\n         */\n        run : function (iterationsCount) {\n            this.step();\n        },\n\n        /**\n         * One step of layout algorithm.\n         */\n        step : function () {\n            updateNodePositions();\n\n            return true; // no need to continue.\n        },\n\n        /**\n         * Returns rectangle structure {x1, y1, x2, y2}, which represents\n         * current space occupied by graph.\n         */\n        getGraphRect : function () {\n            return graphRect;\n        },\n\n        /**\n         * Request to release all resources\n         */\n        dispose : function () {\n            graph.off('change', onGraphChanged);\n        },\n\n        /*\n         * Checks whether given node is pinned; all nodes in this layout are pinned.\n         */\n        isNodePinned: function (node) {\n            return true;\n        },\n\n        /*\n         * Requests layout algorithm to pin/unpin node to its current position\n         * Pinned nodes should not be affected by layout algorithm and always\n         * remain at their position\n         */\n        pinNode: function (node, isPinned) {\n           // noop\n        },\n\n        /*\n         * Gets position of a node by its id. If node was not seen by this\n         * layout algorithm undefined value is returned;\n         */\n        getNodePosition: getNodePosition,\n\n        /**\n         * Returns {from, to} position of a link.\n         */\n        getLinkPosition: function (linkId) {\n          var link = layoutLinks[linkId];\n          return {\n              from : getNodePosition(link.fromId),\n              to : getNodePosition(link.toId)\n          };\n        },\n\n        /**\n         * Sets position of a node to a given coordinates\n         */\n        setNodePosition: function (nodeId, x, y) {\n            var pos = layoutNodes[nodeId];\n            if (pos) {\n                pos.x = x;\n                pos.y = y;\n            }\n        },\n\n        // Layout specific methods:\n\n        /**\n         * Based on argument either update default node placement callback or\n         * attempts to place given node using current placement callback.\n         * Setting new node callback triggers position update for all nodes.\n         *\n         * @param {Object} newPlaceNodeCallbackOrNode - if it is a function then\n         * default node placement callback is replaced with new one. Node placement\n         * callback has a form of function (node) {}, and is expected to return an\n         * object with x and y properties set to numbers.\n         *\n         * Otherwise if it's not a function the argument is treated as graph node\n         * and current node placement callback will be used to place it.\n         */\n        placeNode : function (newPlaceNodeCallbackOrNode) {\n            if (typeof newPlaceNodeCallbackOrNode === 'function') {\n                placeNodeCallback = newPlaceNodeCallbackOrNode;\n                updateNodePositions();\n                return this;\n            }\n\n            // it is not a request to update placeNodeCallback, trying to place\n            // a node using current callback:\n            return placeNodeCallback(newPlaceNodeCallbackOrNode);\n        }\n\n    };\n\n    function getNodePosition(nodeId) {\n        return layoutNodes[nodeId];\n    }\n}\n","/**\n * This module provides compatibility layer with 0.6.x library. It will be\n * removed in the next version\n */\n\nvar events = require('ngraph.events');\n\nmodule.exports = backwardCompatibleEvents;\n\nfunction backwardCompatibleEvents(g) {\n  console.log(\"This method is deprecated. Please use Viva.events() instead\");\n\n  if (!g) {\n    return g;\n  }\n\n  var eventsDefined = (g.on !== undefined) ||\n    (g.off !== undefined) ||\n    (g.fire !== undefined);\n\n  if (eventsDefined) {\n    // events already defined, ignore\n    return {\n      extend: function() {\n        return g;\n      },\n      on: g.on,\n      stop: g.off\n    };\n  }\n\n  return {\n    extend: extend,\n    on: g.on,\n    stop: g.off\n  };\n\n  function extend() {\n    var backwardCompatible = events(g);\n    backwardCompatible.addEventListener = backwardCompatible.on;\n    return backwardCompatible;\n  }\n}\n","module.exports = browserInfo();\r\n\r\nfunction browserInfo() {\r\n  if (typeof window === \"undefined\" || !window.hasOwnProperty(\"navigator\")) {\r\n    return {\r\n      browser : \"\",\r\n      version : \"0\"\r\n    };\r\n  }\r\n\r\n  var ua = window.navigator.userAgent.toLowerCase(),\r\n  // Useragent RegExp\r\n  rwebkit = /(webkit)[ \\/]([\\w.]+)/,\r\n  ropera = /(opera)(?:.*version)?[ \\/]([\\w.]+)/,\r\n  rmsie = /(msie) ([\\w.]+)/,\r\n  rmozilla = /(mozilla)(?:.*? rv:([\\w.]+))?/,\r\n  match = rwebkit.exec(ua) ||\r\n    ropera.exec(ua) ||\r\n    rmsie.exec(ua) ||\r\n    (ua.indexOf(\"compatible\") < 0 && rmozilla.exec(ua)) ||\r\n    [];\r\n\r\n  return {\r\n    browser: match[1] || \"\",\r\n    version: match[2] || \"0\"\r\n  };\r\n}\r\n","var nullEvents = require('./nullEvents.js');\n\nmodule.exports = createDocumentEvents();\n\nfunction createDocumentEvents() {\n  if (typeof document === undefined) {\n    return nullEvents;\n  }\n\n  return {\n    on: on,\n    off: off\n  };\n}\n\nfunction on(eventName, handler) {\n  document.addEventListener(eventName, handler);\n}\n\nfunction off(eventName, handler) {\n  document.removeEventListener(eventName, handler);\n}\n","/**\n * Finds the absolute position of an element on a page\n */\nmodule.exports = findElementPosition;\n\nfunction findElementPosition(obj) {\n    var curleft = 0,\n        curtop = 0;\n    if (obj.offsetParent) {\n        do {\n            curleft += obj.offsetLeft;\n            curtop += obj.offsetTop;\n        } while ((obj = obj.offsetParent) !== null);\n    }\n\n    return [curleft, curtop];\n}\n","module.exports = getDimension;\r\n\r\nfunction getDimension(container) {\r\n    if (!container) {\r\n        throw {\r\n            message : 'Cannot get dimensions of undefined container'\r\n        };\r\n    }\r\n\r\n    // TODO: Potential cross browser bug.\r\n    var width = container.clientWidth;\r\n    var height = container.clientHeight;\r\n\r\n    return {\r\n        left : 0,\r\n        top : 0,\r\n        width : width,\r\n        height : height\r\n    };\r\n}\r\n","var intersect = require('gintersect');\n\nmodule.exports = intersectRect;\n\nfunction intersectRect(left, top, right, bottom, x1, y1, x2, y2) {\n  return intersect(left, top, left, bottom, x1, y1, x2, y2) ||\n    intersect(left, bottom, right, bottom, x1, y1, x2, y2) ||\n    intersect(right, bottom, right, top, x1, y1, x2, y2) ||\n    intersect(right, top, left, top, x1, y1, x2, y2);\n}\n","module.exports = createNullEvents();\n\nfunction createNullEvents() {\n  return {\n    on: noop,\n    off: noop,\n    stop: noop\n  };\n}\n\nfunction noop() { }\n","module.exports = Rect;\n\n/**\n * Very generic rectangle.\n */\nfunction Rect (x1, y1, x2, y2) {\n    this.x1 = x1 || 0;\n    this.y1 = y1 || 0;\n    this.x2 = x2 || 0;\n    this.y2 = y2 || 0;\n}\n","/**\r\n * @author Andrei Kashcha (aka anvaka) / https://github.com/anvaka\r\n */\r\n\r\nmodule.exports = createTimer();\r\n\r\nfunction createTimer() {\r\n  var lastTime = 0,\r\n    vendors = ['ms', 'moz', 'webkit', 'o'],\r\n    i,\r\n    scope;\r\n\r\n  if (typeof window !== 'undefined') {\r\n    scope = window;\r\n  } else if (typeof global !== 'undefined') {\r\n    scope = global;\r\n  } else {\r\n    scope = {\r\n      setTimeout: noop,\r\n      clearTimeout: noop\r\n    };\r\n  }\r\n\r\n  for (i = 0; i < vendors.length && !scope.requestAnimationFrame; ++i) {\r\n    var vendorPrefix = vendors[i];\r\n    scope.requestAnimationFrame = scope[vendorPrefix + 'RequestAnimationFrame'];\r\n    scope.cancelAnimationFrame =\r\n      scope[vendorPrefix + 'CancelAnimationFrame'] || scope[vendorPrefix + 'CancelRequestAnimationFrame'];\r\n  }\r\n\r\n  if (!scope.requestAnimationFrame) {\r\n    scope.requestAnimationFrame = rafPolyfill;\r\n  }\r\n\r\n  if (!scope.cancelAnimationFrame) {\r\n    scope.cancelAnimationFrame = cancelRafPolyfill;\r\n  }\r\n\r\n  return timer;\r\n\r\n  /**\r\n   * Timer that fires callback with given interval (in ms) until\r\n   * callback returns true;\r\n   */\r\n  function timer(callback) {\r\n    var intervalId;\r\n    startTimer(); // start it right away.\r\n\r\n    return {\r\n      /**\r\n       * Stops execution of the callback\r\n       */\r\n      stop: stopTimer,\r\n\r\n      restart: restart\r\n    };\r\n\r\n    function startTimer() {\r\n      intervalId = scope.requestAnimationFrame(startTimer);\r\n      if (!callback()) {\r\n        stopTimer();\r\n      }\r\n    }\r\n\r\n    function stopTimer() {\r\n      scope.cancelAnimationFrame(intervalId);\r\n      intervalId = 0;\r\n    }\r\n\r\n    function restart() {\r\n      if (!intervalId) {\r\n        startTimer();\r\n      }\r\n    }\r\n  }\r\n\r\n  function rafPolyfill(callback) {\r\n    var currTime = new Date().getTime();\r\n    var timeToCall = Math.max(0, 16 - (currTime - lastTime));\r\n    var id = scope.setTimeout(function() {\r\n      callback(currTime + timeToCall);\r\n    }, timeToCall);\r\n    lastTime = currTime + timeToCall;\r\n    return id;\r\n  }\r\n\r\n  function cancelRafPolyfill(id) {\r\n    scope.clearTimeout(id);\r\n  }\r\n}\r\n\r\nfunction noop() {}\r\n","var nullEvents = require('./nullEvents.js');\n\nmodule.exports = createDocumentEvents();\n\nfunction createDocumentEvents() {\n  if (typeof window === 'undefined') {\n    return nullEvents;\n  }\n\n  return {\n    on: on,\n    off: off\n  };\n}\n\nfunction on(eventName, handler) {\n  window.addEventListener(eventName, handler);\n}\n\nfunction off(eventName, handler) {\n  window.removeEventListener(eventName, handler);\n}\n\n","/**\r\n * @fileOverview Defines a graph renderer that uses CSS based drawings.\r\n *\r\n * @author Andrei Kashcha (aka anvaka) / https://github.com/anvaka\r\n */\r\n\r\nmodule.exports = renderer;\r\n\r\nvar eventify = require('ngraph.events');\r\nvar forceDirected = require('ngraph.forcelayout');\r\nvar svgGraphics = require('./svgGraphics.js');\r\nvar windowEvents = require('../Utils/windowEvents.js');\r\nvar domInputManager = require('../Input/domInputManager.js');\r\nvar timer = require('../Utils/timer.js');\r\nvar getDimension = require('../Utils/getDimensions.js');\r\nvar dragndrop = require('../Input/dragndrop.js');\r\n\r\n/**\r\n * This is heart of the rendering. Class accepts graph to be rendered and rendering settings.\r\n * It monitors graph changes and depicts them accordingly.\r\n *\r\n * @param graph - Viva.Graph.graph() object to be rendered.\r\n * @param settings - rendering settings, composed from the following parts (with their defaults shown):\r\n *   settings = {\r\n *     // Represents a module that is capable of displaying graph nodes and links.\r\n *     // all graphics has to correspond to defined interface and can be later easily\r\n *     // replaced for specific needs (e.g. adding WebGL should be piece of cake as long\r\n *     // as WebGL has implemented required interface). See svgGraphics for example.\r\n *     graphics : Viva.Graph.View.svgGraphics(),\r\n *\r\n *     // Where the renderer should draw graph. Container size matters, because\r\n *     // renderer will attempt center graph to that size. Also graphics modules\r\n *     // might depend on it.\r\n *     container : document.body,\r\n *\r\n *     // Defines whether graph can respond to use input\r\n *     interactive: true,\r\n *\r\n *     // Layout algorithm to be used. The algorithm is expected to comply with defined\r\n *     // interface and is expected to be iterative. Renderer will use it then to calculate\r\n *     // graph's layout. For examples of the interface refer to Viva.Graph.Layout.forceDirected()\r\n *     layout : Viva.Graph.Layout.forceDirected(),\r\n *\r\n *     // Directs renderer to display links. Usually rendering links is the slowest part of this\r\n *     // library. So if you don't need to display links, consider settings this property to false.\r\n *     renderLinks : true,\r\n *\r\n *     // Number of layout iterations to run before displaying the graph. The bigger you set this number\r\n *     // the closer to ideal position graph will appear first time. But be careful: for large graphs\r\n *     // it can freeze the browser.\r\n *     prerender : 0\r\n *   }\r\n */\r\nfunction renderer(graph, settings) {\r\n  // TODO: This class is getting hard to understand. Consider refactoring.\r\n  // TODO: I have a technical debt here: fix scaling/recentering! Currently it's a total mess.\r\n  var FRAME_INTERVAL = 30;\r\n\r\n  settings = settings || {};\r\n\r\n  var layout = settings.layout,\r\n    graphics = settings.graphics,\r\n    container = settings.container,\r\n    interactive = settings.interactive !== undefined ? settings.interactive : true,\r\n    inputManager,\r\n    animationTimer,\r\n    rendererInitialized = false,\r\n    updateCenterRequired = true,\r\n\r\n    isStable = false,\r\n    userInteraction = false,\r\n    isPaused = false,\r\n\r\n    transform = {\r\n      offsetX: 0,\r\n      offsetY: 0,\r\n      scale: 1\r\n    },\r\n\r\n    publicEvents = eventify({}),\r\n    containerDrag;\r\n\r\n  return {\r\n    /**\r\n     * Performs rendering of the graph.\r\n     *\r\n     * @param iterationsCount if specified renderer will run only given number of iterations\r\n     * and then stop. Otherwise graph rendering is performed indefinitely.\r\n     *\r\n     * Note: if rendering stopped by used started dragging nodes or new nodes were added to the\r\n     * graph renderer will give run more iterations to reflect changes.\r\n     */\r\n    run: function(iterationsCount) {\r\n\r\n      if (!rendererInitialized) {\r\n        prepareSettings();\r\n        prerender();\r\n\r\n        initDom();\r\n        updateCenter();\r\n        listenToEvents();\r\n\r\n        rendererInitialized = true;\r\n      }\r\n\r\n      renderIterations(iterationsCount);\r\n\r\n      return this;\r\n    },\r\n\r\n    reset: function() {\r\n      graphics.resetScale();\r\n      updateCenter();\r\n      transform.scale = 1;\r\n    },\r\n\r\n    pause: function() {\r\n      isPaused = true;\r\n      animationTimer.stop();\r\n    },\r\n\r\n    resume: function() {\r\n      isPaused = false;\r\n      animationTimer.restart();\r\n    },\r\n\r\n    rerender: function() {\r\n      renderGraph();\r\n      return this;\r\n    },\r\n\r\n    zoomOut: function() {\r\n      return scale(true);\r\n    },\r\n\r\n    zoomIn: function() {\r\n      return scale(false);\r\n    },\r\n\r\n    /**\r\n     * Returns current transformation matrix.\r\n     */\r\n    getTransform: function() {\r\n      return transform;\r\n    },\r\n\r\n    /**\r\n     * Centers renderer at x,y graph's coordinates\r\n     */\r\n    moveTo: function(x, y) {\r\n      graphics.graphCenterChanged(transform.offsetX - x * transform.scale, transform.offsetY - y * transform.scale);\r\n      renderGraph();\r\n    },\r\n\r\n    /**\r\n     * Gets current graphics object\r\n     */\r\n    getGraphics: function() {\r\n      return graphics;\r\n    },\r\n    \r\n    /**\r\n     * Gets current layout.\r\n     */\r\n    getLayout: function() {\r\n      return layout;\r\n    },\r\n\r\n    /**\r\n     * Removes this renderer and deallocates all resources/timers\r\n     */\r\n    dispose: function() {\r\n      stopListenToEvents(); // I quit!\r\n    },\r\n\r\n    on: function(eventName, callback) {\r\n      publicEvents.on(eventName, callback);\r\n      return this;\r\n    },\r\n\r\n    off: function(eventName, callback) {\r\n      publicEvents.off(eventName, callback);\r\n      return this;\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Checks whether given interaction (node/scroll) is enabled\r\n   */\r\n  function isInteractive(interactionName) {\r\n    if (typeof interactive === 'string') {\r\n      return interactive.indexOf(interactionName) >= 0;\r\n    } else if (typeof interactive === 'boolean') {\r\n      return interactive;\r\n    }\r\n    return true; // default setting\r\n  }\r\n\r\n  function prepareSettings() {\r\n    container = container || window.document.body;\r\n    layout = layout || forceDirected(graph, {\r\n      springLength: 80,\r\n      springCoeff: 0.0002,\r\n    });\r\n    graphics = graphics || svgGraphics(graph, {\r\n      container: container\r\n    });\r\n\r\n    if (!settings.hasOwnProperty('renderLinks')) {\r\n      settings.renderLinks = true;\r\n    }\r\n\r\n    settings.prerender = settings.prerender || 0;\r\n    inputManager = (graphics.inputManager || domInputManager)(graph, graphics);\r\n  }\r\n\r\n  function renderGraph() {\r\n    graphics.beginRender();\r\n\r\n    // todo: move this check graphics\r\n    if (settings.renderLinks) {\r\n      graphics.renderLinks();\r\n    }\r\n    graphics.renderNodes();\r\n    graphics.endRender();\r\n  }\r\n\r\n  function onRenderFrame() {\r\n    isStable = layout.step() && !userInteraction;\r\n    renderGraph();\r\n\r\n    return !isStable;\r\n  }\r\n\r\n  function renderIterations(iterationsCount) {\r\n    if (animationTimer) {\r\n      return;\r\n    }\r\n\r\n    if (iterationsCount !== undefined) {\r\n      animationTimer = timer(function() {\r\n        iterationsCount -= 1;\r\n        if (iterationsCount < 0) {\r\n          var needMoreFrames = false;\r\n          return needMoreFrames;\r\n        }\r\n\r\n        return onRenderFrame();\r\n      }, FRAME_INTERVAL);\r\n    } else {\r\n      animationTimer = timer(onRenderFrame, FRAME_INTERVAL);\r\n    }\r\n  }\r\n\r\n  function resetStable() {\r\n    if (isPaused) {\r\n      return;\r\n    }\r\n\r\n    isStable = false;\r\n    animationTimer.restart();\r\n  }\r\n\r\n  function prerender() {\r\n    // To get good initial positions for the graph\r\n    // perform several prerender steps in background.\r\n    if (typeof settings.prerender === 'number' && settings.prerender > 0) {\r\n      for (var i = 0; i < settings.prerender; i += 1) {\r\n        layout.step();\r\n      }\r\n    }\r\n  }\r\n\r\n  function updateCenter() {\r\n    var graphRect = layout.getGraphRect(),\r\n      containerSize = getDimension(container);\r\n\r\n    var cx = (graphRect.x2 + graphRect.x1) / 2;\r\n    var cy = (graphRect.y2 + graphRect.y1) / 2;\r\n    transform.offsetX = containerSize.width / 2 - (cx * transform.scale - cx);\r\n    transform.offsetY = containerSize.height / 2 - (cy * transform.scale - cy);\r\n    graphics.graphCenterChanged(transform.offsetX, transform.offsetY);\r\n\r\n    updateCenterRequired = false;\r\n  }\r\n\r\n  function createNodeUi(node) {\r\n    var nodePosition = layout.getNodePosition(node.id);\r\n    graphics.addNode(node, nodePosition);\r\n  }\r\n\r\n  function removeNodeUi(node) {\r\n    graphics.releaseNode(node);\r\n  }\r\n\r\n  function createLinkUi(link) {\r\n    var linkPosition = layout.getLinkPosition(link.id);\r\n    graphics.addLink(link, linkPosition);\r\n  }\r\n\r\n  function removeLinkUi(link) {\r\n    graphics.releaseLink(link);\r\n  }\r\n\r\n  function listenNodeEvents(node) {\r\n    if (!isInteractive('node')) {\r\n      return;\r\n    }\r\n\r\n    var wasPinned = false;\r\n\r\n    // TODO: This may not be memory efficient. Consider reusing handlers object.\r\n    inputManager.bindDragNDrop(node, {\r\n      onStart: function() {\r\n        wasPinned = layout.isNodePinned(node);\r\n        layout.pinNode(node, true);\r\n        userInteraction = true;\r\n        resetStable();\r\n      },\r\n      onDrag: function(e, offset) {\r\n        var oldPos = layout.getNodePosition(node.id);\r\n        layout.setNodePosition(node.id,\r\n          oldPos.x + offset.x / transform.scale,\r\n          oldPos.y + offset.y / transform.scale);\r\n\r\n        userInteraction = true;\r\n\r\n        renderGraph();\r\n      },\r\n      onStop: function() {\r\n        layout.pinNode(node, wasPinned);\r\n        userInteraction = false;\r\n      }\r\n    });\r\n  }\r\n\r\n  function releaseNodeEvents(node) {\r\n    inputManager.bindDragNDrop(node, null);\r\n  }\r\n\r\n  function initDom() {\r\n    graphics.init(container);\r\n\r\n    graph.forEachNode(createNodeUi);\r\n\r\n    if (settings.renderLinks) {\r\n      graph.forEachLink(createLinkUi);\r\n    }\r\n  }\r\n\r\n  function releaseDom() {\r\n    graphics.release(container);\r\n  }\r\n\r\n  function processNodeChange(change) {\r\n    var node = change.node;\r\n\r\n    if (change.changeType === 'add') {\r\n      createNodeUi(node);\r\n      listenNodeEvents(node);\r\n      if (updateCenterRequired) {\r\n        updateCenter();\r\n      }\r\n    } else if (change.changeType === 'remove') {\r\n      releaseNodeEvents(node);\r\n      removeNodeUi(node);\r\n      if (graph.getNodesCount() === 0) {\r\n        updateCenterRequired = true; // Next time when node is added - center the graph.\r\n      }\r\n    } else if (change.changeType === 'update') {\r\n      releaseNodeEvents(node);\r\n      removeNodeUi(node);\r\n\r\n      createNodeUi(node);\r\n      listenNodeEvents(node);\r\n    }\r\n  }\r\n\r\n  function processLinkChange(change) {\r\n    var link = change.link;\r\n    if (change.changeType === 'add') {\r\n      if (settings.renderLinks) {\r\n        createLinkUi(link);\r\n      }\r\n    } else if (change.changeType === 'remove') {\r\n      if (settings.renderLinks) {\r\n        removeLinkUi(link);\r\n      }\r\n    } else if (change.changeType === 'update') {\r\n      throw 'Update type is not implemented. TODO: Implement me!';\r\n    }\r\n  }\r\n\r\n  function onGraphChanged(changes) {\r\n    var i, change;\r\n    for (i = 0; i < changes.length; i += 1) {\r\n      change = changes[i];\r\n      if (change.node) {\r\n        processNodeChange(change);\r\n      } else if (change.link) {\r\n        processLinkChange(change);\r\n      }\r\n    }\r\n\r\n    resetStable();\r\n  }\r\n\r\n  function onWindowResized() {\r\n    updateCenter();\r\n    onRenderFrame();\r\n  }\r\n\r\n  function releaseContainerDragManager() {\r\n    if (containerDrag) {\r\n      containerDrag.release();\r\n      containerDrag = null;\r\n    }\r\n  }\r\n\r\n  function releaseGraphEvents() {\r\n    graph.off('changed', onGraphChanged);\r\n  }\r\n\r\n  function scale(out, scrollPoint) {\r\n    if (!scrollPoint) {\r\n      var containerSize = getDimension(container);\r\n      scrollPoint = {\r\n        x: containerSize.width / 2,\r\n        y: containerSize.height / 2\r\n      };\r\n    }\r\n    var scaleFactor = Math.pow(1 + 0.4, out ? -0.2 : 0.2);\r\n    transform.scale = graphics.scale(scaleFactor, scrollPoint);\r\n\r\n    renderGraph();\r\n    publicEvents.fire('scale', transform.scale);\r\n\r\n    return transform.scale;\r\n  }\r\n\r\n  function listenToEvents() {\r\n    windowEvents.on('resize', onWindowResized);\r\n\r\n    releaseContainerDragManager();\r\n    if (isInteractive('drag')) {\r\n      containerDrag = dragndrop(container);\r\n      containerDrag.onDrag(function(e, offset) {\r\n        graphics.translateRel(offset.x, offset.y);\r\n\r\n        renderGraph();\r\n        publicEvents.fire('drag', offset);\r\n      });\r\n    }\r\n\r\n    if (isInteractive('scroll')) {\r\n      if (!containerDrag) {\r\n        containerDrag = dragndrop(container);\r\n      }\r\n      containerDrag.onScroll(function(e, scaleOffset, scrollPoint) {\r\n        scale(scaleOffset < 0, scrollPoint);\r\n      });\r\n    }\r\n\r\n    graph.forEachNode(listenNodeEvents);\r\n\r\n    releaseGraphEvents();\r\n    graph.on('changed', onGraphChanged);\r\n  }\r\n\r\n  function stopListenToEvents() {\r\n    rendererInitialized = false;\r\n    releaseGraphEvents();\r\n    releaseContainerDragManager();\r\n    windowEvents.off('resize', onWindowResized);\r\n    publicEvents.off();\r\n    animationTimer.stop();\r\n\r\n    graph.forEachLink(function(link) {\r\n      if (settings.renderLinks) {\r\n        removeLinkUi(link);\r\n      }\r\n    });\r\n\r\n    graph.forEachNode(function(node) {\r\n      releaseNodeEvents(node);\r\n      removeNodeUi(node);\r\n    });\r\n\r\n    layout.dispose();\r\n    releaseDom();\r\n  }\r\n}\r\n","/**\r\n * @fileOverview Defines a graph renderer that uses SVG based drawings.\r\n *\r\n * @author Andrei Kashcha (aka anvaka) / https://github.com/anvaka\r\n */\r\n\r\nmodule.exports = svgGraphics;\r\n\r\nvar svg = require('simplesvg');\r\nvar eventify = require('ngraph.events');\r\nvar domInputManager = require('../Input/domInputManager.js');\r\n\r\n/**\r\n * Performs svg-based graph rendering. This module does not perform\r\n * layout, but only visualizes nodes and edges of the graph.\r\n */\r\nfunction svgGraphics() {\r\n    var svgContainer,\r\n        svgRoot,\r\n        offsetX = 0,\r\n        offsetY = 0,\r\n        initCallback,\r\n        actualScale = 1,\r\n        allNodes = {},\r\n        allLinks = {},\r\n/*jshint unused: false */\r\n        nodeBuilder = function (node) {\r\n            return svg(\"rect\")\r\n                     .attr(\"width\", 10)\r\n                     .attr(\"height\", 10)\r\n                     .attr(\"fill\", \"#00a2e8\");\r\n        },\r\n\r\n        nodePositionCallback = function (nodeUI, pos) {\r\n            // TODO: Remove magic 5. It should be half of the width or height of the node.\r\n            nodeUI.attr(\"x\", pos.x - 5)\r\n                  .attr(\"y\", pos.y - 5);\r\n        },\r\n\r\n        linkBuilder = function (link) {\r\n            return svg(\"line\").attr(\"stroke\", \"#999\");\r\n        },\r\n\r\n        linkPositionCallback = function (linkUI, fromPos, toPos) {\r\n            linkUI.attr(\"x1\", fromPos.x)\r\n                  .attr(\"y1\", fromPos.y)\r\n                  .attr(\"x2\", toPos.x)\r\n                  .attr(\"y2\", toPos.y);\r\n        },\r\n\r\n        fireRescaled = function (graphics) {\r\n            // TODO: maybe we shall copy changes?\r\n            graphics.fire(\"rescaled\");\r\n        },\r\n\r\n        cachedPos = {x : 0, y: 0},\r\n        cachedFromPos = {x : 0, y: 0},\r\n        cachedToPos = {x : 0, y: 0},\r\n\r\n        updateTransform = function () {\r\n            if (svgContainer) {\r\n                var transform = \"matrix(\" + actualScale + \", 0, 0,\" + actualScale + \",\" + offsetX + \",\" + offsetY + \")\";\r\n                svgContainer.attr(\"transform\", transform);\r\n            }\r\n        };\r\n\r\n    svgRoot = createSvgRoot();\r\n\r\n    var graphics = {\r\n        getNodeUI: function (nodeId) {\r\n            return allNodes[nodeId];\r\n        },\r\n\r\n        getLinkUI: function (linkId) {\r\n            return allLinks[linkId];\r\n        },\r\n\r\n        /**\r\n         * Sets the callback that creates node representation.\r\n         *\r\n         * @param builderCallback a callback function that accepts graph node\r\n         * as a parameter and must return an element representing this node.\r\n         *\r\n         * @returns If builderCallbackOrNode is a valid callback function, instance of this is returned;\r\n         * Otherwise undefined value is returned\r\n         */\r\n        node : function (builderCallback) {\r\n            if (typeof builderCallback !== \"function\") {\r\n                return; // todo: throw? This is not compatible with old versions\r\n            }\r\n\r\n            nodeBuilder = builderCallback;\r\n\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Sets the callback that creates link representation\r\n         *\r\n         * @param builderCallback a callback function that accepts graph link\r\n         * as a parameter and must return an element representing this link.\r\n         *\r\n         * @returns If builderCallback is a valid callback function, instance of this is returned;\r\n         * Otherwise undefined value is returned.\r\n         */\r\n        link : function (builderCallback) {\r\n            if (typeof builderCallback !== \"function\") {\r\n                return; // todo: throw? This is not compatible with old versions\r\n            }\r\n\r\n            linkBuilder = builderCallback;\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Allows to override default position setter for the node with a new\r\n         * function. newPlaceCallback(nodeUI, position, node) is function which\r\n         * is used by updateNodePosition().\r\n         */\r\n        placeNode : function (newPlaceCallback) {\r\n            nodePositionCallback = newPlaceCallback;\r\n            return this;\r\n        },\r\n\r\n        placeLink : function (newPlaceLinkCallback) {\r\n            linkPositionCallback = newPlaceLinkCallback;\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Called every before renderer starts rendering.\r\n         */\r\n        beginRender : function () {},\r\n\r\n        /**\r\n         * Called every time when renderer finishes one step of rendering.\r\n         */\r\n        endRender : function () {},\r\n\r\n        /**\r\n         * Sets translate operation that should be applied to all nodes and links.\r\n         */\r\n        graphCenterChanged : function (x, y) {\r\n            offsetX = x;\r\n            offsetY = y;\r\n            updateTransform();\r\n        },\r\n\r\n        /**\r\n         * Default input manager listens to DOM events to process nodes drag-n-drop\r\n         */\r\n        inputManager : domInputManager,\r\n\r\n        translateRel : function (dx, dy) {\r\n            var p = svgRoot.createSVGPoint(),\r\n                t = svgContainer.getCTM(),\r\n                origin = svgRoot.createSVGPoint().matrixTransform(t.inverse());\r\n\r\n            p.x = dx;\r\n            p.y = dy;\r\n\r\n            p = p.matrixTransform(t.inverse());\r\n            p.x = (p.x - origin.x) * t.a;\r\n            p.y = (p.y - origin.y) * t.d;\r\n\r\n            t.e += p.x;\r\n            t.f += p.y;\r\n\r\n            var transform = \"matrix(\" + t.a + \", 0, 0,\" + t.d + \",\" + t.e + \",\" + t.f + \")\";\r\n            svgContainer.attr(\"transform\", transform);\r\n        },\r\n\r\n        scale : function (scaleFactor, scrollPoint) {\r\n            var p = svgRoot.createSVGPoint();\r\n            p.x = scrollPoint.x;\r\n            p.y = scrollPoint.y;\r\n\r\n            p = p.matrixTransform(svgContainer.getCTM().inverse()); // translate to SVG coordinates\r\n\r\n            // Compute new scale matrix in current mouse position\r\n            var k = svgRoot.createSVGMatrix().translate(p.x, p.y).scale(scaleFactor).translate(-p.x, -p.y),\r\n                t = svgContainer.getCTM().multiply(k);\r\n\r\n            actualScale = t.a;\r\n            offsetX = t.e;\r\n            offsetY = t.f;\r\n            var transform = \"matrix(\" + t.a + \", 0, 0,\" + t.d + \",\" + t.e + \",\" + t.f + \")\";\r\n            svgContainer.attr(\"transform\", transform);\r\n\r\n            fireRescaled(this);\r\n            return actualScale;\r\n        },\r\n\r\n        resetScale : function () {\r\n            actualScale = 1;\r\n            var transform = \"matrix(1, 0, 0, 1, 0, 0)\";\r\n            svgContainer.attr(\"transform\", transform);\r\n            fireRescaled(this);\r\n            return this;\r\n        },\r\n\r\n       /**\r\n        * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n        * provider prepare to render.\r\n        */\r\n        init : function (container) {\r\n            container.appendChild(svgRoot);\r\n            updateTransform();\r\n            // Notify the world if someone waited for update. TODO: should send an event\r\n            if (typeof initCallback === \"function\") {\r\n                initCallback(svgRoot);\r\n            }\r\n        },\r\n\r\n       /**\r\n        * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n        * provider release occupied resources.\r\n        */\r\n        release : function (container) {\r\n            if (svgRoot && container) {\r\n                container.removeChild(svgRoot);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n         * provider prepare to render given link of the graph\r\n         *\r\n         * @param link - model of a link\r\n         */\r\n        addLink: function (link, pos) {\r\n            var linkUI = linkBuilder(link);\r\n            if (!linkUI) { return; }\r\n            linkUI.position = pos;\r\n            linkUI.link = link;\r\n            allLinks[link.id] = linkUI;\r\n            if (svgContainer.childElementCount > 0) {\r\n                svgContainer.insertBefore(linkUI, svgContainer.firstChild);\r\n            } else {\r\n                svgContainer.appendChild(linkUI);\r\n            }\r\n            return linkUI;\r\n        },\r\n\r\n       /**\r\n        * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n        * provider remove link from rendering surface.\r\n        *\r\n        * @param linkUI visual representation of the link created by link() execution.\r\n        **/\r\n        releaseLink : function (link) {\r\n            var linkUI = allLinks[link.id];\r\n            if (linkUI) {\r\n                svgContainer.removeChild(linkUI);\r\n                delete allLinks[link.id];\r\n            }\r\n        },\r\n\r\n       /**\r\n        * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n        * provider prepare to render given node of the graph.\r\n        *\r\n        * @param nodeUI visual representation of the node created by node() execution.\r\n        **/\r\n        addNode : function (node, pos) {\r\n            var nodeUI = nodeBuilder(node);\r\n            if (!nodeUI) {\r\n                return;\r\n            }\r\n            nodeUI.position = pos;\r\n            nodeUI.node = node;\r\n            allNodes[node.id] = nodeUI;\r\n\r\n            svgContainer.appendChild(nodeUI);\r\n\r\n            return nodeUI;\r\n        },\r\n\r\n       /**\r\n        * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n        * provider remove node from rendering surface.\r\n        *\r\n        * @param node graph's node\r\n        **/\r\n        releaseNode : function (node) {\r\n            var nodeUI = allNodes[node.id];\r\n            if (nodeUI) {\r\n                svgContainer.removeChild(nodeUI);\r\n                delete allNodes[node.id];\r\n            }\r\n        },\r\n\r\n        renderNodes : function () {\r\n            for (var key in allNodes) {\r\n                if (allNodes.hasOwnProperty(key)) {\r\n                    var nodeUI = allNodes[key];\r\n                    cachedPos.x = nodeUI.position.x;\r\n                    cachedPos.y = nodeUI.position.y;\r\n                    nodePositionCallback(nodeUI, cachedPos, nodeUI.node);\r\n                }\r\n            }\r\n        },\r\n\r\n        renderLinks : function () {\r\n            for (var key in allLinks) {\r\n                if (allLinks.hasOwnProperty(key)) {\r\n                    var linkUI = allLinks[key];\r\n                    cachedFromPos.x = linkUI.position.from.x;\r\n                    cachedFromPos.y = linkUI.position.from.y;\r\n                    cachedToPos.x = linkUI.position.to.x;\r\n                    cachedToPos.y = linkUI.position.to.y;\r\n                    linkPositionCallback(linkUI, cachedFromPos, cachedToPos, linkUI.link);\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Returns root element which hosts graphics.\r\n         */\r\n        getGraphicsRoot : function (callbackWhenReady) {\r\n            // todo: should fire an event, instead of having this context.\r\n            if (typeof callbackWhenReady === \"function\") {\r\n                if (svgRoot) {\r\n                    callbackWhenReady(svgRoot);\r\n                } else {\r\n                    initCallback = callbackWhenReady;\r\n                }\r\n            }\r\n            return svgRoot;\r\n        },\r\n        /**\r\n         * Returns root SVG element.\r\n         *\r\n         * Note: This is internal method specific to this renderer\r\n         */\r\n        getSvgRoot : function () {\r\n            return svgRoot;\r\n        }\r\n    };\r\n\r\n\r\n    // Let graphics fire events before we return it to the caller.\r\n    eventify(graphics);\r\n\r\n    return graphics;\r\n\r\n    function createSvgRoot() {\r\n        var svgRoot = svg(\"svg\");\r\n\r\n        svgContainer = svg(\"g\")\r\n              .attr(\"buffered-rendering\", \"dynamic\");\r\n\r\n        svgRoot.appendChild(svgContainer);\r\n        return svgRoot;\r\n    }\r\n}\r\n","/**\r\n * @fileOverview Defines a graph renderer that uses WebGL based drawings.\r\n *\r\n * @author Andrei Kashcha (aka anvaka) / https://github.com/anvaka\r\n */\r\n\r\nmodule.exports = webglGraphics;\r\n\r\nvar webglInputManager = require('../Input/webglInputManager.js');\r\nvar webglLinkProgram = require('../WebGL/webglLinkProgram.js');\r\nvar webglNodeProgram = require('../WebGL/webglNodeProgram.js');\r\nvar webglSquare = require('../WebGL/webglSquare.js');\r\nvar webglLine = require('../WebGL/webglLine.js');\r\nvar eventify = require('ngraph.events');\r\nvar merge = require('ngraph.merge');\r\n\r\n/**\r\n * Performs webgl-based graph rendering. This module does not perform\r\n * layout, but only visualizes nodes and edges of the graph.\r\n *\r\n * @param options - to customize graphics  behavior. Currently supported parameter\r\n *  enableBlending - true by default, allows to use transparency in node/links colors.\r\n *  preserveDrawingBuffer - false by default, tells webgl to preserve drawing buffer.\r\n *                    See https://www.khronos.org/registry/webgl/specs/1.0/#5.2\r\n */\r\n\r\nfunction webglGraphics(options) {\r\n    options = merge(options, {\r\n        enableBlending : true,\r\n        preserveDrawingBuffer : false,\r\n        clearColor: false,\r\n        clearColorValue : {\r\n            r : 1,\r\n            g : 1,\r\n            b : 1,\r\n            a : 1\r\n        }\r\n    });\r\n\r\n    var container,\r\n        graphicsRoot,\r\n        gl,\r\n        width,\r\n        height,\r\n        nodesCount = 0,\r\n        linksCount = 0,\r\n        transform = [\r\n            1, 0, 0, 0,\r\n            0, 1, 0, 0,\r\n            0, 0, 1, 0,\r\n            0, 0, 0, 1\r\n        ],\r\n        userPlaceNodeCallback,\r\n        userPlaceLinkCallback,\r\n        nodes = [],\r\n        links = [],\r\n        initCallback,\r\n\r\n        allNodes = {},\r\n        allLinks = {},\r\n        linkProgram = webglLinkProgram(),\r\n        nodeProgram = webglNodeProgram(),\r\n/*jshint unused: false */\r\n        nodeUIBuilder = function (node) {\r\n            return webglSquare(); // Just make a square, using provided gl context (a nodeProgram);\r\n        },\r\n\r\n        linkUIBuilder = function (link) {\r\n            return webglLine(0xb3b3b3ff);\r\n        },\r\n/*jshint unused: true */\r\n        updateTransformUniform = function () {\r\n            linkProgram.updateTransform(transform);\r\n            nodeProgram.updateTransform(transform);\r\n        },\r\n\r\n        resetScaleInternal = function () {\r\n            transform = [1, 0, 0, 0,\r\n                        0, 1, 0, 0,\r\n                        0, 0, 1, 0,\r\n                        0, 0, 0, 1];\r\n        },\r\n\r\n        updateSize = function () {\r\n            if (container && graphicsRoot) {\r\n                width = graphicsRoot.width = Math.max(container.offsetWidth, 1);\r\n                height = graphicsRoot.height = Math.max(container.offsetHeight, 1);\r\n                if (gl) { gl.viewport(0, 0, width, height); }\r\n                if (linkProgram) { linkProgram.updateSize(width / 2, height / 2); }\r\n                if (nodeProgram) { nodeProgram.updateSize(width / 2, height / 2); }\r\n            }\r\n        },\r\n\r\n        fireRescaled = function (graphics) {\r\n            graphics.fire(\"rescaled\");\r\n        };\r\n\r\n    graphicsRoot = window.document.createElement(\"canvas\");\r\n\r\n    var graphics = {\r\n        getLinkUI: function (linkId) {\r\n            return allLinks[linkId];\r\n        },\r\n\r\n        getNodeUI: function (nodeId) {\r\n            return allNodes[nodeId];\r\n        },\r\n\r\n        /**\r\n         * Sets the callback that creates node representation.\r\n         *\r\n         * @param builderCallback a callback function that accepts graph node\r\n         * as a parameter and must return an element representing this node.\r\n         *\r\n         * @returns If builderCallbackOrNode is a valid callback function, instance of this is returned;\r\n         * Otherwise undefined value is returned\r\n         */\r\n        node : function (builderCallback) {\r\n            if (typeof builderCallback !== \"function\") {\r\n                return; // todo: throw? This is not compatible with old versions\r\n            }\r\n\r\n            nodeUIBuilder = builderCallback;\r\n\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Sets the callback that creates link representation\r\n         *\r\n         * @param builderCallback a callback function that accepts graph link\r\n         * as a parameter and must return an element representing this link.\r\n         *\r\n         * @returns If builderCallback is a valid callback function, instance of this is returned;\r\n         * Otherwise undefined value is returned.\r\n         */\r\n        link : function (builderCallback) {\r\n            if (typeof builderCallback !== \"function\") {\r\n                return; // todo: throw? This is not compatible with old versions\r\n            }\r\n\r\n            linkUIBuilder = builderCallback;\r\n            return this;\r\n        },\r\n\r\n\r\n        /**\r\n         * Allows to override default position setter for the node with a new\r\n         * function. newPlaceCallback(nodeUI, position) is function which\r\n         * is used by updateNodePosition().\r\n         */\r\n        placeNode : function (newPlaceCallback) {\r\n            userPlaceNodeCallback = newPlaceCallback;\r\n            return this;\r\n        },\r\n\r\n        placeLink : function (newPlaceLinkCallback) {\r\n            userPlaceLinkCallback = newPlaceLinkCallback;\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Custom input manager listens to mouse events to process nodes drag-n-drop inside WebGL canvas\r\n         */\r\n        inputManager : webglInputManager,\r\n\r\n        /**\r\n         * Called every time before renderer starts rendering.\r\n         */\r\n        beginRender : function () {\r\n            // this function could be replaced by this.init,\r\n            // based on user options.\r\n        },\r\n\r\n        /**\r\n         * Called every time when renderer finishes one step of rendering.\r\n         */\r\n        endRender : function () {\r\n            if (linksCount > 0) {\r\n                linkProgram.render();\r\n            }\r\n            if (nodesCount > 0) {\r\n                nodeProgram.render();\r\n            }\r\n        },\r\n\r\n        bringLinkToFront : function (linkUI) {\r\n            var frontLinkId = linkProgram.getFrontLinkId(),\r\n                srcLinkId,\r\n                temp;\r\n\r\n            linkProgram.bringToFront(linkUI);\r\n\r\n            if (frontLinkId > linkUI.id) {\r\n                srcLinkId = linkUI.id;\r\n\r\n                temp = links[frontLinkId];\r\n                links[frontLinkId] = links[srcLinkId];\r\n                links[frontLinkId].id = frontLinkId;\r\n                links[srcLinkId] = temp;\r\n                links[srcLinkId].id = srcLinkId;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Sets translate operation that should be applied to all nodes and links.\r\n         */\r\n        graphCenterChanged : function (x, y) {\r\n            transform[12] = (2 * x / width) - 1;\r\n            transform[13] = 1 - (2 * y / height);\r\n            updateTransformUniform();\r\n        },\r\n\r\n        /**\r\n         * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n         * provider prepare to render given link of the graph\r\n         *\r\n         * @param link - model of a link\r\n         */\r\n        addLink: function (link, boundPosition) {\r\n            var uiid = linksCount++,\r\n                ui = linkUIBuilder(link);\r\n            ui.id = uiid;\r\n            ui.pos = boundPosition;\r\n\r\n            linkProgram.createLink(ui);\r\n\r\n            links[uiid] = ui;\r\n            allLinks[link.id] = ui;\r\n            return ui;\r\n        },\r\n\r\n       /**\r\n        * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n        * provider prepare to render given node of the graph.\r\n        *\r\n        * @param nodeUI visual representation of the node created by node() execution.\r\n        **/\r\n        addNode : function (node, boundPosition) {\r\n            var uiid = nodesCount++,\r\n                ui = nodeUIBuilder(node);\r\n\r\n            ui.id = uiid;\r\n            ui.position = boundPosition;\r\n            ui.node = node;\r\n\r\n            nodeProgram.createNode(ui);\r\n\r\n            nodes[uiid] = ui;\r\n            allNodes[node.id] = ui;\r\n            return ui;\r\n        },\r\n\r\n        translateRel : function (dx, dy) {\r\n            transform[12] += (2 * transform[0] * dx / width) / transform[0];\r\n            transform[13] -= (2 * transform[5] * dy / height) / transform[5];\r\n            updateTransformUniform();\r\n        },\r\n\r\n        scale : function (scaleFactor, scrollPoint) {\r\n            // Transform scroll point to clip-space coordinates:\r\n            var cx = 2 * scrollPoint.x / width - 1,\r\n                cy = 1 - (2 * scrollPoint.y) / height;\r\n\r\n            cx -= transform[12];\r\n            cy -= transform[13];\r\n\r\n            transform[12] += cx * (1 - scaleFactor);\r\n            transform[13] += cy * (1 - scaleFactor);\r\n\r\n            transform[0] *= scaleFactor;\r\n            transform[5] *= scaleFactor;\r\n\r\n            updateTransformUniform();\r\n            fireRescaled(this);\r\n\r\n            return transform[0];\r\n        },\r\n\r\n        resetScale : function () {\r\n            resetScaleInternal();\r\n\r\n            if (gl) {\r\n                updateSize();\r\n                // TODO: what is this?\r\n                // gl.useProgram(linksProgram);\r\n                // gl.uniform2f(linksProgram.screenSize, width, height);\r\n                updateTransformUniform();\r\n            }\r\n            return this;\r\n        },\r\n\r\n       /**\r\n        * Resizes the graphic without resetting the scale. \r\n        * Useful with viva graph in a dynamic container\r\n        */\r\n        updateSize: updateSize,\r\n\r\n       /**\r\n        * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n        * provider prepare to render.\r\n        */\r\n        init : function (c) {\r\n            var contextParameters = {};\r\n\r\n            if (options.preserveDrawingBuffer) {\r\n                contextParameters.preserveDrawingBuffer = true;\r\n            }\r\n\r\n            container = c;\r\n\r\n            updateSize();\r\n            resetScaleInternal();\r\n            container.appendChild(graphicsRoot);\r\n\r\n\r\n            gl = graphicsRoot.getContext(\"experimental-webgl\", contextParameters);\r\n            if (!gl) {\r\n                var msg = \"Could not initialize WebGL. Seems like the browser doesn't support it.\";\r\n                window.alert(msg);\r\n                throw msg;\r\n            }\r\n            if (options.enableBlending) {\r\n                gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\r\n                gl.enable(gl.BLEND);\r\n            }\r\n            if (options.clearColor) {\r\n                var color = options.clearColorValue;\r\n                gl.clearColor(color.r, color.g, color.b, color.a);\r\n                // TODO: not the best way, really. Should come up with something better\r\n                // what if we need more updates inside beginRender, like depth buffer?\r\n                this.beginRender = function () {\r\n                    gl.clear(gl.COLOR_BUFFER_BIT);\r\n                };\r\n            }\r\n\r\n            linkProgram.load(gl);\r\n            linkProgram.updateSize(width / 2, height / 2);\r\n\r\n            nodeProgram.load(gl);\r\n            nodeProgram.updateSize(width / 2, height / 2);\r\n\r\n            updateTransformUniform();\r\n\r\n            // Notify the world if someone waited for update. TODO: should send an event\r\n            if (typeof initCallback === \"function\") {\r\n                initCallback(graphicsRoot);\r\n            }\r\n        },\r\n\r\n        /**\r\n        * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n        * provider release occupied resources.\r\n        */\r\n        release : function (container) {\r\n            if (graphicsRoot && container) {\r\n                container.removeChild(graphicsRoot);\r\n                // TODO: anything else?\r\n            }\r\n        },\r\n\r\n       /**\r\n        * Checks whether webgl is supported by this browser.\r\n        */\r\n        isSupported : function () {\r\n            var c = window.document.createElement(\"canvas\"),\r\n                gl = c && c.getContext && c.getContext(\"experimental-webgl\");\r\n            return gl;\r\n        },\r\n\r\n       /**\r\n        * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n        * provider remove link from rendering surface.\r\n        *\r\n        * @param linkUI visual representation of the link created by link() execution.\r\n        **/\r\n        releaseLink : function (link) {\r\n            if (linksCount > 0) { linksCount -= 1; }\r\n            var linkUI = allLinks[link.id];\r\n            delete allLinks[link.id];\r\n\r\n            linkProgram.removeLink(linkUI);\r\n\r\n            var linkIdToRemove = linkUI.id;\r\n            if (linkIdToRemove < linksCount) {\r\n                if (linksCount === 0 || linksCount === linkIdToRemove) {\r\n                    return; // no more links or removed link is the last one.\r\n                }\r\n\r\n                var lastLinkUI = links[linksCount];\r\n                links[linkIdToRemove] = lastLinkUI;\r\n                lastLinkUI.id = linkIdToRemove;\r\n            }\r\n        },\r\n\r\n       /**\r\n        * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n        * provider remove node from rendering surface.\r\n        *\r\n        * @param nodeUI visual representation of the node created by node() execution.\r\n        **/\r\n        releaseNode : function (node) {\r\n            if (nodesCount > 0) { nodesCount -= 1; }\r\n            var nodeUI = allNodes[node.id];\r\n            delete allNodes[node.id];\r\n\r\n            nodeProgram.removeNode(nodeUI);\r\n\r\n            var nodeIdToRemove = nodeUI.id;\r\n            if (nodeIdToRemove < nodesCount) {\r\n                if (nodesCount === 0 || nodesCount === nodeIdToRemove) {\r\n                    return; // no more nodes or removed node is the last in the list.\r\n                }\r\n\r\n                var lastNodeUI = nodes[nodesCount];\r\n\r\n                nodes[nodeIdToRemove] = lastNodeUI;\r\n                lastNodeUI.id = nodeIdToRemove;\r\n\r\n                // Since concrete shaders may cache properties in the UI element\r\n                // we are letting them to make this swap (e.g. image node shader\r\n                // uses this approach to update node's offset in the atlas)\r\n                nodeProgram.replaceProperties(nodeUI, lastNodeUI);\r\n            }\r\n        },\r\n\r\n        renderNodes: function () {\r\n            var pos = {x : 0, y : 0};\r\n            // WebGL coordinate system is different. Would be better\r\n            // to have this transform in the shader code, but it would\r\n            // require every shader to be updated..\r\n            for (var i = 0; i < nodesCount; ++i) {\r\n                var ui = nodes[i];\r\n                pos.x = ui.position.x;\r\n                pos.y = ui.position.y;\r\n                if (userPlaceNodeCallback) {\r\n                    userPlaceNodeCallback(ui, pos);\r\n                }\r\n\r\n                nodeProgram.position(ui, pos);\r\n            }\r\n        },\r\n\r\n        renderLinks: function () {\r\n            if (this.omitLinksRendering) { return; }\r\n\r\n            var toPos = {x : 0, y : 0};\r\n            var fromPos = {x : 0, y : 0};\r\n            for (var i = 0; i < linksCount; ++i) {\r\n                var ui = links[i];\r\n                var pos = ui.pos.from;\r\n                fromPos.x = pos.x;\r\n                fromPos.y = -pos.y;\r\n                pos = ui.pos.to;\r\n                toPos.x = pos.x;\r\n                toPos.y = -pos.y;\r\n                if (userPlaceLinkCallback) {\r\n                    userPlaceLinkCallback(ui, fromPos, toPos);\r\n                }\r\n\r\n                linkProgram.position(ui, fromPos, toPos);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Returns root element which hosts graphics.\r\n         */\r\n        getGraphicsRoot : function (callbackWhenReady) {\r\n            // todo: should fire an event, instead of having this context.\r\n            if (typeof callbackWhenReady === \"function\") {\r\n                if (graphicsRoot) {\r\n                    callbackWhenReady(graphicsRoot);\r\n                } else {\r\n                    initCallback = callbackWhenReady;\r\n                }\r\n            }\r\n            return graphicsRoot;\r\n        },\r\n\r\n        /**\r\n         * Updates default shader which renders nodes\r\n         *\r\n         * @param newProgram to use for nodes.\r\n         */\r\n        setNodeProgram : function (newProgram) {\r\n            if (!gl && newProgram) {\r\n                // Nothing created yet. Just set shader to the new one\r\n                // and let initialization logic take care about the rest.\r\n                nodeProgram = newProgram;\r\n            } else if (newProgram) {\r\n                throw \"Not implemented. Cannot swap shader on the fly... Yet.\";\r\n                // TODO: unload old shader and reinit.\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Updates default shader which renders links\r\n         *\r\n         * @param newProgram to use for links.\r\n         */\r\n        setLinkProgram : function (newProgram) {\r\n            if (!gl && newProgram) {\r\n                // Nothing created yet. Just set shader to the new one\r\n                // and let initialization logic take care about the rest.\r\n                linkProgram = newProgram;\r\n            } else if (newProgram) {\r\n                throw \"Not implemented. Cannot swap shader on the fly... Yet.\";\r\n                // TODO: unload old shader and reinit.\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Transforms client coordinates into layout coordinates. Client coordinates\r\n         * are DOM coordinates relative to the rendering container. Layout\r\n         * coordinates are those assigned by by layout algorithm to each node.\r\n         *\r\n         * @param {Object} p - a point object with `x` and `y` attributes.\r\n         * This method mutates p.\r\n         */\r\n        transformClientToGraphCoordinates: function (p) {\r\n          // TODO: could be a problem when container has margins?\r\n            // normalize\r\n            p.x = ((2 * p.x) / width) - 1;\r\n            p.y = 1 - ((2 * p.y) / height);\r\n\r\n            // apply transform\r\n            p.x = (p.x - transform[12]) / transform[0];\r\n            p.y = (p.y - transform[13]) / transform[5];\r\n\r\n            // transform to graph coordinates\r\n            p.x = p.x * (width / 2);\r\n            p.y = p.y * (-height / 2);\r\n\r\n            return p;\r\n        },\r\n\r\n        /**\r\n         * Transforms WebGL coordinates into client coordinates. Reverse of \r\n         * `transformClientToGraphCoordinates()`\r\n         *\r\n         * @param {Object} p - a point object with `x` and `y` attributes, which\r\n         * represents a layout coordinate. This method mutates p.\r\n         */\r\n        transformGraphToClientCoordinates: function (p) {\r\n          // TODO: could be a problem when container has margins?\r\n            // transform from graph coordinates\r\n            p.x = p.x / (width / 2);\r\n            p.y = p.y / (-height / 2);\r\n\r\n            // apply transform\r\n            p.x = (p.x * transform[0]) + transform[12];\r\n            p.y = (p.y * transform[5]) + transform[13];\r\n\r\n            // denormalize\r\n            p.x = ((p.x + 1) * width) / 2;\r\n            p.y = ((1 - p.y) * height) / 2;\r\n\r\n            return p;\r\n        },\r\n\r\n        getNodeAtClientPos: function (clientPos, preciseCheck) {\r\n            if (typeof preciseCheck !== \"function\") {\r\n                // we don't know anything about your node structure here :(\r\n                // potentially this could be delegated to node program, but for\r\n                // right now, we are giving up if you don't pass boundary check\r\n                // callback. It answers to a question is nodeUI covers  (x, y)\r\n                return null;\r\n            }\r\n            // first transform to graph coordinates:\r\n            this.transformClientToGraphCoordinates(clientPos);\r\n            // now using precise check iterate over each node and find one within box:\r\n            // TODO: This is poor O(N) performance.\r\n            for (var i = 0; i < nodesCount; ++i) {\r\n                if (preciseCheck(nodes[i], clientPos.x, clientPos.y)) {\r\n                    return nodes[i].node;\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n    };\r\n\r\n    // Let graphics fire events before we return it to the caller.\r\n    eventify(graphics);\r\n\r\n    return graphics;\r\n}\r\n","module.exports = parseColor;\n\nfunction parseColor(color) {\n  var parsedColor = 0x009ee8ff;\n\n  if (typeof color === 'string' && color) {\n    if (color.length === 4) { // #rgb\n      color = color.replace(/([^#])/g, '$1$1'); // duplicate each letter except first #.\n    }\n    if (color.length === 9) { // #rrggbbaa\n      parsedColor = parseInt(color.substr(1), 16);\n    } else if (color.length === 7) { // or #rrggbb.\n      parsedColor = (parseInt(color.substr(1), 16) << 8) | 0xff;\n    } else {\n      throw 'Color expected in hex format with preceding \"#\". E.g. #00ff00. Got value: ' + color;\n    }\n  } else if (typeof color === 'number') {\n    parsedColor = color;\n  }\n\n  return parsedColor;\n}\n","module.exports = Texture;\n\n/**\n * Single texture in the webglAtlas.\n */\nfunction Texture(size) {\n  this.canvas = window.document.createElement(\"canvas\");\n  this.ctx = this.canvas.getContext(\"2d\");\n  this.isDirty = false;\n  this.canvas.width = this.canvas.height = size;\n}\n","/**\n * @fileOverview Utility functions for webgl rendering.\n *\n * @author Andrei Kashcha (aka anvaka) / https://github.com/anvaka\n */\n\nmodule.exports = webgl;\n\nfunction webgl(gl) {\n\n  return {\n    createProgram: createProgram,\n    extendArray: extendArray,\n    copyArrayPart: copyArrayPart,\n    swapArrayPart: swapArrayPart,\n    getLocations: getLocations,\n    context: gl\n  };\n\n  function createShader(shaderText, type) {\n    var shader = gl.createShader(type);\n    gl.shaderSource(shader, shaderText);\n    gl.compileShader(shader);\n\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n      var msg = gl.getShaderInfoLog(shader);\n      window.alert(msg);\n      throw msg;\n    }\n\n    return shader;\n  }\n\n  function createProgram(vertexShaderSrc, fragmentShaderSrc) {\n    var program = gl.createProgram();\n    var vs = createShader(vertexShaderSrc, gl.VERTEX_SHADER);\n    var fs = createShader(fragmentShaderSrc, gl.FRAGMENT_SHADER);\n\n    gl.attachShader(program, vs);\n    gl.attachShader(program, fs);\n    gl.linkProgram(program);\n\n    if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n      var msg = gl.getShaderInfoLog(program);\n      window.alert(msg);\n      throw msg;\n    }\n\n    return program;\n  }\n\n  function extendArray(buffer, itemsInBuffer, elementsPerItem) {\n    if ((itemsInBuffer + 1) * elementsPerItem > buffer.length) {\n      // Every time we run out of space create new array twice bigger.\n      // TODO: it seems buffer size is limited. Consider using multiple arrays for huge graphs\n      var extendedArray = new Float32Array(buffer.length * elementsPerItem * 2);\n      extendedArray.set(buffer);\n\n      return extendedArray;\n    }\n\n    return buffer;\n  }\n\n  function getLocations(program, uniformOrAttributeNames) {\n    var foundLocations = {};\n    for (var i = 0; i < uniformOrAttributeNames.length; ++i) {\n      var name = uniformOrAttributeNames[i];\n      var location = -1;\n      if (name[0] === 'a' && name[1] === '_') {\n        location = gl.getAttribLocation(program, name);\n        if (location === -1) {\n          throw new Error(\"Program doesn't have required attribute: \" + name);\n        }\n\n        foundLocations[name.slice(2)] = location;\n      } else if (name[0] === 'u' && name[1] === '_') {\n        location = gl.getUniformLocation(program, name);\n        if (location === null) {\n          throw new Error(\"Program doesn't have required uniform: \" + name);\n        }\n\n        foundLocations[name.slice(2)] = location;\n      } else {\n        throw new Error(\"Couldn't figure out your intent. All uniforms should start with 'u_' prefix, and attributes with 'a_'\");\n      }\n    }\n\n    return foundLocations;\n  }\n}\n\nfunction copyArrayPart(array, to, from, elementsCount) {\n  for (var i = 0; i < elementsCount; ++i) {\n    array[to + i] = array[from + i];\n  }\n}\n\nfunction swapArrayPart(array, from, to, elementsCount) {\n  for (var i = 0; i < elementsCount; ++i) {\n    var tmp = array[from + i];\n    array[from + i] = array[to + i];\n    array[to + i] = tmp;\n  }\n}\n","var Texture = require('./texture.js');\n\nmodule.exports = webglAtlas;\n\n/**\n * My naive implementation of textures atlas. It allows clients to load\n * multiple images into atlas and get canvas representing all of them.\n *\n * @param tilesPerTexture - indicates how many images can be loaded to one\n *          texture of the atlas. If number of loaded images exceeds this\n *          parameter a new canvas will be created.\n */\nfunction webglAtlas(tilesPerTexture) {\n  var tilesPerRow = Math.sqrt(tilesPerTexture || 1024) << 0,\n    tileSize = tilesPerRow,\n    lastLoadedIdx = 1,\n    loadedImages = {},\n    dirtyTimeoutId,\n    skipedDirty = 0,\n    textures = [],\n    trackedUrls = [];\n\n  if (!isPowerOf2(tilesPerTexture)) {\n    throw \"Tiles per texture should be power of two.\";\n  }\n\n  // this is the return object\n  var api = {\n    /**\n     * indicates whether atlas has changed texture in it. If true then\n     * some of the textures has isDirty flag set as well.\n     */\n    isDirty: false,\n\n    /**\n     * Clears any signs of atlas changes.\n     */\n    clearDirty: clearDirty,\n\n    /**\n     * Removes given url from collection of tiles in the atlas.\n     */\n    remove: remove,\n\n    /**\n     * Gets all textures in the atlas.\n     */\n    getTextures: getTextures,\n\n    /**\n     * Gets coordinates of the given image in the atlas. Coordinates is an object:\n     * {offset : int } - where offset is an absolute position of the image in the\n     * atlas.\n     *\n     * Absolute means it can be larger than tilesPerTexture parameter, and in that\n     * case clients should get next texture in getTextures() collection.\n     */\n    getCoordinates: getCoordinates,\n\n    /**\n     * Asynchronously Loads the image to the atlas. Cross-domain security\n     * limitation applies.\n     */\n    load: load\n  };\n\n  return api;\n\n  function clearDirty() {\n    var i;\n    api.isDirty = false;\n    for (i = 0; i < textures.length; ++i) {\n      textures[i].isDirty = false;\n    }\n  }\n\n  function remove(imgUrl) {\n    var coordinates = loadedImages[imgUrl];\n    if (!coordinates) {\n      return false;\n    }\n    delete loadedImages[imgUrl];\n    lastLoadedIdx -= 1;\n\n\n    if (lastLoadedIdx === coordinates.offset) {\n      return true; // Ignore if it's last image in the whole set.\n    }\n\n    var tileToRemove = getTileCoordinates(coordinates.offset),\n      lastTileInSet = getTileCoordinates(lastLoadedIdx);\n\n    copy(lastTileInSet, tileToRemove);\n\n    var replacedOffset = loadedImages[trackedUrls[lastLoadedIdx]];\n    replacedOffset.offset = coordinates.offset;\n    trackedUrls[coordinates.offset] = trackedUrls[lastLoadedIdx];\n\n    markDirty();\n    return true;\n  }\n\n  function getTextures() {\n    return textures; // I trust you...\n  }\n\n  function getCoordinates(imgUrl) {\n    return loadedImages[imgUrl];\n  }\n\n  function load(imgUrl, callback) {\n    if (loadedImages.hasOwnProperty(imgUrl)) {\n      callback(loadedImages[imgUrl]);\n    } else {\n      var img = new window.Image(),\n        imgId = lastLoadedIdx;\n\n      lastLoadedIdx += 1;\n      img.crossOrigin = \"anonymous\";\n      img.onload = function() {\n        markDirty();\n        drawAt(imgId, img, callback);\n      };\n\n      img.src = imgUrl;\n    }\n  }\n\n  function createTexture() {\n    var texture = new Texture(tilesPerRow * tileSize);\n    textures.push(texture);\n  }\n\n  function drawAt(tileNumber, img, callback) {\n    var tilePosition = getTileCoordinates(tileNumber),\n      coordinates = {\n        offset: tileNumber\n      };\n\n    if (tilePosition.textureNumber >= textures.length) {\n      createTexture();\n    }\n    var currentTexture = textures[tilePosition.textureNumber];\n\n    currentTexture.ctx.drawImage(img, tilePosition.col * tileSize, tilePosition.row * tileSize, tileSize, tileSize);\n    trackedUrls[tileNumber] = img.src;\n\n    loadedImages[img.src] = coordinates;\n    currentTexture.isDirty = true;\n\n    callback(coordinates);\n  }\n\n  function getTileCoordinates(absolutePosition) {\n    var textureNumber = (absolutePosition / tilesPerTexture) << 0,\n      localTileNumber = (absolutePosition % tilesPerTexture),\n      row = (localTileNumber / tilesPerRow) << 0,\n      col = (localTileNumber % tilesPerRow);\n\n    return {\n      textureNumber: textureNumber,\n      row: row,\n      col: col\n    };\n  }\n\n  function markDirtyNow() {\n    api.isDirty = true;\n    skipedDirty = 0;\n    dirtyTimeoutId = null;\n  }\n\n  function markDirty() {\n    // delay this call, since it results in texture reload\n    if (dirtyTimeoutId) {\n      window.clearTimeout(dirtyTimeoutId);\n      skipedDirty += 1;\n      dirtyTimeoutId = null;\n    }\n\n    if (skipedDirty > 10) {\n      markDirtyNow();\n    } else {\n      dirtyTimeoutId = window.setTimeout(markDirtyNow, 400);\n    }\n  }\n\n  function copy(from, to) {\n    var fromCanvas = textures[from.textureNumber].canvas,\n      toCtx = textures[to.textureNumber].ctx,\n      x = to.col * tileSize,\n      y = to.row * tileSize;\n\n    toCtx.drawImage(fromCanvas, from.col * tileSize, from.row * tileSize, tileSize, tileSize, x, y, tileSize, tileSize);\n    textures[from.textureNumber].isDirty = true;\n    textures[to.textureNumber].isDirty = true;\n  }\n}\n\nfunction isPowerOf2(n) {\n  return (n & (n - 1)) === 0;\n}\n","module.exports = webglImage;\n\n/**\n * Represents a model for image.\n */\nfunction webglImage(size, src) {\n    return {\n        /**\n         * Gets texture index where current image is placed.\n         */\n        _texture : 0,\n\n        /**\n         * Gets offset in the texture where current image is placed.\n         */\n        _offset : 0,\n\n        /**\n         * Gets size of the square with the image.\n         */\n        size : typeof size === 'number' ? size : 32,\n\n        /**\n         * Source of the image. If image is coming not from your domain\n         * certain origin restrictions applies.\n         * See http://www.khronos.org/registry/webgl/specs/latest/#4.2 for more details.\n         */\n        src  : src\n    };\n}\n","/**\n * @fileOverview Defines an image nodes for webglGraphics class.\n * Shape of nodes is square.\n *\n * @author Andrei Kashcha (aka anvaka) / https://github.com/anvaka\n */\n\nvar WebglAtlas = require('./webglAtlas.js');\nvar glUtils = require('./webgl.js');\n\nmodule.exports = webglImageNodeProgram;\n\n/**\n * Defines simple UI for nodes in webgl renderer. Each node is rendered as an image.\n * \n * @param {number} tilesPerTexture\n * \n */\nfunction webglImageNodeProgram(tilesPerTexture) {\n  // WebGL is gian state machine, we store some properties of the state here:\n  var ATTRIBUTES_PER_PRIMITIVE = 18;\n  var nodesFS = createNodeFragmentShader();\n  var nodesVS = createNodeVertexShader();\n  var tilesPerTexture = tilesPerTexture || 1024; // TODO: Get based on max texture size\n  var atlas;\n  var program;\n  var gl;\n  var buffer;\n  var utils;\n  var locations;\n  var nodesCount = 0;\n  var nodes = new Float32Array(64);\n  var width;\n  var height;\n  var transform;\n  var sizeDirty;\n\n\n  return {\n    load: load,\n\n    /**\n     * Updates position of current node in the buffer of nodes.\n     *\n     * @param idx - index of current node.\n     * @param pos - new position of the node.\n     */\n    position: position,\n\n    createNode: createNode,\n\n    removeNode: removeNode,\n\n    replaceProperties: replaceProperties,\n\n    updateTransform: updateTransform,\n\n    updateSize: updateSize,\n\n    render: render\n  };\n\n  function refreshTexture(texture, idx) {\n    if (texture.nativeObject) {\n      gl.deleteTexture(texture.nativeObject);\n    }\n\n    var nativeObject = gl.createTexture();\n    gl.activeTexture(gl[\"TEXTURE\" + idx]);\n    gl.bindTexture(gl.TEXTURE_2D, nativeObject);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, texture.canvas);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_NEAREST);\n\n    gl.generateMipmap(gl.TEXTURE_2D);\n    gl.uniform1i(locations[\"sampler\" + idx], idx);\n\n    texture.nativeObject = nativeObject;\n  }\n\n  function ensureAtlasTextureUpdated() {\n    if (atlas.isDirty) {\n      var textures = atlas.getTextures(),\n        i;\n      for (i = 0; i < textures.length; ++i) {\n        if (textures[i].isDirty || !textures[i].nativeObject) {\n          refreshTexture(textures[i], i);\n        }\n      }\n\n      atlas.clearDirty();\n    }\n  }\n\n  function load(glContext) {\n    gl = glContext;\n    utils = glUtils(glContext);\n\n    atlas = new WebglAtlas(tilesPerTexture);\n\n    program = utils.createProgram(nodesVS, nodesFS);\n    gl.useProgram(program);\n    locations = utils.getLocations(program, [\"a_vertexPos\", \"a_customAttributes\", \"u_screenSize\", \"u_transform\", \"u_sampler0\", \"u_sampler1\", \"u_sampler2\", \"u_sampler3\", \"u_tilesPerTexture\"]);\n\n    gl.uniform1f(locations.tilesPerTexture, tilesPerTexture);\n\n    gl.enableVertexAttribArray(locations.vertexPos);\n    gl.enableVertexAttribArray(locations.customAttributes);\n\n    buffer = gl.createBuffer();\n  }\n\n  function position(nodeUI, pos) {\n    var idx = nodeUI.id * ATTRIBUTES_PER_PRIMITIVE;\n    nodes[idx] = pos.x - nodeUI.size;\n    nodes[idx + 1] = -pos.y - nodeUI.size;\n    nodes[idx + 2] = nodeUI._offset * 4;\n\n    nodes[idx + 3] = pos.x + nodeUI.size;\n    nodes[idx + 4] = -pos.y - nodeUI.size;\n    nodes[idx + 5] = nodeUI._offset * 4 + 1;\n\n    nodes[idx + 6] = pos.x - nodeUI.size;\n    nodes[idx + 7] = -pos.y + nodeUI.size;\n    nodes[idx + 8] = nodeUI._offset * 4 + 2;\n\n    nodes[idx + 9] = pos.x - nodeUI.size;\n    nodes[idx + 10] = -pos.y + nodeUI.size;\n    nodes[idx + 11] = nodeUI._offset * 4 + 2;\n\n    nodes[idx + 12] = pos.x + nodeUI.size;\n    nodes[idx + 13] = -pos.y - nodeUI.size;\n    nodes[idx + 14] = nodeUI._offset * 4 + 1;\n\n    nodes[idx + 15] = pos.x + nodeUI.size;\n    nodes[idx + 16] = -pos.y + nodeUI.size;\n    nodes[idx + 17] = nodeUI._offset * 4 + 3;\n  }\n\n  function createNode(ui) {\n    nodes = utils.extendArray(nodes, nodesCount, ATTRIBUTES_PER_PRIMITIVE);\n    nodesCount += 1;\n\n    var coordinates = atlas.getCoordinates(ui.src);\n    if (coordinates) {\n      ui._offset = coordinates.offset;\n    } else {\n      ui._offset = 0;\n      // Image is not yet loaded into the atlas. Reload it:\n      atlas.load(ui.src, function(coordinates) {\n        ui._offset = coordinates.offset;\n      });\n    }\n  }\n\n  function removeNode(nodeUI) {\n    if (nodesCount > 0) {\n      nodesCount -= 1;\n    }\n\n    if (nodeUI.id < nodesCount && nodesCount > 0) {\n      if (nodeUI.src) {\n        atlas.remove(nodeUI.src);\n      }\n\n      utils.copyArrayPart(nodes, nodeUI.id * ATTRIBUTES_PER_PRIMITIVE, nodesCount * ATTRIBUTES_PER_PRIMITIVE, ATTRIBUTES_PER_PRIMITIVE);\n    }\n  }\n\n  function replaceProperties(replacedNode, newNode) {\n    newNode._offset = replacedNode._offset;\n  }\n\n  function updateTransform(newTransform) {\n    sizeDirty = true;\n    transform = newTransform;\n  }\n\n  function updateSize(w, h) {\n    width = w;\n    height = h;\n    sizeDirty = true;\n  }\n\n  function render() {\n    gl.useProgram(program);\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n    gl.bufferData(gl.ARRAY_BUFFER, nodes, gl.DYNAMIC_DRAW);\n\n    if (sizeDirty) {\n      sizeDirty = false;\n      gl.uniformMatrix4fv(locations.transform, false, transform);\n      gl.uniform2f(locations.screenSize, width, height);\n    }\n\n    gl.vertexAttribPointer(locations.vertexPos, 2, gl.FLOAT, false, 3 * Float32Array.BYTES_PER_ELEMENT, 0);\n    gl.vertexAttribPointer(locations.customAttributes, 1, gl.FLOAT, false, 3 * Float32Array.BYTES_PER_ELEMENT, 2 * 4);\n\n    ensureAtlasTextureUpdated();\n\n    gl.drawArrays(gl.TRIANGLES, 0, nodesCount * 6);\n  }\n}\n\n// TODO: Use glslify for shaders\nfunction createNodeFragmentShader() {\n  return [\n    \"precision mediump float;\",\n    \"varying vec4 color;\",\n    \"varying vec3 vTextureCoord;\",\n    \"uniform sampler2D u_sampler0;\",\n    \"uniform sampler2D u_sampler1;\",\n    \"uniform sampler2D u_sampler2;\",\n    \"uniform sampler2D u_sampler3;\",\n\n    \"void main(void) {\",\n    \"   if (vTextureCoord.z == 0.) {\",\n    \"     gl_FragColor = texture2D(u_sampler0, vTextureCoord.xy);\",\n    \"   } else if (vTextureCoord.z == 1.) {\",\n    \"     gl_FragColor = texture2D(u_sampler1, vTextureCoord.xy);\",\n    \"   } else if (vTextureCoord.z == 2.) {\",\n    \"     gl_FragColor = texture2D(u_sampler2, vTextureCoord.xy);\",\n    \"   } else if (vTextureCoord.z == 3.) {\",\n    \"     gl_FragColor = texture2D(u_sampler3, vTextureCoord.xy);\",\n    \"   } else { gl_FragColor = vec4(0, 1, 0, 1); }\",\n    \"}\"\n  ].join(\"\\n\");\n}\n\nfunction createNodeVertexShader() {\n  return [\n    \"attribute vec2 a_vertexPos;\",\n\n    \"attribute float a_customAttributes;\",\n    \"uniform vec2 u_screenSize;\",\n    \"uniform mat4 u_transform;\",\n    \"uniform float u_tilesPerTexture;\",\n    \"varying vec3 vTextureCoord;\",\n\n    \"void main(void) {\",\n    \"   gl_Position = u_transform * vec4(a_vertexPos/u_screenSize, 0, 1);\",\n    \"float corner = mod(a_customAttributes, 4.);\",\n    \"float tileIndex = mod(floor(a_customAttributes / 4.), u_tilesPerTexture);\",\n    \"float tilesPerRow = sqrt(u_tilesPerTexture);\",\n    \"float tileSize = 1./tilesPerRow;\",\n    \"float tileColumn = mod(tileIndex, tilesPerRow);\",\n    \"float tileRow = floor(tileIndex/tilesPerRow);\",\n\n    \"if(corner == 0.0) {\",\n    \"  vTextureCoord.xy = vec2(0, 1);\",\n    \"} else if(corner == 1.0) {\",\n    \"  vTextureCoord.xy = vec2(1, 1);\",\n    \"} else if(corner == 2.0) {\",\n    \"  vTextureCoord.xy = vec2(0, 0);\",\n    \"} else {\",\n    \"  vTextureCoord.xy = vec2(1, 0);\",\n    \"}\",\n\n    \"vTextureCoord *= tileSize;\",\n    \"vTextureCoord.x += tileColumn * tileSize;\",\n    \"vTextureCoord.y += tileRow * tileSize;\",\n    \"vTextureCoord.z = floor(floor(a_customAttributes / 4.)/u_tilesPerTexture);\",\n    \"}\"\n  ].join(\"\\n\");\n}\n","var documentEvents = require('../Utils/documentEvents.js');\n\nmodule.exports = webglInputEvents;\n\n/**\n * Monitors graph-related mouse input in webgl graphics and notifies subscribers.\n *\n * @param {Viva.Graph.View.webglGraphics} webglGraphics\n */\nfunction webglInputEvents(webglGraphics) {\n  if (webglGraphics.webglInputEvents) {\n    // Don't listen twice, if we are already attached to this graphics:\n    return webglGraphics.webglInputEvents;\n  }\n\n  var mouseCapturedNode = null,\n    mouseEnterCallback = [],\n    mouseLeaveCallback = [],\n    mouseDownCallback = [],\n    mouseUpCallback = [],\n    mouseMoveCallback = [],\n    clickCallback = [],\n    dblClickCallback = [],\n    prevSelectStart,\n    boundRect;\n\n  var root = webglGraphics.getGraphicsRoot();\n  startListen(root);\n\n  var api = {\n    mouseEnter: mouseEnter,\n    mouseLeave: mouseLeave,\n    mouseDown: mouseDown,\n    mouseUp: mouseUp,\n    mouseMove: mouseMove,\n    click: click,\n    dblClick: dblClick,\n    mouseCapture: mouseCapture,\n    releaseMouseCapture: releaseMouseCapture\n  };\n\n  // TODO I don't remember why this is needed:\n  webglGraphics.webglInputEvents = api;\n\n  return api;\n\n  function releaseMouseCapture() {\n    mouseCapturedNode = null;\n  }\n\n  function mouseCapture(node) {\n    mouseCapturedNode = node;\n  }\n\n  function dblClick(callback) {\n    if (typeof callback === 'function') {\n      dblClickCallback.push(callback);\n    }\n    return api;\n  }\n\n  function click(callback) {\n    if (typeof callback === 'function') {\n      clickCallback.push(callback);\n    }\n    return api;\n  }\n\n  function mouseMove(callback) {\n    if (typeof callback === 'function') {\n      mouseMoveCallback.push(callback);\n    }\n    return api;\n  }\n\n  function mouseUp(callback) {\n    if (typeof callback === 'function') {\n      mouseUpCallback.push(callback);\n    }\n    return api;\n  }\n\n  function mouseDown(callback) {\n    if (typeof callback === 'function') {\n      mouseDownCallback.push(callback);\n    }\n    return api;\n  }\n\n  function mouseLeave(callback) {\n    if (typeof callback === 'function') {\n      mouseLeaveCallback.push(callback);\n    }\n    return api;\n  }\n\n  function mouseEnter(callback) {\n    if (typeof callback === 'function') {\n      mouseEnterCallback.push(callback);\n    }\n    return api;\n  }\n\n  function preciseCheck(nodeUI, x, y) {\n    if (nodeUI && nodeUI.size) {\n      var pos = nodeUI.position,\n        half = nodeUI.size;\n\n      return pos.x - half < x && x < pos.x + half &&\n        pos.y - half < y && y < pos.y + half;\n    }\n\n    return true;\n  }\n\n  function getNodeAtClientPos(pos) {\n    return webglGraphics.getNodeAtClientPos(pos, preciseCheck);\n  }\n\n  function stopPropagation(e) {\n    if (e.stopPropagation) {\n      e.stopPropagation();\n    } else {\n      e.cancelBubble = true;\n    }\n  }\n\n  function handleDisabledEvent(e) {\n    stopPropagation(e);\n    return false;\n  }\n\n  function invoke(callbacksChain, args) {\n    var i, stopPropagation;\n    for (i = 0; i < callbacksChain.length; i += 1) {\n      stopPropagation = callbacksChain[i].apply(undefined, args);\n      if (stopPropagation) {\n        return true;\n      }\n    }\n  }\n\n  function startListen(root) {\n    var pos = {\n        x: 0,\n        y: 0\n      },\n      lastFound = null,\n      lastUpdate = 1,\n      lastClickTime = +new Date(),\n\n      handleMouseMove = function(e) {\n        invoke(mouseMoveCallback, [lastFound, e]);\n        pos.x = e.clientX;\n        pos.y = e.clientY;\n      },\n\n      handleMouseUp = function() {\n        documentEvents.off('mousemove', handleMouseMove);\n        documentEvents.off('mouseup', handleMouseUp);\n      },\n\n      updateBoundRect = function() {\n        boundRect = root.getBoundingClientRect();\n      };\n\n    window.addEventListener('resize', updateBoundRect);\n    updateBoundRect();\n\n    // mouse move inside container serves only to track mouse enter/leave events.\n    root.addEventListener('mousemove',\n      function(e) {\n        if (mouseCapturedNode) {\n          return;\n        }\n        if (lastUpdate++ % 7 === 0) {\n          // since there is no bullet proof method to detect resize\n          // event, we preemptively update the bounding rectangle\n          updateBoundRect();\n          lastUpdate = 1;\n        }\n        var cancelBubble = false,\n          node;\n\n        pos.x = e.clientX - boundRect.left;\n        pos.y = e.clientY - boundRect.top;\n\n        node = getNodeAtClientPos(pos);\n\n        if (node && lastFound !== node) {\n          if(lastFound){ \n            invoke(mouseLeaveCallback, [lastFound]);\n          }\n          lastFound = node;\n          cancelBubble = cancelBubble || invoke(mouseEnterCallback, [lastFound]);\n        } else if (node === null && lastFound !== node) {\n          cancelBubble = cancelBubble || invoke(mouseLeaveCallback, [lastFound]);\n          lastFound = null;\n        }\n\n        if (cancelBubble) {\n          stopPropagation(e);\n        }\n      });\n\n    root.addEventListener('mousedown',\n      function(e) {\n        var cancelBubble = false,\n          args;\n        updateBoundRect();\n        pos.x = e.clientX - boundRect.left;\n        pos.y = e.clientY - boundRect.top;\n\n        args = [getNodeAtClientPos(pos), e];\n        if (args[0]) {\n          cancelBubble = invoke(mouseDownCallback, args);\n          // we clicked on a node. Following drag should be handled on document events:\n          documentEvents.on('mousemove', handleMouseMove);\n          documentEvents.on('mouseup', handleMouseUp);\n\n          prevSelectStart = window.document.onselectstart;\n\n          window.document.onselectstart = handleDisabledEvent;\n\n          lastFound = args[0];\n        } else {\n          lastFound = null;\n        }\n        if (cancelBubble) {\n          stopPropagation(e);\n        }\n      });\n\n    root.addEventListener('mouseup',\n      function(e) {\n        var clickTime = +new Date(),\n          args;\n\n        pos.x = e.clientX - boundRect.left;\n        pos.y = e.clientY - boundRect.top;\n\n        var nodeAtClientPos = getNodeAtClientPos(pos);\n        var sameNode = nodeAtClientPos === lastFound;\n        args = [nodeAtClientPos || lastFound, e];\n        if (args[0]) {\n          window.document.onselectstart = prevSelectStart;\n\n          if (clickTime - lastClickTime < 400 && sameNode) {\n            invoke(dblClickCallback, args);\n          } else {\n            invoke(clickCallback, args);\n          }\n          lastClickTime = clickTime;\n\n          if (invoke(mouseUpCallback, args)) {\n            stopPropagation(e);\n          }\n        }\n      });\n  }\n}\n","var parseColor = require('./parseColor.js');\n\nmodule.exports = webglLine;\n\n/**\n * Defines a webgl line. This class has no rendering logic at all,\n * it's just passed to corresponding shader and the shader should\n * figure out how to render it.\n *\n */\nfunction webglLine(color) {\n  return {\n    /**\n     * Gets or sets color of the line. If you set this property externally\n     * make sure it always come as integer of 0xRRGGBBAA format\n     */\n    color: parseColor(color)\n  };\n}\n","/**\n * @fileOverview Defines a naive form of links for webglGraphics class.\n * This form allows to change color of links.\n **/\n\nvar glUtils = require('./webgl.js');\n\nmodule.exports = webglLinkProgram;\n\n/**\n * Defines UI for links in webgl renderer.\n */\nfunction webglLinkProgram() {\n    var ATTRIBUTES_PER_PRIMITIVE = 6, // primitive is Line with two points. Each has x,y and color = 3 * 2 attributes.\n        BYTES_PER_LINK = 2 * (2 * Float32Array.BYTES_PER_ELEMENT + Uint32Array.BYTES_PER_ELEMENT), // two nodes * (x, y + color)\n        linksFS = [\n            'precision mediump float;',\n            'varying vec4 color;',\n            'void main(void) {',\n            '   gl_FragColor = color;',\n            '}'\n        ].join('\\n'),\n\n        linksVS = [\n            'attribute vec2 a_vertexPos;',\n            'attribute vec4 a_color;',\n\n            'uniform vec2 u_screenSize;',\n            'uniform mat4 u_transform;',\n\n            'varying vec4 color;',\n\n            'void main(void) {',\n            '   gl_Position = u_transform * vec4(a_vertexPos/u_screenSize, 0.0, 1.0);',\n            '   color = a_color.abgr;',\n            '}'\n        ].join('\\n'),\n\n        program,\n        gl,\n        buffer,\n        utils,\n        locations,\n        linksCount = 0,\n        frontLinkId, // used to track z-index of links.\n        storage = new ArrayBuffer(16 * BYTES_PER_LINK),\n        positions = new Float32Array(storage),\n        colors = new Uint32Array(storage),\n        width,\n        height,\n        transform,\n        sizeDirty,\n\n        ensureEnoughStorage = function () {\n            // TODO: this is a duplicate of webglNodeProgram code. Extract it to webgl.js\n            if ((linksCount+1)*BYTES_PER_LINK > storage.byteLength) {\n                // Every time we run out of space create new array twice bigger.\n                // TODO: it seems buffer size is limited. Consider using multiple arrays for huge graphs\n                var extendedStorage = new ArrayBuffer(storage.byteLength * 2),\n                    extendedPositions = new Float32Array(extendedStorage),\n                    extendedColors = new Uint32Array(extendedStorage);\n\n                extendedColors.set(colors); // should be enough to copy just one view.\n                positions = extendedPositions;\n                colors = extendedColors;\n                storage = extendedStorage;\n            }\n        };\n\n    return {\n        load : function (glContext) {\n            gl = glContext;\n            utils = glUtils(glContext);\n\n            program = utils.createProgram(linksVS, linksFS);\n            gl.useProgram(program);\n            locations = utils.getLocations(program, ['a_vertexPos', 'a_color', 'u_screenSize', 'u_transform']);\n\n            gl.enableVertexAttribArray(locations.vertexPos);\n            gl.enableVertexAttribArray(locations.color);\n\n            buffer = gl.createBuffer();\n        },\n\n        position: function (linkUi, fromPos, toPos) {\n            var linkIdx = linkUi.id,\n                offset = linkIdx * ATTRIBUTES_PER_PRIMITIVE;\n            positions[offset] = fromPos.x;\n            positions[offset + 1] = fromPos.y;\n            colors[offset + 2] = linkUi.color;\n\n            positions[offset + 3] = toPos.x;\n            positions[offset + 4] = toPos.y;\n            colors[offset + 5] = linkUi.color;\n        },\n\n        createLink : function (ui) {\n            ensureEnoughStorage();\n\n            linksCount += 1;\n            frontLinkId = ui.id;\n        },\n\n        removeLink : function (ui) {\n            if (linksCount > 0) { linksCount -= 1; }\n            // swap removed link with the last link. This will give us O(1) performance for links removal:\n            if (ui.id < linksCount && linksCount > 0) {\n                // using colors as a view to array buffer is okay here.\n                utils.copyArrayPart(colors, ui.id * ATTRIBUTES_PER_PRIMITIVE, linksCount * ATTRIBUTES_PER_PRIMITIVE, ATTRIBUTES_PER_PRIMITIVE);\n            }\n        },\n\n        updateTransform : function (newTransform) {\n            sizeDirty = true;\n            transform = newTransform;\n        },\n\n        updateSize : function (w, h) {\n            width = w;\n            height = h;\n            sizeDirty = true;\n        },\n\n        render : function () {\n            gl.useProgram(program);\n            gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n            gl.bufferData(gl.ARRAY_BUFFER, storage, gl.DYNAMIC_DRAW);\n\n            if (sizeDirty) {\n                sizeDirty = false;\n                gl.uniformMatrix4fv(locations.transform, false, transform);\n                gl.uniform2f(locations.screenSize, width, height);\n            }\n\n            gl.vertexAttribPointer(locations.vertexPos, 2, gl.FLOAT, false, 3 * Float32Array.BYTES_PER_ELEMENT, 0);\n            gl.vertexAttribPointer(locations.color, 4, gl.UNSIGNED_BYTE, true, 3 * Float32Array.BYTES_PER_ELEMENT, 2 * 4);\n\n            gl.drawArrays(gl.LINES, 0, linksCount * 2);\n\n            frontLinkId = linksCount - 1;\n        },\n\n        bringToFront : function (link) {\n            if (frontLinkId > link.id) {\n                utils.swapArrayPart(positions, link.id * ATTRIBUTES_PER_PRIMITIVE, frontLinkId * ATTRIBUTES_PER_PRIMITIVE, ATTRIBUTES_PER_PRIMITIVE);\n            }\n            if (frontLinkId > 0) {\n                frontLinkId -= 1;\n            }\n        },\n\n        getFrontLinkId : function () {\n            return frontLinkId;\n        }\n    };\n}\n","/**\n * @fileOverview Defines a naive form of nodes for webglGraphics class.\n * This form allows to change color of node. Shape of nodes is rectangular.\n *\n * @author Andrei Kashcha (aka anvaka) / https://github.com/anvaka\n */\n\nvar glUtils = require('./webgl.js');\n\nmodule.exports = webglNodeProgram;\n\n/**\n * Defines simple UI for nodes in webgl renderer. Each node is rendered as square. Color and size can be changed.\n */\nfunction webglNodeProgram() {\n  var ATTRIBUTES_PER_PRIMITIVE = 4; // Primitive is point, x, y, size, color\n  // x, y, z - floats, color = uint.\n  var BYTES_PER_NODE = 3 * Float32Array.BYTES_PER_ELEMENT + Uint32Array.BYTES_PER_ELEMENT;\n  var nodesFS = [\n    'precision mediump float;',\n    'varying vec4 color;',\n\n    'void main(void) {',\n    '   gl_FragColor = color;',\n    '}'\n  ].join('\\n');\n  var nodesVS = [\n    'attribute vec3 a_vertexPos;',\n    'attribute vec4 a_color;',\n    'uniform vec2 u_screenSize;',\n    'uniform mat4 u_transform;',\n    'varying vec4 color;',\n\n    'void main(void) {',\n    '   gl_Position = u_transform * vec4(a_vertexPos.xy/u_screenSize, 0, 1);',\n    '   gl_PointSize = a_vertexPos.z * u_transform[0][0];',\n    '   color = a_color.abgr;',\n    '}'\n  ].join('\\n');\n\n  var program;\n  var gl;\n  var buffer;\n  var locations;\n  var utils;\n  var storage = new ArrayBuffer(16 * BYTES_PER_NODE);\n  var positions = new Float32Array(storage);\n  var colors = new Uint32Array(storage);\n  var nodesCount = 0;\n  var width;\n  var height;\n  var transform;\n  var sizeDirty;\n\n  return {\n    load: load,\n\n    /**\n     * Updates position of node in the buffer of nodes.\n     *\n     * @param idx - index of current node.\n     * @param pos - new position of the node.\n     */\n    position: position,\n\n    updateTransform: updateTransform,\n\n    updateSize: updateSize,\n\n    removeNode: removeNode,\n\n    createNode: createNode,\n\n    replaceProperties: replaceProperties,\n\n    render: render\n  };\n\n  function ensureEnoughStorage() {\n    if ((nodesCount + 1) * BYTES_PER_NODE >= storage.byteLength) {\n      // Every time we run out of space create new array twice bigger.\n      // TODO: it seems buffer size is limited. Consider using multiple arrays for huge graphs\n      var extendedStorage = new ArrayBuffer(storage.byteLength * 2),\n        extendedPositions = new Float32Array(extendedStorage),\n        extendedColors = new Uint32Array(extendedStorage);\n\n      extendedColors.set(colors); // should be enough to copy just one view.\n      positions = extendedPositions;\n      colors = extendedColors;\n      storage = extendedStorage;\n    }\n  }\n\n  function load(glContext) {\n    gl = glContext;\n    utils = glUtils(glContext);\n\n    program = utils.createProgram(nodesVS, nodesFS);\n    gl.useProgram(program);\n    locations = utils.getLocations(program, ['a_vertexPos', 'a_color', 'u_screenSize', 'u_transform']);\n\n    gl.enableVertexAttribArray(locations.vertexPos);\n    gl.enableVertexAttribArray(locations.color);\n\n    buffer = gl.createBuffer();\n  }\n\n  function position(nodeUI, pos) {\n    var idx = nodeUI.id;\n\n    positions[idx * ATTRIBUTES_PER_PRIMITIVE] = pos.x;\n    positions[idx * ATTRIBUTES_PER_PRIMITIVE + 1] = -pos.y;\n    positions[idx * ATTRIBUTES_PER_PRIMITIVE + 2] = nodeUI.size;\n\n    colors[idx * ATTRIBUTES_PER_PRIMITIVE + 3] = nodeUI.color;\n  }\n\n  function updateTransform(newTransform) {\n    sizeDirty = true;\n    transform = newTransform;\n  }\n\n  function updateSize(w, h) {\n    width = w;\n    height = h;\n    sizeDirty = true;\n  }\n\n  function removeNode(node) {\n      if (nodesCount > 0) {\n        nodesCount -= 1;\n      }\n\n      if (node.id < nodesCount && nodesCount > 0) {\n        // we can use colors as a 'view' into array array buffer.\n        utils.copyArrayPart(colors, node.id * ATTRIBUTES_PER_PRIMITIVE, nodesCount * ATTRIBUTES_PER_PRIMITIVE, ATTRIBUTES_PER_PRIMITIVE);\n      }\n    }\n\n  function createNode() {\n    ensureEnoughStorage();\n    nodesCount += 1;\n  }\n\n  function replaceProperties(/* replacedNode, newNode */) {}\n\n  function render() {\n    gl.useProgram(program);\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n    gl.bufferData(gl.ARRAY_BUFFER, storage, gl.DYNAMIC_DRAW);\n\n    if (sizeDirty) {\n      sizeDirty = false;\n      gl.uniformMatrix4fv(locations.transform, false, transform);\n      gl.uniform2f(locations.screenSize, width, height);\n    }\n\n    gl.vertexAttribPointer(locations.vertexPos, 3, gl.FLOAT, false, ATTRIBUTES_PER_PRIMITIVE * Float32Array.BYTES_PER_ELEMENT, 0);\n    gl.vertexAttribPointer(locations.color, 4, gl.UNSIGNED_BYTE, true, ATTRIBUTES_PER_PRIMITIVE * Float32Array.BYTES_PER_ELEMENT, 3 * 4);\n\n    gl.drawArrays(gl.POINTS, 0, nodesCount);\n  }\n}\n","var parseColor = require('./parseColor.js');\n\nmodule.exports = webglSquare;\n\n/**\n * Can be used as a callback in the webglGraphics.node() function, to\n * create a custom looking node.\n *\n * @param size - size of the node in pixels.\n * @param color - color of the node in '#rrggbbaa' or '#rgb' format.\n */\nfunction webglSquare(size, color) {\n  return {\n    /**\n     * Gets or sets size of the square side.\n     */\n    size: typeof size === 'number' ? size : 10,\n\n    /**\n     * Gets or sets color of the square.\n     */\n    color: parseColor(color)\n  };\n}\n","// todo: this should be generated at build time.\nmodule.exports = '0.10.1';\n","/**\r\n * This is an entry point for global namespace. If you want to use separate\r\n * modules individually - you are more than welcome to do so.\r\n */\r\n\r\nvar random = require('ngraph.random');\r\n\r\nvar Viva = {\r\n  lazyExtend: function() {\r\n    return require('ngraph.merge').apply(this, arguments);\r\n  },\r\n  randomIterator: function() {\r\n    return random.randomIterator.apply(random, arguments);\r\n  },\r\n  random: function() {\r\n    return random.random.apply(random, arguments);\r\n  },\r\n  events: require('ngraph.events')\r\n};\r\n\r\nViva.Graph = {\r\n  version: require('./version.js'),\r\n  graph: require('ngraph.graph'),\r\n\r\n  serializer: function() {\r\n    return {\r\n      loadFromJSON: require('ngraph.fromjson'),\r\n      storeToJSON: require('ngraph.tojson')\r\n    };\r\n  },\r\n\r\n  centrality: require('./Algorithms/centrality.js'),\r\n  operations: require('./Algorithms/operations.js'),\r\n\r\n  geom: function() {\r\n    return {\r\n      intersect: require('gintersect'),\r\n      intersectRect: require('./Utils/intersectRect.js')\r\n    };\r\n  },\r\n\r\n  webgl: require('./WebGL/webgl.js'),\r\n  webglInputEvents: require('./WebGL/webglInputEvents.js'),\r\n\r\n  generator: function() {\r\n    return require('ngraph.generators');\r\n  },\r\n\r\n  Input: {\r\n    domInputManager: require('./Input/domInputManager.js'),\r\n    webglInputManager: require('./Input/webglInputManager.js')\r\n  },\r\n\r\n  Utils: {\r\n    // TODO: move to Input\r\n    dragndrop: require('./Input/dragndrop.js'),\r\n    findElementPosition: require('./Utils/findElementPosition.js'),\r\n    timer: require('./Utils/timer.js'),\r\n    getDimension: require('./Utils/getDimensions.js'),\r\n    events: require('./Utils/backwardCompatibleEvents.js')\r\n  },\r\n\r\n  Layout: {\r\n    forceDirected: require('ngraph.forcelayout'),\r\n    constant: require('./Layout/constant.js')\r\n  },\r\n\r\n  View: {\r\n    // TODO: Move `webglXXX` out to webgl namespace\r\n    Texture: require('./WebGL/texture.js'),\r\n    // TODO: This should not be even exported\r\n    webglAtlas: require('./WebGL/webglAtlas.js'),\r\n    webglImageNodeProgram: require('./WebGL/webglImageNodeProgram.js'),\r\n    webglLinkProgram: require('./WebGL/webglLinkProgram.js'),\r\n    webglNodeProgram: require('./WebGL/webglNodeProgram.js'),\r\n    webglLine: require('./WebGL/webglLine.js'),\r\n    webglSquare: require('./WebGL/webglSquare.js'),\r\n    webglImage: require('./WebGL/webglImage.js'),\r\n    webglGraphics: require('./View/webglGraphics.js'),\r\n    // TODO: Deprecate this:\r\n    _webglUtil: {\r\n      parseColor: require('./WebGL/parseColor.js')\r\n    },\r\n\r\n    // TODO: move to svg namespace\r\n    svgGraphics: require('./View/svgGraphics.js'),\r\n\r\n    renderer: require('./View/renderer.js'),\r\n\r\n    // deprecated\r\n    cssGraphics: function() {\r\n      throw new Error('cssGraphics is deprecated. Please use older version of vivagraph (< 0.7) if you need it');\r\n    },\r\n\r\n    svgNodeFactory: function() {\r\n      throw new Error('svgNodeFactory is deprecated. Please use older version of vivagraph (< 0.7) if you need it');\r\n    },\r\n\r\n    community: function() {\r\n      throw new Error('community is deprecated. Please use vivagraph < 0.7 if you need it, or `https://github.com/anvaka/ngraph.slpa` module');\r\n    }\r\n  },\r\n\r\n  Rect: require('./Utils/rect.js'),\r\n\r\n  svg: require('simplesvg'),\r\n\r\n  // TODO: should be camelCase\r\n  BrowserInfo: require('./Utils/browserInfo.js')\r\n};\r\n\r\nmodule.exports = Viva;\r\n"],"names":["render","_vm","this","_c","_self","attrs","staticRenderFns","ref","name","props","nodes","links","methods","show","mounted","computed","canvas","graph","g","hasWebGLSupport","layout","springLength","springCoeff","dragCoeff","gravity","theta","graphics","Graph","renderer","renderLinks","container","data","component","components","VGraph","addEventListener","removeEventListener","module","exports","Events","el","eventName","listener","useCapture","document","add","stdAttach","rm","stdDetach","oldIEAttach","oldIEDetach","Error","attachEvent","detachEvent","intersect","x1","y1","x2","y2","x3","y3","x4","y4","a1","a2","b1","b2","c1","c2","r1","r2","r3","r4","denom","offset","num","result","x","y","degree","betweenness","closeness","eccentricity","betweennes","oriented","currentNode","Q","S","pred","Object","create","dist","sigma","delta","centrality","forEachNode","setCentralityToZero","calculateCentrality","keys","forEach","divideByTwo","key","node","id","singleSourceShortestPath","accumulate","setDeltaToZero","length","w","pop","coeff","predcessors","idx","v","source","initNode","push","shift","forEachLinkedNode","toId","otherNode","processNode","nodeId","distances","map","filter","val","reachableNodesTotal","totalDistance","reduce","a","b","kind","getNodeDegree","toLowerCase","inoutDegreeCalculator","inDegreeCalculator","outDegreeCalculator","calculateNodeDegree","getLinks","total","i","fromId","maxDist","createEventsStorage","subject","registeredEvents","on","callback","ctx","handlers","off","wantToRemoveAll","deleteAllCallbacksForEvent","callbacks","splice","fire","fireArguments","arguments","Array","prototype","call","callbackInfo","apply","validateSubject","reservedWords","hasOwnProperty","eventsStorage","exposeProperties","settings","target","needsFilter","toString","augment","value","undefined","createLayout","simulator","eventify","physicsSettings","createSimulator","physicsSimulator","nodeMass","defaultNodeMass","nodeBodies","springs","bodiesCount","springTransform","noop","initPhysics","listenToEvents","wasStable","api","step","lastMove","ratio","isStableNow","onStableChanged","getNodePosition","getInitializedBody","pos","setNodePosition","body","setPosition","slice","invalidateBBox","getLinkPosition","linkId","spring","from","to","getGraphRect","getBBox","forEachBody","pinNode","isPinned","isNodePinned","dispose","onGraphChanged","getBody","getSpring","cb","bodyId","link","hasLink","isStable","changes","change","changeType","initBody","initLink","releaseNode","releaseLink","getNodesCount","forEachLink","getNode","position","neighbors","getNeighborBodies","getBestNewBodyPosition","addBodyAt","updateBodyMass","isNodeOriginallyPinned","removeBody","fromBody","toBody","addSpring","removeSpring","maxNeighbors","Math","min","otherBody","mass","Number","isNaN","load","createGraph","jsonGraph","nodeTransform","linkTransform","stored","JSON","parse","parsedNode","addNode","addLink","factory","ladder","complete","completeBipartite","balancedBinTree","path","circularLadder","grid","grid3","noLinks","wattsStrogatz","cliqueCircle","n","j","m","z","k","level","count","pow","root","left","right","cliqueCount","cliqueSize","appendClique","size","p","seed","random","neighborsSize","floor","nextDouble","newTo","next","needsRewire","removeLink","inputSeed","Date","Generator","gaussian","r","sqrt","log","maxValue","randomIterator","array","customRandom","localRandom","shuffle","t","uniform","options","console","warn","multigraph","uniqueLinkId","multiEdges","nodesCount","suspendEvents","createNodeIterator","createLink","createUniqueLink","createSingleLink","recordLinkChange","recordNodeChange","enterModification","exitModification","graphPart","removeNode","getLinksCount","beginUpdate","endUpdate","clear","getLink","hasNode","monitorSubscribers","realOn","enterModificationReal","exitModificationReal","recordLinkChangeReal","recordNodeChangeReal","Node","prevLinks","fromNode","toNode","addLinkToNode","makeLinkId","Link","isMultiEdge","suffix","indexOfElementInArray","fromNodeId","toNodeId","forEachOrientedLink","forEachNonOrientedLink","quitFast","linkedNodeId","objectKeysIterator","forInIterator","element","indexOf","len","merge","targetHasIt","optionsValueType","shouldReplace","Body","Vector2d","prevPos","force","velocity","Body3d","Vector3d","reset","Spring","expose","timeStep","createQuadTree","createBounds","createDragForce","createSpringForce","integrate","integrator","createBody","bodies","quadTree","bounds","springForce","dragForce","bboxNeedsUpdate","totalMovement","publicApi","accumulateForces","movement","update","addBody","body1","body2","springWeight","springCoefficient","getTotalMovement","getBestNewPosition","box","insertBodies","updateBodyForce","boundingBox","updateBoundingBox","graphRect","baseX","baseY","MAX_VALUE","MIN_VALUE","physics","dx","tx","dy","ty","max","vx","vy","abs","weight","d","getChild","quad0","quad1","quad2","quad3","setChild","child","InsertStack","isSamePosition","updateQueue","insertStack","nodesCache","currentInCache","newNode","getRoot","newOptions","massX","massY","top","bottom","sourceBody","queue","fx","fy","queueLength","shiftIdx","pushIdx","differentBody","insert","newBody","isEmpty","stackItem","oldBody","retriesCount","quadIdx","stack","popIdx","InsertStackElement","item","point1","point2","randomFunc","save","customNodeTransform","customLinkTransform","defaultTransformForNode","defaultTransformForLink","saveNode","saveLink","stringify","svg","compile","compileTemplate","domEvents","svgns","xlinkns","attrBag","svgElement","attributes","attributeName","attr","compiledTempalte","window","createElementNS","simplesvg","append","text","dataSource","model","content","appendChild","setAttributeNS","removeAttributeNS","getAttributeNS","textContent","parser","svgText","addNamespaces","parseFromString","documentElement","e","namespaces","match","tagLength","substr","template","BINDING_EXPR","domNode","allBindings","extractAllBindings","changeModel","setter","nodeType","typeSupported","hasChildNodes","domChildren","childNodes","bindTextContent","bindDomAttribute","domAttribute","modelNameMatch","attrName","localName","modelPropertyName","isSimpleValue","propertyBindings","attributeSetter","nodeValue","textSetter","createDomparser","DOMParser","fail","centralityWrapper","betweennessCentrality","degreeCentrality","toVivaGraphCentralityFormat","sort","byValue","toKeyValue","operations","density","directed","NaN","domInputManager","dragndrop","nodeEvents","bindDragNDrop","events","nodeUI","getNodeUI","onStart","onDrag","onStop","release","documentEvents","browserInfo","findElementPosition","start","drag","end","scroll","prevSelectStart","prevDragStart","dragObject","startX","startY","touchInProgress","pinchZoomLength","getMousePos","posx","posy","event","pageX","pageY","clientX","clientY","scrollLeft","scrollTop","move","stopPropagation","cancelBubble","preventDefault","handleDisabledEvent","handleMouseMove","handleMouseDown","isLeftButton","button","srcElement","handleMouseUp","onselectstart","ondragstart","handleMouseWheel","returnValue","mousePos","elementOffset","relMousePos","wheelDelta","detail","updateScrollEvents","scrollCallback","browser","getPinchZoomLength","finger1","finger2","handleTouchMove","touches","touch","currentPinchLength","handleTouchEnd","handleSignleFingerTouch","handleTouchStart","onScroll","webglInputManager","createInputEvents","inputEvents","draggedNode","internalHandlers","mouseDown","mouseCapture","mouseUp","releaseMouseCapture","mouseMove","constant","Rect","userSettings","maxX","maxY","rand","layoutLinks","placeNodeCallback","updateGraphRect","layoutNodes","ensureNodeInitialized","updateNodePositions","ensureLinkInitialized","run","iterationsCount","placeNode","newPlaceNodeCallbackOrNode","backwardCompatibleEvents","eventsDefined","extend","stop","backwardCompatible","version","ua","navigator","userAgent","rwebkit","ropera","rmsie","rmozilla","exec","nullEvents","createDocumentEvents","handler","obj","curleft","curtop","offsetParent","offsetLeft","offsetTop","getDimension","message","width","clientWidth","height","clientHeight","intersectRect","createNullEvents","createTimer","scope","lastTime","vendors","setTimeout","clearTimeout","requestAnimationFrame","vendorPrefix","cancelAnimationFrame","rafPolyfill","cancelRafPolyfill","timer","intervalId","startTimer","stopTimer","restart","currTime","getTime","timeToCall","forceDirected","svgGraphics","windowEvents","FRAME_INTERVAL","inputManager","animationTimer","containerDrag","interactive","rendererInitialized","updateCenterRequired","userInteraction","isPaused","transform","offsetX","offsetY","scale","publicEvents","prepareSettings","prerender","initDom","updateCenter","renderIterations","resetScale","pause","resume","rerender","renderGraph","zoomOut","zoomIn","getTransform","moveTo","graphCenterChanged","getGraphics","getLayout","stopListenToEvents","isInteractive","interactionName","beginRender","renderNodes","endRender","onRenderFrame","needMoreFrames","resetStable","containerSize","cx","cy","createNodeUi","nodePosition","removeNodeUi","createLinkUi","linkPosition","removeLinkUi","listenNodeEvents","wasPinned","oldPos","releaseNodeEvents","init","releaseDom","processNodeChange","processLinkChange","onWindowResized","releaseContainerDragManager","releaseGraphEvents","out","scrollPoint","scaleFactor","translateRel","scaleOffset","svgContainer","svgRoot","initCallback","actualScale","allNodes","allLinks","nodeBuilder","nodePositionCallback","linkBuilder","linkPositionCallback","linkUI","fromPos","toPos","fireRescaled","cachedPos","cachedFromPos","cachedToPos","updateTransform","createSvgRoot","getLinkUI","builderCallback","newPlaceCallback","placeLink","newPlaceLinkCallback","createSVGPoint","getCTM","origin","matrixTransform","inverse","f","createSVGMatrix","translate","multiply","removeChild","childElementCount","insertBefore","firstChild","getGraphicsRoot","callbackWhenReady","getSvgRoot","webglGraphics","webglLinkProgram","webglNodeProgram","webglSquare","webglLine","enableBlending","preserveDrawingBuffer","clearColor","clearColorValue","graphicsRoot","gl","userPlaceNodeCallback","userPlaceLinkCallback","linksCount","linkProgram","nodeProgram","nodeUIBuilder","linkUIBuilder","updateTransformUniform","resetScaleInternal","updateSize","offsetWidth","offsetHeight","viewport","createElement","bringLinkToFront","srcLinkId","temp","frontLinkId","getFrontLinkId","bringToFront","boundPosition","uiid","ui","createNode","c","contextParameters","getContext","msg","alert","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","enable","BLEND","color","COLOR_BUFFER_BIT","isSupported","linkIdToRemove","lastLinkUI","nodeIdToRemove","lastNodeUI","replaceProperties","omitLinksRendering","setNodeProgram","newProgram","setLinkProgram","transformClientToGraphCoordinates","transformGraphToClientCoordinates","getNodeAtClientPos","clientPos","preciseCheck","parseColor","parsedColor","replace","parseInt","Texture","isDirty","webgl","createProgram","extendArray","copyArrayPart","swapArrayPart","getLocations","context","createShader","shaderText","type","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","vertexShaderSrc","fragmentShaderSrc","program","vs","VERTEX_SHADER","fs","FRAGMENT_SHADER","attachShader","getProgramParameter","LINK_STATUS","buffer","itemsInBuffer","elementsPerItem","extendedArray","Float32Array","set","uniformOrAttributeNames","foundLocations","location","getAttribLocation","getUniformLocation","elementsCount","tmp","webglAtlas","tilesPerTexture","dirtyTimeoutId","tilesPerRow","tileSize","lastLoadedIdx","loadedImages","skipedDirty","textures","trackedUrls","isPowerOf2","clearDirty","remove","getTextures","getCoordinates","imgUrl","coordinates","tileToRemove","getTileCoordinates","lastTileInSet","copy","replacedOffset","markDirty","img","Image","imgId","crossOrigin","onload","drawAt","src","createTexture","texture","tileNumber","tilePosition","textureNumber","currentTexture","drawImage","col","row","absolutePosition","localTileNumber","markDirtyNow","fromCanvas","toCtx","webglImage","_texture","_offset","WebglAtlas","glUtils","webglImageNodeProgram","atlas","utils","locations","sizeDirty","ATTRIBUTES_PER_PRIMITIVE","nodesFS","createNodeFragmentShader","nodesVS","createNodeVertexShader","refreshTexture","nativeObject","deleteTexture","activeTexture","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","texParameteri","TEXTURE_MAG_FILTER","LINEAR","TEXTURE_MIN_FILTER","LINEAR_MIPMAP_NEAREST","generateMipmap","uniform1i","ensureAtlasTextureUpdated","glContext","useProgram","uniform1f","enableVertexAttribArray","vertexPos","customAttributes","createBuffer","replacedNode","newTransform","h","bindBuffer","ARRAY_BUFFER","bufferData","DYNAMIC_DRAW","uniformMatrix4fv","uniform2f","screenSize","vertexAttribPointer","FLOAT","BYTES_PER_ELEMENT","drawArrays","TRIANGLES","join","webglInputEvents","boundRect","mouseCapturedNode","mouseEnterCallback","mouseLeaveCallback","mouseDownCallback","mouseUpCallback","mouseMoveCallback","clickCallback","dblClickCallback","startListen","mouseEnter","mouseLeave","click","dblClick","half","invoke","callbacksChain","args","lastFound","lastUpdate","lastClickTime","updateBoundRect","getBoundingClientRect","clickTime","nodeAtClientPos","sameNode","BYTES_PER_LINK","Uint32Array","linksFS","linksVS","storage","ArrayBuffer","positions","colors","ensureEnoughStorage","byteLength","extendedStorage","extendedPositions","extendedColors","linkUi","linkIdx","LINES","BYTES_PER_NODE","POINTS","Viva","lazyExtend","serializer","loadFromJSON","storeToJSON","geom","generator","Input","Utils","Layout","View","_webglUtil","cssGraphics","svgNodeFactory","community","BrowserInfo"],"sourceRoot":""}